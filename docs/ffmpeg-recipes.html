<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Dmytro Zharii RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Dmytro Zharii Atom Feed">
<link rel="stylesheet" href="/clippy.js/clippy.css">
<script src="/clippy.js/jquery-3.6.0.min.js"></script>
<script src="/clippy.js/clippy.js"></script><title data-react-helmet="true">ffmpeg-recipes | Dmytro Zharii</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://blog.zharii.com/docs/ffmpeg-recipes"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ffmpeg-recipes | Dmytro Zharii"><meta data-react-helmet="true" name="description" content="- Using FFmpeg with NVIDIA GPU Hardware Acceleration :: NVIDIA Video Codec SDK Documentation"><meta data-react-helmet="true" property="og:description" content="- Using FFmpeg with NVIDIA GPU Hardware Acceleration :: NVIDIA Video Codec SDK Documentation"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://blog.zharii.com/docs/ffmpeg-recipes"><link data-react-helmet="true" rel="alternate" href="https://blog.zharii.com/docs/ffmpeg-recipes" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog.zharii.com/docs/ffmpeg-recipes" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7d6ab89a.css">
<link rel="preload" href="/assets/js/runtime~main.9027f3ad.js" as="script">
<link rel="preload" href="/assets/js/main.6a6a7e8c.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Home</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Personal Wiki</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://blog.zharii.com/blog/rss.xml" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">[RSS]</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/dzharii/dzharii.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/azure-and-aad-articles">azure-and-aad-articles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/bicycling-inbox">bicycling-inbox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/big-tech-folks">big-tech-folks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/bookmark-my-GPT-prompts">🤖 Bookmarks: My GPT/AI Prompts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/bookmarklets">📜 BookmarkLETS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/bookmarks">📌 Bookmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cheatsheets">Cheat-sheets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/design-assets">design-assets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-cpp">dev-cpp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-csharp">dev-csharp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-design-and-process">dev-design-and-process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-docfx">dev-docfx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-ide-visualstudio">dev-ide-visualstudio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-linux">dev-linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-oculus-quest2-inbox">dev-oculus-quest2-inbox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-powershell">dev-powershell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-projects-backend">dev-projects-backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-retro-8bit">dev-retro-8bit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-scala-spark-synapse-bigdata">dev-scala-spark-synapse-bigdata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-stable-diffusion-cpu">dev-stable-diffusion-cpu</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dev-webapi">dev-webapi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ffmpeg-inbox">ffmpeg-inbox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/ffmpeg-recipes">ffmpeg-recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ffmpeg-snippets">ffmpeg-snippets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/fun-meme-cry-like-a-man">fun-meme-cry-like-a-man</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/fun-rubik-cube">Rubik&#x27;s Cube</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/fun-web-comics">fun-web-comics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/fun-yodel">fun-yodel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/image-processing">Image Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/knowledge-management">Knowledge Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux-odroid-cli-90s-project">linux-odroid-cli-90s-project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/markdown-tools">markdown-tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/math">math and stats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/network">network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/podcasts">Podcasts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/prep-resources">prep-resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/psy-2022-07-28-BoundariesMeeting">psy-2022-07-28-BoundariesMeeting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/psy-ADHD">Mental Health / ADHD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/psy-Nonviolent Communication">psy-Nonviolent Communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/psy-Unschedule">psy-Unschedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/public-apis">public-apis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/radiation">☢ Radiation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/retro-www-buttons">retro-www-buttons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/seattle">seattle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/security-articles">security-articles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/self-hosted-software">self-hosted-software</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/testing-distributed-systems">testing-distributed-systems</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/testing">testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tools-mindmaps">tools-mindmaps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tools-WireGuard">tools-WireGuard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/workplace-articles">workplace-articles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/workplace-levels-and-layoffs">workplace-levels-and-layoffs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/a-watch-reading-list/my-watch-reading-list-now">a-watch-reading-list</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/aww-articles/2021-10-23-Moving-faster">aww-articles</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/chatGPT/2022-12-14-5-Harmless-Ways-Software-Developers-Can-Have-Fun-at-Work.md">chatGPT</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/dev-good-GPT-prompts/2023-06-19-CPP-17-describe-new-language-features">dev-good-GPT-prompts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/fun/2023-02-16-Seattle-Link-Pictograms">fun</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/gpt4-generated-content/2023-05-03-apache-spark-ref">gpt4-generated-content</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/resources/2023-02-12-Slides--Apache-Spark-Core-Deep-Dive-Proper-Optimization">resources</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/walking-seatle-places/0000-00-00-GPT-Prompts">walking-seatle-places</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ffmpeg-recipes</h1></header><ul><li><a href="https://docs.nvidia.com/video-technologies/video-codec-sdk/ffmpeg-with-nvidia-gpu/index.html" target="_blank" rel="noopener noreferrer">Using FFmpeg with NVIDIA GPU Hardware Acceleration :: NVIDIA Video Codec SDK Documentation</a></li><li><a href="https://jeromewu.github.io/ffmpeg-wasm-a-pure-webassembly-javascript-port-of-ffmpeg/" target="_blank" rel="noopener noreferrer">FFmpeg.wasm, a pure WebAssembly / JavaScript port of FFmpeg  TechBlog</a></li><li><a href="https://mattj.io/posts/2021-02-27-create-animated-gif-and-webp-from-videos-using-ffmpeg/" target="_blank" rel="noopener noreferrer">Create animated GIF and WebP from videos using FFmpeg  Matt Joseph</a></li><li><a href="https://unix.stackexchange.com/questions/28803/how-can-i-reduce-a-videos-size-with-ffmpeg" target="_blank" rel="noopener noreferrer">How can I reduce a video&#x27;s size with ffmpeg? - Unix &amp; Linux Stack Exchange</a></li><li><a href="https://github.com/cytopia/ffscreencast" target="_blank" rel="noopener noreferrer">cytopia/ffscreencast: ffscreencast - ffmpeg screencast/desktop-recording with video overlay and multi monitor support</a></li><li><a href="https://streaminglearningcenter.com/blogs/ffmpeg-command-threads-how-it-affects-quality-and-performance.html" target="_blank" rel="noopener noreferrer">FFmpeg Threads Command: How it Affects Quality and Performance - Streaming Learning Center</a></li><li><a href="https://galene.org/" target="_blank" rel="noopener noreferrer">Galène videoconference server</a></li><li><a href="https://news.ycombinator.com/item?id=25484133" target="_blank" rel="noopener noreferrer">Show HN: Owncast – An open-source, self-hosted live streaming server Hacker News</a></li><li><a href="http://blog.gregzaal.com/2014/05/30/camera-stabilisation-with-ffmpeg/" target="_blank" rel="noopener noreferrer">Camera Stabilisation with FFmpeg</a></li><li><a href="https://www.imakewebsites.ca/posts/2018/02/17/stabilizing-gopro-video-with-ffmpeg-and-vid.stab/" target="_blank" rel="noopener noreferrer">Stabilizing GoPro Video with FFmpeg and vid.stab Important Bits</a></li><li><a href="https://kokomins.wordpress.com/2019/10/10/anime-encoding-guide-for-x265-and-why-to-never-use-flac/" target="_blank" rel="noopener noreferrer">Anime Encoding Guide for x265  HEVC  &amp; AAC/OPUS  and Why to Never Use FLAC  – Kokomins</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="tools">Tools<a class="hash-link" href="#tools" title="Direct link to heading">​</a></h2><ul><li><a href="https://alfg.dev/ffmpeg-commander/" target="_blank" rel="noopener noreferrer">FFmpeg Commander</a><ul><li><a href="https://github.com/alfg/ffmpeg-commander" target="_blank" rel="noopener noreferrer">github: alfg/ffmpeg-commander: 🛠️ FFmpeg Command Generator Web UI</a> - generates commandline for the workload!</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="snippets">Snippets<a class="hash-link" href="#snippets" title="Direct link to heading">​</a></h2><p>Audio - increase volume:
<a href="https://trac.ffmpeg.org/wiki/AudioVolume" target="_blank" rel="noopener noreferrer">AudioVolume – FFmpeg</a> Audio Volume Manipulation</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i VID_20211212_130236045.mp4  -c:v copy -filter:a loudnorm VID_20211212_130236045_vol_50.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i 2022-12-04-11-45-31.mkv -vcodec copy -af &quot;volume=3.0&quot; output.mkv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Add sound wave on top of video (under construction):</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i in.mp4 -filter_complex &quot;[0:a]showwaves=s=1920x300:mode=line:colors=red|yellow[sw];[0][sw]overlay=(W-w)/2:(H-h)/2:format=auto,format=yuv420p[v]&quot; -map &quot;[v]&quot; -map 0:a -movflags +faststart output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Reduce frame rate:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i one.mkv -movflags +faststart -filter:v fps=24 two.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Make a clip</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i.mp4 -ss 00:01:00 -t 00:02:00 -c copy o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Group photos into video</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -framerate 10 -pattern_type glob -i &#x27;*.jpg&#x27; -c:v libx264 o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Get a screenshot from a video.</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i o.mp4 -r 1 -q:v 2 -f image2 img-3%d.jpeg</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Concatenate videos</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">file &#x27;video1.mp4&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file &#x27;video2.mp4&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file &#x27;videoN.mp4&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f concat -i list.txt -c copy o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Remove audio from video</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i.mp4 -c:v copy -an o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Extract audio from video</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i.mp4 -vn 0.wav</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Crop video</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i.mp4 -filter:v &quot;crop=w:h:x:y&quot; o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Stack videos horizontaly</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i0.mp4 -i i1.mp4 -filter_complex hstack=inputs=2 o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Vertical</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i0.mp4 -i i1.mp4 -filter_complex vstack=inputs=2 o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Grid 2x2</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg \ -i i0.mp4 -i i1.mp4 -i i2.mp4 -i i3.mp4 \ -filter_complex \ &quot;[0:v][1:v]hstack=inputs=2[top]; \ [2:v][3:v]hstack=inputs=2[bottom]; \ [top][bottom]vstack=inputs=2[v]&quot; \ -map &quot;[v]&quot; \ o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Grid 3x2</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg \ -i i0.mp4 -i i1.mp4 \ -i i2.mp4 -i i3.mp4 \ -i i4.mp4 -i i5.mp4 \ -filter_complex \ &quot;[0:v][1:v][2:v]hstack=inputs=3[top];\ [3:v][4:v][5:v]hstack=inputs=3[bottom];\ [top][bottom]vstack=inputs=2[v]&quot; \ -map &quot;[v]&quot; \ o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Rotate (re-encode):</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i i.mp4 -vf &quot;transpose=0&quot; o.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><a href="https://ostechnix.com/how-to-rotate-videos-using-ffmpeg-from-commandline/" target="_blank" rel="noopener noreferrer">How To Rotate Videos Using FFMpeg From Commandline</a></p><p>transpose=...</p><ul><li>0 - Rotate by 90 degrees counter-clockwise and flip vertically. This is the default.</li><li>1 - Rotate by 90 degrees clockwise.</li><li>2 - Rotate by 90 degrees counter-clockwise.</li><li>3 - Rotate by 90 degrees clockwise and flip vertically.</li></ul><p>Rotate 180 dec:</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -vf &quot;transpose=2,transpose=2&quot; output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Rotate (metadata only):</p><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i inp.mp4  -c copy -metadata:s:v:0 rotate=180 output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="audio-filter-loudnorm">Audio filter loudnorm<a class="hash-link" href="#audio-filter-loudnorm" title="Direct link to heading">​</a></h2><ul><li>2022-06-12 <a href="http://johnriselvato.com/ffmpeg-how-to-normalize-audio/" target="_blank" rel="noopener noreferrer">FFmpeg How to normalize audio? - John Riselvato</a></li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp3 -af loudnorm=I=-16:LRA=11:TP=-1.5 output.mp3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">loudnorm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Indicates the name of the normalization filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I, i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Indicates the integrated loudness (-70 to -5.0 with default -24.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LRA, lra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Indicates the loudness range (1.0 to 20.0 with default 7.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TP, tp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Indicates the max true peak (-9.0 to 0.0 with default -2.0)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>See also: <a href="http://k.ylo.ph/2016/04/04/loudnorm.html" target="_blank" rel="noopener noreferrer">loudnorm</a></p><blockquote><p>Loudness Normalization. The algorithm goes like this: Measure the integrated loudness of the source file, calculate an appropriate offset gain, and then apply makeup gain. It’s a pretty simple algorithm, but what about when there’s nowhere near enough headroom for a simple upwards linear gain adjustment? And how should we handle the loudness normalization of livestreams?</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="ffmpeg-convert-for-android">FFmpeg: convert for android<a class="hash-link" href="#ffmpeg-convert-for-android" title="Direct link to heading">​</a></h2><ul><li>(2021-09-15) <a href="https://stackoverflow.com/questions/14171826/converting-video-for-android-using-ffmpeg" target="_blank" rel="noopener noreferrer">Converting Video for Android using FFMPEG - Stack Overflow</a></li></ul><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i &lt;input&gt; -c:v libx264 -c:a aac -movflags +faststart output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i &lt;input&gt; -s 480x320 -vcodec mpeg4 -acodec aac -strict -2 -ac 1 -ar 16000 -r 13 -ab 32000 -aspect 3:2 &lt;output&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -y -i input_file.mp4 -s 352x288 -b:v 384k -flags +loop+mv4 -cmp 256 -partitions +parti4x4+parti8x8+partp4x4+partp8x8 -subq 6 -trellis 0 -refs 5 -bf 0 -coder 0 -me_range 16 -g 250 -keyint_min 25 -sc_threshold 40 -i_qfactor 0.71 -qmin 10 -qmax 51 -qdiff 4 -c:a aac -ac 1 -ar 16000 -r 13 -ab 32000 -aspect 3:2 -strict experimental output_file.3gp</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-sh theme-code-block"><div class="codeBlockContent_wNvx sh"><pre tabindex="0" class="prism-code language-sh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i &lt;INPUT_VIDEO&gt; -c:v libx264 -profile:v baseline -c:a libvo_aacenc -ar 44100 -ac 2 -b:a 128k -movflags faststart output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Powershell: Convert files in the current folder for mobile upload</p><div class="codeBlockContainer_I0IT language-powershell theme-code-block"><div class="codeBlockContent_wNvx powershell"><pre tabindex="0" class="prism-code language-powershell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$files = Get-ChildItem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-Item  -Name &quot;out&quot; -ItemType &quot;directory&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">foreach($file in $files) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $file.Extension</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($file.Extension -cin (&#x27;.webm&#x27;, &#x27;.mp4&#x27;, &#x27;.mkv&#x27;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $fn = &#x27;&quot;out/&#x27; + $file.BaseName + &#x27;.mp4&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ffmpeg -i &quot;$file&quot; -c:v libx264 -c:a aac -movflags +faststart $fn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="webcam-streaming">Webcam Streaming<a class="hash-link" href="#webcam-streaming" title="Direct link to heading">​</a></h2><p><a href="http://4youngpadawans.com/stream-camera-video-and-audio-with-ffmpeg/" target="_blank" rel="noopener noreferrer">Stream camera video and audio with FFmpeg</a></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -list_devices </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> -f dshow -i dummy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>&quot;HD Pro Webcam C920&quot;
&quot;Microphone (TKGOU PnP USB Microphone)&quot;</p></blockquote><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f dshow -i </span><span class="token assign-left variable" style="color:#36acaa">video</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;HD Pro Webcam C920&quot;</span><span class="token plain">:audio</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Microphone (TKGOU PnP USB Microphone)&quot;</span><span class="token plain"> -profile:v high -pix_fmt yuvj420p -level:v </span><span class="token number" style="color:#36acaa">4.1</span><span class="token plain"> -preset ultrafast -tune zerolatency -vcodec libx264 -r </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> -b:v 512k -s 640x360 -acodec aac -ac </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> -ab 32k -ar </span><span class="token number" style="color:#36acaa">44100</span><span class="token plain"> -f mpegts -flush_packets </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> udp://192.168.1.101:5666?pkt_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1316</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>VLC -&gt; Open Network Stream: <code>udp://@192.168.1.101:5666</code></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="gopro-camera">GoPRO Camera<a class="hash-link" href="#gopro-camera" title="Direct link to heading">​</a></h2><p>Reddit Thread: <a href="https://www.reddit.com/r/Windows10/comments/j58y6f/no_longer_free_windows_10_hevc_video_extensions/" target="_blank" rel="noopener noreferrer">No longer free: Windows 10 HEVC Video Extensions from Device Manufacturer : Windows10</a>
workaround</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">start ms-windows-store://pdp/?ProductId=9n4wgh0z6vhq</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Downscale 4K video example</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.MP4 -c:v libx264 -crf </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> -preset slow -c:a aac -b:a 192k -ac </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> -vf </span><span class="token assign-left variable" style="color:#36acaa">scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1920</span><span class="token plain">:1080 output_4k_to_1080p_converted.MP4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Convert h.264 to h.265 (no change in resolution)</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -c:v libx265 -vtag hvc1 -vf </span><span class="token assign-left variable" style="color:#36acaa">scale</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1920</span><span class="token plain">:1080 -crf </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> -c:a copy output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>crf:</p><ul><li><code>-crf 0</code> high-quality, low compression, large file</li><li><code>-crf 23</code> default</li><li><code>-crf 51</code> low-quality, high compression, small file</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="gopro-tools-and-code">GoPro Tools and Code<a class="hash-link" href="#gopro-tools-and-code" title="Direct link to heading">​</a></h3><ul><li>(2021-12-26) <a href="https://gopro.com/en/us/news/gopro-video-metadata-open-source-explained" target="_blank" rel="noopener noreferrer">GoPro Open Sources Video Metadata</a></li><li>(2021-12-26) <a href="https://www.cgsecurity.org/wiki/TestDisk" target="_blank" rel="noopener noreferrer">TestDisk - CGSecurity</a> - Open source SD Card recovery tool</li><li>2022-05-13 <a href="https://github.com/destroyedlolo/GPMFMetersGenerator" target="_blank" rel="noopener noreferrer">destroyedlolo/GPMFMetersGenerator: Generate skickers from GoPro&#x27;s GPMF</a><blockquote><p>Generate skickers from GoPro&#x27;s GPMF
Try it 🍎🍎🍎</p></blockquote></li><li>2022-05-13 <a href="https://github.com/gyroflow/gyroflow" target="_blank" rel="noopener noreferrer">gyroflow/gyroflow: Video stabilization using gyroscope data</a><blockquote><p>Video stabilization using gyroscope data Homepage • Download • Documentation • Discord • Report bug • Request feature</p></blockquote></li><li>2022-05-13 <a href="https://github.com/KonradIT/goprowifihack" target="_blank" rel="noopener noreferrer">KonradIT/goprowifihack: Unofficial GoPro WiFi API Documentation - HTTP GET requests for commands, status, livestreaming and media query.</a><blockquote><p>The unofficial API for GoPro cameras (The WiFi enabled models)</p></blockquote></li><li>2022-05-13 <a href="https://github.com/gopro/gpmf-parser" target="_blank" rel="noopener noreferrer">gopro/gpmf-parser: Parser for GPMF™ formatted telemetry data used within GoPro® cameras.</a><blockquote><p>The GPMF structured storage format was originally proposed to store high-frequency periodic sensor data within a video file like an MP4. Action cameras, like that from GoPro, have limited computing resources beyond that needed to store video and audio, so</p></blockquote></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="youtube">Youtube<a class="hash-link" href="#youtube" title="Direct link to heading">​</a></h2><ul><li>2022-05-08 <a href="https://trac.ffmpeg.org/wiki/Encode/YouTube" target="_blank" rel="noopener noreferrer">Encode/YouTube – FFmpeg</a><blockquote><p>Upscaling video for higher peak quality</p></blockquote></li></ul><p>Due to the encoding ladders that Youtube and other streaming sites utilise to re-encode uploaded videos in different qualities, higher resolution videos receive a higher bitrate. It&#x27;s possible to use upscaling to exploit this for higher peak viewing quality.</p><p>The following will use nearest neighbor scaling to upscale a video by 2x in each direction for 4 times the total resolution and minimal scaling artifacts:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mkv -vf scale=iw*2:ih*2:flags=neighbor -c:v libx264 -preset slow -crf 18 output.mkv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To upscale by 4x or 8x, use scale=iw<em>4:ih</em>4:flags=neighbor and scale=iw<em>8:ih</em>8:flags=neighbor respectively. This can be useful for low-resolution material such as VHS captures, DVD video, and gameplay capture of old video games that would otherwise suffer from excessive loss of detail if uploaded in 480p or lower resolution.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="tools--other">Tools / Other<a class="hash-link" href="#tools--other" title="Direct link to heading">​</a></h2><ul><li><p>(2021-09-26) <a href="https://github.com/jely2002/youtube-dl-gui" target="_blank" rel="noopener noreferrer">jely2002/youtube-dl-gui: A cross-platform GUI for youtube-dl made in Electron and node.js - open video downloader</a></p></li><li><p>2023-08-05 <a href="https://amiaopensource.github.io/ffmprovisr/#basic-structure" target="_blank" rel="noopener noreferrer">ffmprovisr</a> ffmpeg cookbook</p></li></ul><blockquote><p>Making FFmpeg Easier
FFmpeg is a powerful tool for manipulating audiovisual files. Unfortunately, it also has a steep learning curve, especially for users unfamiliar with a command line interface. This app helps users through the command generation process so that more people can reap the benefits of FFmpeg.</p><p>Each button displays helpful information about how to perform a wide variety of tasks using FFmpeg. To use this site, click on the task you would like to perform. A new window will open up with a sample command and a description of how that command works. You can copy this command and understand how the command works with a breakdown of each of the flags.</p><p>This page does not have search functionality, but you can open all recipes (second option in the sidebar) and use your browser&#x27;s search tool (often ctrl+f or cmd+f) to perform a keyword search through all recipes.</p><p><img alt="image-20230805000700387" src="/assets/images/image-20230805000700387-d04b30c821cec31e9482306fbd83a133.png" width="1322" height="589"></p><ul><li><a href="https://amiaopensource.github.io/ffmprovisr/#about" target="_blank" rel="noopener noreferrer">About this resource</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#basics" target="_blank" rel="noopener noreferrer">FFmpeg basics</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#concepts" target="_blank" rel="noopener noreferrer">Advanced FFmpeg concepts</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#rewrap" target="_blank" rel="noopener noreferrer">Change container (rewrap)</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#transcode" target="_blank" rel="noopener noreferrer">Change codec (transcode)</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#video-properties" target="_blank" rel="noopener noreferrer">Change video properties</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#audio-files" target="_blank" rel="noopener noreferrer">Change/view audio properties</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#join-trim" target="_blank" rel="noopener noreferrer">Join/trim/create an excerpt</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#interlacing" target="_blank" rel="noopener noreferrer">Work with interlaced video</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#overlay" target="_blank" rel="noopener noreferrer">Overlay timecode or text on a video</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#create-images" target="_blank" rel="noopener noreferrer">Create thumbnails or GIFs</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#create-video" target="_blank" rel="noopener noreferrer">Create a video from image(s) and audio</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#filters-scopes" target="_blank" rel="noopener noreferrer">Use filters or scopes</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#metadata" target="_blank" rel="noopener noreferrer">View or strip metadata</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#preservation" target="_blank" rel="noopener noreferrer">Preservation tasks</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#test-files" target="_blank" rel="noopener noreferrer">Generate test files</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#ocr" target="_blank" rel="noopener noreferrer">Use OCR</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#perceptual-similarity" target="_blank" rel="noopener noreferrer">Compare similarity of videos</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#other" target="_blank" rel="noopener noreferrer">Something else</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#similar-tools" target="_blank" rel="noopener noreferrer">Similar tools: tips &amp; tricks</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#cdda" target="_blank" rel="noopener noreferrer">CDDA (Audio CD) Ripping Tools</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#imagemagick" target="_blank" rel="noopener noreferrer">ImageMagick</a></li><li><a href="https://amiaopensource.github.io/ffmprovisr/#flac-tool" target="_blank" rel="noopener noreferrer">flac tool</a></li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="about-ffmprovisr">About ffmprovisr<a class="hash-link" href="#about-ffmprovisr" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="making-ffmpeg-easier">Making FFmpeg Easier<a class="hash-link" href="#making-ffmpeg-easier" title="Direct link to heading">​</a></h3><p>FFmpeg is a powerful tool for manipulating audiovisual files. Unfortunately, it also has a steep learning curve, especially for users unfamiliar with a command line interface. This app helps users through the command generation process so that more people can reap the benefits of FFmpeg.</p><p>Each button displays helpful information about how to perform a wide variety of tasks using FFmpeg. To use this site, click on the task you would like to perform. A new window will open up with a sample command and a description of how that command works. You can copy this command and understand how the command works with a breakdown of each of the flags.</p><p>This page does not have search functionality, but you can open all recipes (second option in the sidebar) and use your browser&#x27;s search tool (often ctrl+f or cmd+f) to perform a keyword search through all recipes.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="tutorials">Tutorials<a class="hash-link" href="#tutorials" title="Direct link to heading">​</a></h3><p>For FFmpeg basics, check out the program’s <a href="https://ffmpeg.org/" target="_blank" rel="noopener noreferrer">official website</a>.</p><p>For instructions on how to install FFmpeg on Mac, Linux, and Windows, refer to Reto Kromer’s <a href="https://avpres.net/FFmpeg/#ch1" target="_blank" rel="noopener noreferrer">installation instructions</a>.</p><p>For Bash and command line basics, try the <a href="https://learnpythonthehardway.org/book/appendixa.html" target="_blank" rel="noopener noreferrer">Command Line Crash Course</a>. For a little more context presented in an ffmprovisr style, try <a href="https://explainshell.com/" target="_blank" rel="noopener noreferrer">explainshell.com</a>!</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="license">License<a class="hash-link" href="#license" title="Direct link to heading">​</a></h3><p><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer"><img alt="Creative Commons License" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAdnJLH8AAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAABTpJREFUaN7tWk1PG0cY9jlSLO5cOIYbbZUeU6T0B5AfkIh/UNRbJKqgiFSKVAlZrqLm0FCptyawxubDX3gNa2N71/Z6IeTKT+AnvNXzrt9ldlnwB84aE0Yasd6ZnR2efeZ5P2ZiRBSPxWJ0X0dfifCn+2Mnv017xV3KlbJUPChQySjRQbVMRt2gI7NK9WaNGq0GWW2TmrZFzU7TrbZFlm2S2WpwH/St1A1+VjdKPFaulOOx8Y5MNk1beylK7Wi0ub1BG5lPXD+lP9LHrf/uTFWAvgA3r+do/7BI5YpORu2QwWq06gxg22lR58Qm53OHjk+P6eSLW3HtfHa4DX0s2+Jn8CzGKFd1HhNjB0HWdjY9kAHwHQU55ge3WmYG1qwasxWgAdTVN6v09Oen9DD+8NJSwD20rf6+yn3bx23+KGB0pVFhNu8f7vtATme3KLWruSBnNkbG4pfLL2l2dvbSHHEPbWMBGLKgggtgmh2LWZlIJmh6erpv3UHfxJ8JfhYSAjZXPZCLnlxs5zKU3nNBHgWLk38l6dHsI28e8/PztLS0xBXXch990DdSgKGTkIULcJvMxIVnCz7wpqamaHFxkVZWVkjXda64xj20qX3xbKVmUMtxQQaTIReuJmdpt7Djl4obsHj93w8Uj8fd9y4s0NnZGQUL7qENfdA3CpA9gGHQoJeQBTA3CC7AA5Dn5+d0XVlfX/cBDbYAZHwwfDi8A4avUM5Tdn/PlYoQFg/6jwhz8aHVolhz3xxlbpEBjOULowTNxdJWwZ2bmwtlxFUFHwHPqEzGmNBkvONCKhQW76ZI294cSiagq8LcL6enPQFGESZ/bU32ADZYGups0KC5Kri9WNsPyNBkGD6WirpBesVlMWtx3tVikYlBARaDNggJ0FcMXyQAM3ttk6VBDBqWum3bNGwByCIXGBNjw4UTFhcPXBarHsUwMiEGLVggF/KBg9KBIoYvEoChjy2nxa6YTAqae9MieocKFw4rRLS41HXbVJkYFmB4CsESElX5Cp6JDGBEaPaJzb6ssFeVBngL0C18dVQV/GDb2tqa7x8RFmNsaDEivksykcu43oSiw3cKYBg3LGEJItQlBQDD/F2AqWlaaJv6vCxVjI2ID1JU7bpshXKBvQnosLhrd1IikE84PnW8CaksFGM1MzPDxgGA4xrLX9rE0wDg0hYmEwirmz4dLvjctWEAvs7IXcXeyI0cfF/kFWRCADE4yTBN7kev1RWAd8AnPjKPRgaw6qb1C3DkbtokAzxooCHaG2mg0a9EwPDBdcM1QFUlItgWlURMRKh8nZG7zpD1Y+SEMa6R6/C7RmnkVJDVZA8+OuaB96tBz1iSPeKmSYgM1yq4zK9y0wCy3A+2oYDRqpvWUNy0vH5zN20i0pUSaKhhctCfHWWgcdgNNJC6lEDjpgmfW51wrzbCQ+VB4vtxhcoTAbCa7Pnwz9+jT/YkEzw2kj14l6Qs1cT7sMmeiQAYdfnVspeufP7iuQ/kQZI+YH1ourJt0us3r7/F3eWLH0u//sJuVGeIhDva0EdNuD/+8TFLA/xsfMBvdPvef+O3V8scDABklcnDbBkB3FanSe/ev4vqHEJokBHsM1aAPZBtd9MTmjzwpmdSNj2tyMANghd2PQZwwwEWuVC37QFar2177Fzwtj3OR7TNyGWhV7ryVkiEWr//4TvS0hq7cPCTbe/giaMcPHH4nnrwJJXR6MlPT8ZxVOk2SUNvgKUCrLd/vKViuagcnepWHJ1qm9yGPuMAdmIZfF9HUInowT0QX+905f/GIzQzf2iprAAAAABJRU5ErkJggg==" width="88" height="31"></a>
This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons Attribution 4.0 International License</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="sibling-projects">Sibling projects<a class="hash-link" href="#sibling-projects" title="Direct link to heading">​</a></h3><p><a href="https://dd388.github.io/crals/" target="_blank" rel="noopener noreferrer">Script Ahoy</a>: Community Resource for Archivists and Librarians Scripting</p><p><a href="https://datapraxis.github.io/sourcecaster/" target="_blank" rel="noopener noreferrer">The Sourcecaster</a>: an app that helps you use the command line to work through common challenges that come up when working with digital primary sources.</p><p><a href="https://pugetsoundandvision.github.io/micropops/" target="_blank" rel="noopener noreferrer">Micropops</a>: One liners and automation tools from Moving Image Preservation of Puget Sound</p><p><a href="https://amiaopensource.github.io/cable-bible/" target="_blank" rel="noopener noreferrer">Cable Bible</a>: A Guide to Cables and Connectors Used for Audiovisual Tech</p><p><a href="https://eaasi.gitlab.io/program_docs/qemu-qed/" target="_blank" rel="noopener noreferrer">QEMU QED</a>: instructions for using QEMU (Quick EMUlator), a command line application for computer emulation and virtualization</p><p><a href="https://amiaopensource.github.io/ffmpeg-artschool/" target="_blank" rel="noopener noreferrer">ffmpeg-artschool</a>: An AMIA workshop featuring scripts, exercises, and activities to make art using FFmpeg</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="learn-about-ffmpeg-basics">Learn about FFmpeg basics<a class="hash-link" href="#learn-about-ffmpeg-basics" title="Direct link to heading">​</a></h2><p>Basic structure of an FFmpeg command</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="basic-structure-of-an-ffmpeg-command">Basic structure of an FFmpeg command<a class="hash-link" href="#basic-structure-of-an-ffmpeg-command" title="Direct link to heading">​</a></h5><p>At its basis, an FFmpeg command is relatively simple. After you have installed FFmpeg (see instructions <a href="https://avpres.net/FFmpeg/#ch1" target="_blank" rel="noopener noreferrer">here</a>), the program is invoked simply by typing <code>ffmpeg</code> at the command prompt.</p><p>Subsequently, each instruction that you supply to FFmpeg is actually a pair: a flag, which designates the <em>type</em> of action you want to carry out; and then the specifics of that action. Flags are always prepended with a hyphen.</p><p>For example, in the instruction <code>-i *input_file.ext*</code>, the <code>-i</code> flag tells FFmpeg that you are supplying an input file, and <code>input_file.ext</code> states which file it is.</p><p>Likewise, in the instruction <code>-c:v prores</code>, the flag <code>-c:v</code> tells FFmpeg that you want to encode the video stream, and <code>prores</code> specifies which codec is to be used. (<code>-c:v</code> is shorthand for <code>-codec:v</code>/<code>-codec:video</code>).</p><p>A very basic FFmpeg command looks like this:</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file.ext</em></p><p>path and name of the input file</p></li><li><p><em>-flag some_action</em></p><p>tell FFmpeg to do something, by supplying a valid flag and action</p></li><li><p><em>output_file.ext</em></p><p>path and name of the output file. Because this is the last part of the command, the filename you type here does not have a flag designating it as the output file.</p></li></ul><p>Link to this command: <a href="https://amiaopensource.github.io/ffmprovisr/index.html#basic-structure" target="_blank" rel="noopener noreferrer">https://amiaopensource.github.io/ffmprovisr/index.html#basic-structure</a></p><p>Streaming vs. Saving</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="streaming-vs-saving">Streaming vs. Saving<a class="hash-link" href="#streaming-vs-saving" title="Direct link to heading">​</a></h5><p>FFplay allows you to stream created video and FFmpeg allows you to save video.</p><p>The following command creates and saves a 10-second video of SMPTE bars:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i smptebars=size=640x480 -t 5 output_file</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command plays and streams SMPTE bars but does not save them on the computer:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi smptebars=size=640x480</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The main difference is small but significant: the <code>-i</code> flag is required for FFmpeg but not required for FFplay. Additionally, the FFmpeg script needs to have <code>-t 5</code> and <code>output.mkv</code> added to specify the length of time to record and the place to save the video.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="learn-about-more-advanced-ffmpeg-concepts">Learn about more advanced FFmpeg concepts<a class="hash-link" href="#learn-about-more-advanced-ffmpeg-concepts" title="Direct link to heading">​</a></h2><p>Batch and Loop script usage</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="batch-and-loop-script-usage">Batch and Loop script usage<a class="hash-link" href="#batch-and-loop-script-usage" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -nostdin -i *input_file* ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>One of the frequent uses of FFmpeg is to run batch commands within loops to, for example, generate access files for an entire collection at once.</p><p>When running an FFmpeg command within a loop it is often necessary to use the <code>-nostdin</code> flag prior to the input in order to ensure successful execution of the commands. This is needed to override FFmpeg&#x27;s default behavior of enabling interaction on standard input which can result in errors as loop inputs are fed to the ongoing command.</p><p>Codec defaults</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="codec-defaults">Codec Defaults<a class="hash-link" href="#codec-defaults" title="Direct link to heading">​</a></h5><p>Unless specified, FFmpeg will automatically set codec choices and codec parameters based off of internal defaults. These defaults are applied based on the file type used in the output (for example <code>.mov</code> or <code>.wav</code>).</p><p>When creating or transcoding files with FFmpeg, it is important to consider codec settings for both audio and video, as the default options may not be desirable in your particular context. The following is a brief list of codec defaults for some common file types:</p><ul><li><code>.avi</code>: Audio Codec: mp3, Video Codec: mpeg4</li><li><code>.mkv</code>: Audio Codec: ac3, Video Codec: H.264</li><li><code>.mov</code>: Audio Codec: AAC, Video Codec: H.264</li><li><code>.mp4</code>: Audio Codec: AAC, Video Codec: H.264</li><li><code>.mpg</code>: Audio Codec: mp2, Video Codec: mpeg1video</li><li><code>.mxf</code>: Audio Codec: pcm_s16le, Video Codec: mpeg2video</li><li><code>.wav</code>: Audio Codec: pcm_s16le (16 bit PCM)</li></ul><p>Filtergraphs</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="filtergraphs">Filtergraphs<a class="hash-link" href="#filtergraphs" title="Direct link to heading">​</a></h5><p>Many FFmpeg commands use filters that manipulate the video or audio stream in some way: for example, <a href="https://ffmpeg.org/ffmpeg-filters.html#hflip" target="_blank" rel="noopener noreferrer">hflip</a> to horizontally flip a video, or <a href="https://ffmpeg.org/ffmpeg-filters.html#amerge-1" target="_blank" rel="noopener noreferrer">amerge</a> to merge two or more audio tracks into a single stream.</p><p>The use of a filter is signaled by the flag <code>-vf</code> (video filter) or <code>-af</code> (audio filter), followed by the name and options of the filter itself. For example, take the <a href="https://amiaopensource.github.io/ffmprovisr/#convert-colorspace" target="_blank" rel="noopener noreferrer">convert colorspace</a> command:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=*src*:*dst* *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here, <a href="https://ffmpeg.org/ffmpeg-filters.html#colormatrix" target="_blank" rel="noopener noreferrer">colormatrix</a> is the filter used, with <em>src</em> and <em>dst</em> representing the source and destination colorspaces. This part following the <code>-vf</code> is a <strong>filtergraph</strong>.</p><p>It is also possible to apply multiple filters to an input, which are sequenced together in the filtergraph. A chained set of filters is called a filter chain, and a filtergraph may include multiple filter chains. Filters in a filterchain are separated from each other by commas (<code>,</code>), and filterchains are separated from each other by semicolons (<code>;</code>). For example, take the <a href="https://amiaopensource.github.io/ffmprovisr/#inverse-telecine" target="_blank" rel="noopener noreferrer">inverse telecine</a> command:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf &quot;fieldmatch,yadif,decimate&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here we have a filtergraph including one filter chain, which is made up of three video filters.</p><p>It is often prudent to enclose your filtergraph in quotation marks; this means that you can use spaces within the filtergraph. Using the inverse telecine example again, the following filter commands are all valid and equivalent:</p><ul><li><code>-vf fieldmatch,yadif,decimate</code></li><li><code>-vf &quot;fieldmatch,yadif,decimate&quot;</code></li><li><code>-vf &quot;fieldmatch, yadif, decimate&quot;</code></li></ul><p>but <code>-vf fieldmatch, yadif, decimate</code> is not valid.</p><p>The ordering of the filters is significant. Video filters are applied in the order given, with the output of one filter being passed along as the input to the next filter in the chain. In the example above, <code>fieldmatch</code> reconstructs the original frames from the inverse telecined video, <code>yadif</code> deinterlaces (this is a failsafe in case any combed frames remain, for example if the source mixes telecined and real interlaced content), and <code>decimate</code> deletes duplicated frames. Clearly, it is not possible to delete duplicated frames before those frames are reconstructed.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="notes">Notes<a class="hash-link" href="#notes" title="Direct link to heading">​</a></h4><ul><li><code>-vf</code> is an alias for <code>-filter:v</code></li><li>If the command involves more than one input or output, you must use the flag <code>-filter_complex</code> instead of <code>-vf</code>.</li><li>Straight quotation marks (&quot;like this&quot;) rather than curved quotation marks (“like this”) should be used.</li></ul><p>For more information, check out the FFmpeg wiki <a href="https://trac.ffmpeg.org/wiki/FilteringGuide" target="_blank" rel="noopener noreferrer">Filtering Guide</a>.</p><p>Stream mapping</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="stream-mapping">Stream mapping<a class="hash-link" href="#stream-mapping" title="Direct link to heading">​</a></h5><p>Stream mapping is the practice of defining which of the streams (e.g., video or audio tracks) present in an input file will be present in the output file. FFmpeg recognizes five stream types:</p><ul><li><code>a</code> - audio</li><li><code>v</code> - video</li><li><code>s</code> - subtitle</li><li><code>d</code> - data (including timecode tracks)</li><li><code>t</code> - attachment</li></ul><p>Mapping is achieved by use of the <code>-map</code> flag, followed by an action of the type <code>file_number:stream_type[:stream_number]</code>. Numbering is zero-indexed, and it&#x27;s possible to map by stream type and/or overall stream order within the input file. For example:</p><ul><li><code>-map 0:v</code> means ‘take all video streams from the first input file’.</li><li><code>-map 0:3</code> means ‘take the fourth stream from the first input file’.</li><li><code>-map 0:a:2</code> means ‘take the third audio stream from the first input file’.</li><li><code>-map 0:0 -map 0:2</code> means ‘take the first and third streams from the first input file’.</li><li><code>-map 0:1 -map 1:0</code> means ‘take the second stream from the first input file and the first stream from the second input file’.</li></ul><p>When no mapping is specified in an ffmpeg command, the default for video files is to take just one video and one audio stream for the output: other stream types, such as timecode or subtitles, will not be copied to the output file by default. If multiple video or audio streams are present, the best quality one is automatically selected by FFmpeg.</p><p>To map <em>all</em> streams in the input file to the output file, use <code>-map 0</code>. However, note that not all container formats can include all stream types: for example, .mp4 cannot contain timecode.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="mapping-with-a-failsafe">Mapping with a failsafe<a class="hash-link" href="#mapping-with-a-failsafe" title="Direct link to heading">​</a></h4><p>To safely process files that may or may not contain given a type of stream, you can add a trailing <code>?</code> to your map commands: for example, <code>-map 0:a?</code> instead of <code>-map 0:a</code>.</p><p>This makes the map optional: audio streams will be mapped over if they are present in the file—but if the file contains no audio streams, the transcode will proceed as usual, minus the audio stream mapping. Without adding the trailing <code>?</code>, FFmpeg will exit with an error on that file.</p><p>This is especially recommended when batch processing video files: it ensures that all files in your batch will be transcoded, whether or not they contain audio streams.</p><p>For more information, check out the FFmpeg wiki <a href="https://trac.ffmpeg.org/wiki/Map" target="_blank" rel="noopener noreferrer">Map</a> page, and the official FFmpeg <a href="https://ffmpeg.org/ffmpeg.html#Advanced-options" target="_blank" rel="noopener noreferrer">documentation on <code>-map</code></a>.</p><p>Link to this command: <a href="https://amiaopensource.github.io/ffmprovisr/index.html#stream-mapping" target="_blank" rel="noopener noreferrer">https://amiaopensource.github.io/ffmprovisr/index.html#stream-mapping</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="change-container-rewrap">Change container (rewrap)<a class="hash-link" href="#change-container-rewrap" title="Direct link to heading">​</a></h2><p>Basic rewrap command</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="rewrap-a-file">Rewrap a file<a class="hash-link" href="#rewrap-a-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file.ext* -c copy -map 0 *output_file.ext*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This script will rewrap a video file. It will create a new video video file where the inner content (the video, audio, and subtitle data) of the original file is unchanged, but these streams are rehoused within a different container format.</p><p><strong>Note:</strong> rewrapping is also known as remuxing, short for re-multiplexing.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file.ext</em></p><p>path and name of the input file</p></li><li><p>-c copy</p><p>copy the streams directly, without re-encoding.</p></li><li><p>-map 0</p><p>map all streams of the input to the output. By default, FFmpeg will only map one stream of each type (video, audio, subtitles) to the output file. However, files may have multiple streams of a given type - for example, a video may have several audio tracks for different languages. Therefore, if you want to preserve all the streams in the original, it&#x27;s necessary to use this option.</p></li><li><p><em>output_file.ext</em></p><p>path and name of the output file. The new container you are rewrapping to is defined by the filename extension used here, e.g. .mkv, .mp4, .mov.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="important-caveat">Important caveat<a class="hash-link" href="#important-caveat" title="Direct link to heading">​</a></h4><p>It may not be possible to rewrap a file&#x27;s contents to a new container without re-encoding one or more of the streams within (that is, the video, audio, and subtitle tracks). Some containers can only contain streams of a certain encoding type: for example, the .mp4 container does not support uncompressed audio tracks. (In practice .mp4 goes hand-in-hand with a H.264-encoded video stream and an AAC-encoded video stream, although other types of video and audio streams are possible). Another example is that the Matroska container does not allow data tracks.</p><p>In such cases, FFmpeg will throw an error. If you encounter errors of this kind, you may wish to consult the <a href="https://amiaopensource.github.io/ffmprovisr/#transcode" target="_blank" rel="noopener noreferrer">list of transcoding recipes</a>.</p><p>Convert to (or create) Broadcast WAV</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="generate-broadcast-wav">Generate Broadcast WAV<a class="hash-link" href="#generate-broadcast-wav" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file.wav* -c copy -write_bext 1 -metadata field_name=&#x27;Content&#x27; *output_file.wav*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will write a file in the Broadcast Wave Format (BWF) containing a BEXT chunk with related metadata.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file.wav</em></p><p>path and name of the input file</p></li><li><p>-c copy</p><p>this will copy the encoding/sample rate etc from the input. If not using a WAV as the input file you will have to specify codec settings in place of this.</p></li><li><p>-write_bext 1</p><p>tells FFmpeg to write a BEXT chunk, the part of the file where BWF metadata is stored.</p></li><li><p>-metadata field_name=&#x27;Content&#x27;</p><p>This is where you can specify which BEXT fields to write, and what information to fill them with by replacing <code>field_name</code> and <code>&#x27;Content&#x27;</code> respectively. See below for additional details.</p></li></ul><p>Notes: You can choose which fields to write by repeating <code>-metadata field_name=&#x27;Content&#x27;</code> for each desired field. Flags for commonly used fields (such as those recommended by the <a href="http://www.digitizationguidelines.gov/audio-visual/documents/Embed_Guideline_20120423.pdf" target="_blank" rel="noopener noreferrer">FADGI guidelines</a>) are as follows:</p><ul><li>description</li><li>originator</li><li>originator_reference</li><li>origination_date</li><li>origination_time</li><li>coding_history</li><li>IARL</li></ul><p>Example: <code>-metadata originator=&#x27;US, UW Libraries&#x27;</code></p><p>Additionally, users should be aware that BWF metadata fields are limited by characters, with some such as OriginatorReference maxing out at 32. Specific information can be found in the <a href="https://tech.ebu.ch/docs/tech/tech3285.pdf" target="_blank" rel="noopener noreferrer">Broadcast Wave Format specification</a>. Additional examples of BWF metadata usage can be found in the <a href="http://www.dlib.indiana.edu/projects/sounddirections/papersPresent/sd_bp_07.pdf" target="_blank" rel="noopener noreferrer">Sound Directions report</a> by Indiana University and Harvard.</p><p>Rewrap DV video to .dv file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="rewrap-dv-video-to-dv-file">Rewrap DV video to .dv file<a class="hash-link" href="#rewrap-dv-video-to-dv-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -f rawvideo -c:v copy *output_file.dv*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This script will take a video that is encoded in the <a href="https://en.wikipedia.org/wiki/DV" target="_blank" rel="noopener noreferrer">DV Codec</a> but wrapped in a different container (such as MOV) and rewrap it into a raw DV file (with the .dv extension). Since DV files potentially contain a great deal of provenance metadata within the DV stream, it is necessary to rewrap files in this method to avoid unintentional stripping of this metadata.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path and name of the input file</p></li><li><p>-f rawvideo</p><p>this tells FFmpeg to pass the video stream as raw video data without remuxing. This step is what ensures the survival of embedded metadata versus a standard rewrap.</p></li><li><p>-c:v copy</p><p>copy the DV stream directly, without re-encoding.</p></li><li><p><em>output_file.dv</em></p><p>tells FFmpeg to use the DV wrapper for the output.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="change-codec-transcode">Change codec (transcode)<a class="hash-link" href="#change-codec-transcode" title="Direct link to heading">​</a></h2><p>Transcode to deinterlaced Apple ProRes LT</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-into-a-deinterlaced-apple-prores-lt">Transcode into a deinterlaced Apple ProRes LT<a class="hash-link" href="#transcode-into-a-deinterlaced-apple-prores-lt" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v prores -profile:v 1 -vf yadif -c:a pcm_s16le *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command transcodes an input file into a deinterlaced Apple ProRes 422 LT file with 16-bit linear PCM encoded audio. The file is deinterlaced using the yadif filter (Yet Another De-Interlacing Filter).</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v prores</p><p>tells FFmpeg to transcode the video stream into Apple ProRes 422</p></li><li><p>-profile:v <em>1</em></p><p>Declares profile of ProRes you want to use. The profiles are explained below:0 = ProRes 422 (Proxy)1 = ProRes 422 (LT)2 = ProRes 422 (Standard)3 = ProRes 422 (HQ)</p></li><li><p>-vf yadif</p><p>Runs a deinterlacing video filter (yet another deinterlacing filter) on the new file. <code>-vf</code> is an alias for <code>-filter:v</code>.</p></li><li><p>-c:a pcm_s16le</p><p>tells FFmpeg to encode the audio stream in 16-bit linear PCM</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file There are currently three possible containers for ProRes 422 and 4444 which are all supported by FFmpeg: QuickTime (<code>.mov</code>), Matroska (<code>.mkv</code>) and Material eXchange Format (<code>.mxf</code>).</p></li></ul><p>FFmpeg comes with more than one ProRes encoder:</p><ul><li><code>prores</code> is much faster, can be used for progressive video only, and seems to be better for video according to Rec. 601 (Recommendation ITU-R BT.601).</li><li><code>prores_ks</code> generates a better file, can also be used for interlaced video, allows also encoding of ProRes 4444 (<code>-c:v prores_ks -profile:v 4</code>) and ProRes 4444 XQ (<code>-c:v prores_ks -profile:v 5</code>), and seems to be better for video according to Rec. 709 (Recommendation ITU-R BT.709).</li></ul><p>Transcode to an H.264 access file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-to-h264">Transcode to H.264<a class="hash-link" href="#transcode-to-h264" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -pix_fmt yuv420p -c:a aac *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an input file and transcodes it to H.264 with an .mp4 wrapper, audio is transcoded to AAC. The libx264 codec defaults to a “medium” preset for compression quality and a CRF of 23. CRF stands for constant rate factor and determines the quality and file size of the resulting H.264 video. A low CRF means high quality and large file size; a high CRF means the opposite.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>tells FFmpeg to encode the video stream as H.264</p></li><li><p>-pix_fmt yuv420p</p><p>libx264 will use a chroma subsampling scheme that is the closest match to that of the input. This can result in Y′CBCR 4:2:0, 4:2:2, or 4:4:4 chroma subsampling. QuickTime and most other non-FFmpeg based players can’t decode H.264 files that are not 4:2:0. In order to allow the video to play in all players, you can specify 4:2:0 chroma subsampling.</p></li><li><p>-c:a aac</p><p>encode audio as AAC. AAC is the codec most often used for audio streams within an .mp4 container.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>In order to optimize the file for streaming, you can add this preset:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -pix_fmt yuv420p -c:a aac -movflags +faststart *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-movflags +faststart</p><p>This tells FFmpeg to move some of the essential metadata to the start of the file, which permits starting viewing before the file finishes downloading (an ideal characteristic for streaming).</p></li></ul><p>In order to use the same basic command to make a higher quality file, you can add some of these presets:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -pix_fmt yuv420p -preset veryslow -crf 18 -c:a aac *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-preset <em>veryslow</em></p><p>This option tells FFmpeg to use the slowest preset possible for the best compression quality. Available presets, from slowest to fastest, are: <code>veryslow</code>, <code>slower</code>, <code>slow</code>, <code>medium</code>, <code>fast</code>, <code>faster</code>, <code>veryfast</code>, <code>superfast</code>, <code>ultrafast</code>.</p></li><li><p>-crf <em>18</em></p><p>Specifying a lower CRF will make a larger file with better visual quality. For H.264 files being encoded with a 4:2:0 chroma subsampling scheme (i.e., using <code>-pix_fmt yuv420p</code>), the scale ranges between 0-51 for 8-bit content, with 0 being lossless and 51 the worst possible quality. If no crf is specified, <code>libx264</code> will use a default value of 23. 18 is often considered a “visually lossless” compression.</p></li></ul><p>By default, this recipe will include one track of each type (e.g. audio, video) in the output file. If you wish to include more tracks, consult the <a href="https://amiaopensource.github.io/ffmprovisr/#stream-mapping" target="_blank" rel="noopener noreferrer">entry on stream mapping</a>.</p><p>For more information, see the <a href="https://trac.ffmpeg.org/wiki/Encode/H.264" target="_blank" rel="noopener noreferrer">FFmpeg and H.264 Encoding Guide</a> on the FFmpeg wiki.</p><p>Transcode to H.264/H.265 using the GPU</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-to-h264h265-using-the-gpu">Transcode to H.264/H.265 using the GPU<a class="hash-link" href="#transcode-to-h264h265-using-the-gpu" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v h264_nvenc -preset llhq -rc:v vbr_hq -cq:v 19 -b:v 8000k -maxrate:v 12000k -profile:v high -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an input file and transcodes it to H.264 using the encoding functionality of an Nvidia GPU (without transcoding the audio). If you&#x27;re using H.264 with AAC or AC3 audio, you can output to an .mp4 file; if you&#x27;re using HEVC and/or more exotic audio, you should output to .mkv. While Nvidia&#x27;s fixed-function hardware can be 10x as performant as encoding on the CPU, it requires a few more parameters in order to optimize quality at lower bitrates.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v <em>h264_nvenc</em></p><p>tells FFmpeg to encode the video stream as H.264 using Nvidia&#x27;s encoder.</p></li><li><p>-preset <em>llhq</em></p><p>uses the &quot;low latency, high quality&quot; encoding preset, a good default when working with nvenc.</p></li><li><p>-rc:v <em>vbr_hq</em></p><p>means &quot;variable bitrate, high quality,&quot; allowing you to set a minimum and maximum bitrate for the encode.</p></li><li><p>-cq:v <em>19</em></p><p>is the same as the CRF quality level specified using x264 or other CPU-based encoders, where 0 is lossless, 51 is the worst possible quality, and values from 18-23 are typical.</p></li><li><p>-b:v <em>8000k -maxrate:v 12000k</em></p><p>corresponds to a minimum bitrate of 8 megabits (8000k) per second, and a maximum of 12 megabits per second. nvenc is not as good at estimating bitrates as CPU-based encoders, and without this data, will occasionally choose a visibly lower bitrate. The 8-12 mbit range is generally a good one for high-quality 1080p h264.</p></li><li><p>-profile:v <em>high</em></p><p>uses the &quot;high quality&quot; profile of h264, something that&#x27;s been baked in to the spec for a long time so that older players can declare compatibility; almost all h264 video now uses high.</p></li><li><p>-c:a <em>copy</em></p><p>will skip reencoding the audio stream, and copy the audio from the source file.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>In order to encode to HEVC instead, and optionally transcode the audio, you can try changing the command like this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v hevc_nvenc -preset llhq -rc:v vbr_hq -cq:v 19 -b:v 5000k -maxrate:v 8000k -profile:v main10 -c:a aac *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-c:v <em>hevc_nvenc</em></p><p>encodes to HEVC (also called H.265), a more efficient codec supported on GPUs from approximately 2015 and newer.</p></li><li><p>-b:v <em>5000k -maxrate:v 8000k</em></p><p>specifies a slightly lower bitrate than when using h264, per HEVC&#x27;s greater efficiency.</p></li><li><p>-profile:v <em>main10</em></p><p>declares the &quot;main10&quot; profile for working with HEVC; one of the primary advantages of this codec is better support for 10-bit video, enabling consumer HDR.</p></li><li><p>-c:a <em>aac</em></p><p>reencodes the audio to AAC with default parameters, a very common and widely supported format for access copies.</p></li></ul><p>Much of the information in this entry was taken from <a href="https://superuser.com/a/1236387" target="_blank" rel="noopener noreferrer">this superuser.com post</a> provided by an Nvidia developer, one of the best sources of information on the ffmpeg Nvidia encoders.</p><p>Transcode from DCP to an H.264 access file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="h264-from-dcp">H.264 from DCP<a class="hash-link" href="#h264-from-dcp" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_video_file*.mxf -i *input_audio_file*.mxf -c:v libx264 -pix_fmt yuv420p -c:a aac *output_file.mp4*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will transcode MXF wrapped video and audio files to an H.264 encoded MP4 file. Please note this only works for unencrypted, single reel DCPs.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_video_file</em></p><p>path and name of the video input file. This extension must be <code>.mxf</code></p></li><li><p>-i <em>input_audio_file</em></p><p>path and name of the audio input file. This extension must be <code>.mxf</code></p></li><li><p>-c:v libx264</p><p>transcodes video to H.264</p></li><li><p>-pix_fmt yuv420p</p><p>sets pixel format to yuv420p for greater compatibility with media players</p></li><li><p>-c:a aac</p><p>re-encodes using the AAC audio codec Note that sadly MP4 cannot contain sound encoded by a PCM (Pulse-Code Modulation) audio codec</p></li><li><p><em>output_file.mp4</em></p><p>path, name and .mp4 extension of the output file</p></li></ul><p>Variation: Copy PCM audio streams by using Matroska instead of the MP4 container</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_video_file*.mxf -i *input_audio_file*.mxf -c:v libx264 -pix_fmt yuv420p -c:a copy *output_file.mkv*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-c:a copy</p><p>re-encodes using the same audio codec</p></li><li><p><em>output_file.mkv</em></p><p>path, name and .mkv extension of the output file</p></li></ul><p>Transcode your file with the FFV1 Version 3 Codec in a Matroska container</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-ffv1-version-3-video-in-a-matroska-container-with-framemd5-of-input">Create FFV1 Version 3 video in a Matroska container with framemd5 of input<a class="hash-link" href="#create-ffv1-version-3-video-in-a-matroska-container-with-framemd5-of-input" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -map 0 -dn -c:v ffv1 -level 3 -g 1 -slicecrc 1 -slices 16 -c:a copy *output_file*.mkv -f framemd5 -an *framemd5_output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will losslessly transcode your video with the FFV1 Version 3 codec in a Matroska container. In order to verify losslessness, a framemd5 of the source video is also generated. For more information on FFV1 encoding, <a href="https://trac.ffmpeg.org/wiki/Encode/FFV1" target="_blank" rel="noopener noreferrer">try the FFmpeg wiki</a>.</p><ul><li><p>ffmpeg</p><p>starts the command.</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file.</p></li><li><p>-map 0</p><p>Map all streams that are present in the input file. This is important as FFmpeg will map only one stream of each type (video, audio, subtitles) by default to the output video.</p></li><li><p>-dn</p><p>ignore data streams (data no). The Matroska container does not allow data tracks.</p></li><li><p>-c:v ffv1</p><p>specifies the FFV1 video codec.</p></li><li><p>-level 3</p><p>specifies Version 3 of the FFV1 codec.</p></li><li><p>-g 1</p><p>specifies intra-frame encoding, or GOP=1.</p></li><li><p>-slicecrc 1</p><p>Adds CRC information for each slice. This makes it possible for a decoder to detect errors in the bitstream, rather than blindly decoding a broken slice. (Read more <a href="http://ndsr.nycdigital.org/diving-in-head-first/" target="_blank" rel="noopener noreferrer">here</a>).</p></li><li><p>-slices 16</p><p>Each frame is split into 16 slices. 16 is a good trade-off between filesize and encoding time.</p></li><li><p>-c:a copy</p><p>copies all mapped audio streams.</p></li><li><p><em>output_file</em>.mkv</p><p>path and name of the output file. Use the <code>.mkv</code> extension to save your file in a Matroska container.</p></li><li><p>-f framemd5</p><p>Decodes video with the framemd5 muxer in order to generate MD5 checksums for every frame of your input file. This allows you to verify losslessness when compared against the framemd5s of the output file.</p></li><li><p>-an</p><p>ignores the audio stream when creating framemd5 (audio no)</p></li><li><p><em>framemd5_output_file</em></p><p>path, name and extension of the framemd5 file.</p></li></ul><p>Convert DVD to H.264</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="convert-dvd-to-h264">Convert DVD to H.264<a class="hash-link" href="#convert-dvd-to-h264" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i concat:*input_file_1*\|*input_file_2*\|*input_file_3* -c:v libx264 -c:a aac *output_file*.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command allows you to create an H.264 file from a DVD source that is not copy-protected.</p><p>Before encoding, you’ll need to establish which of the .VOB files on the DVD or .iso contain the content that you wish to encode. Inside the VIDEO_TS directory, you will see a series of files with names like VTS_01_0.VOB, VTS_01_1.VOB, etc. Some of the .VOB files will contain menus, special features, etc, so locate the ones that contain target content by playing them back in VLC.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i concat:<em>input files</em></p><p>lists the input VOB files and directs FFmpeg to concatenate them. Each input file should be separated by a backslash and a pipe, like so: <code>-i concat:VTS_01_1.VOB\|VTS_01_2.VOB\|VTS_01_3.VOB</code> The backslash is simply an escape character for the pipe (<strong>|</strong>).</p></li><li><p>-c:v libx264</p><p>sets the video codec as H.264</p></li><li><p>-c:a aac</p><p>encode audio as AAC. AAC is the codec most often used for audio streams within an .mp4 container.</p></li><li><p><em>output_file.mp4</em></p><p>path and name of the output file</p></li></ul><p>It’s also possible to adjust the quality of your output by setting the <strong>-crf</strong> and <strong>-preset</strong> values:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i concat:*input_file_1*\|*input_file_2*\|*input_file_3* -c:v libx264 -crf 18 -preset veryslow -c:a aac *output_file*.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-crf 18</p><p>sets the constant rate factor to a visually lossless value. Libx264 defaults to a <a href="https://trac.ffmpeg.org/wiki/Encode/H.264#crf" target="_blank" rel="noopener noreferrer">crf of 23</a>, considered medium quality; a smaller CRF value produces a larger and higher quality video.</p></li><li><p>-preset veryslow</p><p>A slower preset will result in better compression and therefore a higher-quality file. The default is <strong>medium</strong>; slower presets are <strong>slow</strong>, <strong>slower</strong>, and <strong>veryslow</strong>.</p></li></ul><p>Bear in mind that by default, libx264 will only encode a single video stream and a single audio stream, picking the ‘best’ of the options available. To preserve all video and audio streams, add <strong>-map</strong> parameters:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i concat:*input_file_1*\|*input_file_2* -map 0:v -map 0:a -c:v libx264 -c:a aac *output_file*.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-map 0:v</p><p>encodes all video streams</p></li><li><p>-map 0:a</p><p>encodes all audio streams</p></li></ul><p>Transcode to an H.265/HEVC MP4</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-to-h265hevc">Transcode to H.265/HEVC<a class="hash-link" href="#transcode-to-h265hevc" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx265 -pix_fmt yuv420p -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an input file and transcodes it to H.265/HEVC in an .mp4 wrapper, keeping the audio codec the same as in the original file.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx265</p><p>tells FFmpeg to encode the video as H.265</p></li><li><p>-pix_fmt yuv420p</p><p>libx265 will use a chroma subsampling scheme that is the closest match to that of the input. This can result in Y′CBCR 4:2:0, 4:2:2, or 4:4:4 chroma subsampling. For widest accessibility, it’s a good idea to specify 4:2:0 chroma subsampling.</p></li><li><p>-c:a copy</p><p>tells FFmpeg not to change the audio codec</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p>The libx265 encoding library defaults to a ‘medium’ preset for compression quality and a CRF of 28. CRF stands for ‘constant rate factor’ and determines the quality and file size of the resulting H.265 video. The CRF scale ranges from 0 (best quality <!-- -->[lossless]<!-- -->; largest file size) to 51 (worst quality; smallest file size).</p><p>A CRF of 28 for H.265 can be considered a medium setting, <a href="https://trac.ffmpeg.org/wiki/Encode/H.265#ConstantRateFactorCRF" target="_blank" rel="noopener noreferrer">corresponding</a> to a CRF of 23 in <a href="https://amiaopensource.github.io/ffmprovisr/#transcode_h264" target="_blank" rel="noopener noreferrer">encoding H.264</a>, but should result in about half the file size.</p><p>To create a higher quality file, you can add these presets:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx265 -pix_fmt yuv420p -preset veryslow -crf 18 -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-preset <em>veryslow</em></p><p>This option tells FFmpeg to use the slowest preset possible for the best compression quality.</p></li><li><p>-crf <em>18</em></p><p>Specifying a lower CRF will make a larger file with better visual quality. 18 is often considered a ‘visually lossless’ compression.</p></li></ul><p>Transcode to an Ogg Theora</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-to-oggtheora">Transcode to Ogg/Theora<a class="hash-link" href="#transcode-to-oggtheora" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -acodec libvorbis -b:v 690k *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an input file and transcodes it to Ogg/Theora in an .ogv wrapper with 690k video bitrate.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-acodec libvorbis</p><p>tells FFmpeg to encode the audio using libvorbis</p></li><li><p>-b:v 690k</p><p>specifies the 690k video bitrate</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file (make sure to include the <code>.ogv</code> filename suffix)</p></li></ul><p>This recipe is based on <a href="http://paulrouget.com/e/converttohtml5video" target="_blank" rel="noopener noreferrer">Paul Rouget&#x27;s recipes</a>.</p><p>Convert WAV to MP3</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="wav-to-mp3">WAV to MP3<a class="hash-link" href="#wav-to-mp3" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file*.wav -write_id3v1 1 -id3v2_version 3 -dither_method triangular -out_sample_rate 48k -qscale:a 1 *output_file*.mp3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will convert your WAV files to MP3s.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path and name of the input file</p></li><li><p>-write_id3v1 1</p><p>This will write metadata to an ID3v1 tag at the head of the file, assuming you’ve embedded metadata into the WAV file.</p></li><li><p>-id3v2_version 3</p><p>This will write metadata to an ID3v2.3 tag at the tail of the file, assuming you’ve embedded metadata into the WAV file.</p></li><li><p>-dither_method triangular</p><p>Dither makes sure you don’t unnecessarily truncate the dynamic range of your audio.</p></li><li><p>-out_sample_rate 48k</p><p>Sets the audio sampling frequency to 48 kHz. This can be omitted to use the same sampling frequency as the input.</p></li><li><p>-qscale:a 1</p><p>This sets the encoder to use a constant quality with a variable bitrate of between 190-250kbit/s. If you would prefer to use a constant bitrate, this could be replaced with <code>-b:a 320k</code> to set to the maximum bitrate allowed by the MP3 format. For more detailed discussion on variable vs constant bitrates see <a href="https://trac.ffmpeg.org/wiki/Encode/MP3" target="_blank" rel="noopener noreferrer">here.</a></p></li><li><p><em>output_file</em></p><p>path and name of the output file</p></li></ul><p>A couple notes</p><ul><li>About ID3v2.3 tag: ID3v2.3 is better supported than ID3v2.4, FFmpeg&#x27;s default ID3v2 setting.</li><li>About dither methods: FFmpeg comes with a variety of dither algorithms, outlined in the <a href="https://ffmpeg.org/ffmpeg-resampler.html" target="_blank" rel="noopener noreferrer">official docs</a>, though some may lead to unintended, drastic digital clipping on some systems.</li></ul><p>Generate two access MP3s (with and without copyright)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="generate-two-access-mp3s-from-input-one-with-appended-audio-such-as-a-copyright-notice-and-one-unmodified">Generate two access MP3s from input. One with appended audio (such as a copyright notice) and one unmodified.<a class="hash-link" href="#generate-two-access-mp3s-from-input-one-with-appended-audio-such-as-a-copyright-notice-and-one-unmodified" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -i *input_file_to_append* -filter_complex &quot;[0:a:0]asplit=2[a][b];[b]afifo[bb];[1:a:0][bb]concat=n=2:v=0:a=1[concatout]&quot; -map &quot;[a]&quot; -codec:a libmp3lame -dither_method triangular -qscale:a 2 *output_file.mp3* -map &quot;[concatout]&quot; -codec:a libmp3lame -dither_method triangular -qscale:a 2 *output_file_appended.mp3*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This script allows you to generate two derivative audio files from a master while appending audio from a separate file (for example a copyright or institutional notice) to one of them.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file (the master file)</p></li><li><p>-i <em>input_file_to_append</em></p><p>path, name and extension of the input file (the file to be appended to access file)</p></li><li><p>-filter_complex</p><p>enables the complex filtering to manage splitting the input to two audio streams</p></li><li><p>[0🅰️0]<!-- -->asplit=2<!-- -->[a][b]<!-- -->;</p><p><code>asplit</code> allows audio streams to be split up for separate manipulation. This command splits the audio from the first input (the master file) into two streams &quot;a&quot; and &quot;b&quot;</p></li><li><p>[b]<!-- -->afifo<!-- -->[bb]<!-- -->;</p><p>this buffers the stream &quot;b&quot; to help prevent dropped samples and renames stream to &quot;bb&quot;</p></li><li><p>[1🅰️0][bb]<!-- -->concat=n=2:v=0:a=1<!-- -->[concatout]</p><p><code>concat</code> is used to join files. <code>n=2</code> tells the filter there are two inputs. <code>v=0:a=1</code> Tells the filter there are 0 video outputs and 1 audio output. This command appends the audio from the second input to the beginning of stream &quot;bb&quot; and names the output &quot;concatout&quot;</p></li><li><p>-map &quot;<!-- -->[a]<!-- -->&quot;</p><p>this maps the unmodified audio stream to the first output</p></li><li><p>-codec:a libmp3lame -dither_method triangular -qscale:a 2</p><p>sets up MP3 options (using constant quality)</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file (unmodified)</p></li><li><p>-map &quot;<!-- -->[concatout]<!-- -->&quot;</p><p>this maps the modified stream to the second output</p></li><li><p>-codec:a libmp3lame -dither_method triangular -qscale:a 2</p><p>sets up MP3 options (using constant quality)</p></li><li><p><em>output_file_appended</em></p><p>path, name and extension of the output file (with appended notice)</p></li></ul><p>Convert WAV to AAC/MP4</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="wav-to-aacmp4">WAV to AAC/MP4<a class="hash-link" href="#wav-to-aacmp4" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file*.wav -c:a aac -b:a 128k -dither_method triangular -ar 44100 *output_file*.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will convert your WAV file to AAC/MP4.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path and name of the input file</p></li><li><p>-c:a aac</p><p>sets the audio codec to AAC</p></li><li><p>-b:a 128k</p><p>sets the bitrate of the audio to 128k</p></li><li><p>-dither_method triangular</p><p>Dither makes sure you don’t unnecessarily truncate the dynamic range of your audio.</p></li><li><p>-ar 44100</p><p>sets the audio sampling frequency to 44100 Hz, or 44.1 kHz, or “CD quality”</p></li><li><p><em>output_file</em></p><p>path and name of the output file</p></li></ul><p>A note about dither methods. FFmpeg comes with a variety of dither algorithms, outlined in the <a href="https://ffmpeg.org/ffmpeg-resampler.html" target="_blank" rel="noopener noreferrer">official docs</a>, though some may lead to unintended, not-subtle digital clipping on some systems.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="change-video-properties">Change video properties<a class="hash-link" href="#change-video-properties" title="Direct link to heading">​</a></h2><p>Transform 4:3 aspect ratio into 16:9 with pillarbox</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transform-43-aspect-ratio-into-169-with-pillarbox">Transform 4:3 aspect ratio into 16:9 with pillarbox<a class="hash-link" href="#transform-43-aspect-ratio-into-169-with-pillarbox" title="Direct link to heading">​</a></h5><p>Transform a video file with 4:3 aspect ratio into a video file with 16:9 aspect ratio by correct pillarboxing.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v &quot;pad=ih*16/9:ih:(ow-iw)/2:(oh-ih)/2&quot; -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v &quot;pad=ih*16/9:ih:(ow-iw)/2:(oh-ih)/2&quot;</p><p>video padding This resolution independent formula is actually padding any aspect ratio into 16:9 by pillarboxing, because the video filter uses relative values for input width (iw), input height (ih), output width (ow) and output height (oh).</p></li><li><p>-c:a copy</p><p>re-encodes using the same audio codec For silent videos you can replace <code>-c:a copy</code> by <code>-an</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Link to this command: <a href="https://amiaopensource.github.io/ffmprovisr/index.html#SD_HD" target="_blank" rel="noopener noreferrer">https://amiaopensource.github.io/ffmprovisr/index.html#SD_HD</a></p><p>Transform 16:9 aspect ratio video into 4:3 with letterbox</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transform-169-aspect-ratio-video-into-43-with-letterbox">Transform 16:9 aspect ratio video into 4:3 with letterbox<a class="hash-link" href="#transform-169-aspect-ratio-video-into-43-with-letterbox" title="Direct link to heading">​</a></h5><p>Transform a video file with 16:9 aspect ratio into a video file with 4:3 aspect ratio by correct letterboxing.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v &quot;pad=iw:iw*3/4:(ow-iw)/2:(oh-ih)/2&quot; -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v &quot;pad=iw:iw*3/4:(ow-iw)/2:(oh-ih)/2&quot;</p><p>video padding This resolution independent formula is actually padding any aspect ratio into 4:3 by letterboxing, because the video filter uses relative values for input width (iw), input height (ih), output width (ow) and output height (oh).</p></li><li><p>-c:a copy</p><p>re-encodes using the same audio codec For silent videos you can replace <code>-c:a copy</code> by <code>-an</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Flip video image</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="flip-the-video-image-horizontally-andor-vertically">Flip the video image horizontally and/or vertically<a class="hash-link" href="#flip-the-video-image-horizontally-andor-vertically" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v &quot;hflip,vflip&quot; -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v &quot;hflip,vflip&quot;</p><p>flips the image horizontally and vertically By using only one of the parameters hflip or vflip for filtering the image is flipped on that axis only. The quote marks are not mandatory.</p></li><li><p>-c:a copy</p><p>re-encodes using the same audio codec For silent videos you can replace <code>-c:a copy</code> by <code>-an</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Transform SD to HD with pillarbox</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transform-sd-into-hd-with-pillarbox">Transform SD into HD with pillarbox<a class="hash-link" href="#transform-sd-into-hd-with-pillarbox" title="Direct link to heading">​</a></h5><p>Transform a SD video file with 4:3 aspect ratio into an HD video file with 16:9 aspect ratio by correct pillarboxing.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v &quot;colormatrix=bt601:bt709, scale=1440:1080:flags=lanczos, pad=1920:1080:240:0&quot; -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v &quot;colormatrix=bt601:bt709, scale=1440:1080:flags=lanczos, pad=1920:1080:240:0&quot;</p><p>set colour matrix, video scaling and padding Three filters are applied:The luma coefficients are modified from SD video (according to Rec. 601) to HD video (according to Rec. 709) by a color matrix. Note that today Rec. 709 is often used also for SD and therefore you may cancel this parameter.The scaling filter (<code>scale=1440:1080</code>) works for both upscaling and downscaling. We use the Lanczos scaling algorithm (<code>flags=lanczos</code>), which is slower but gives better results than the default bilinear algorithm.The padding filter (<code>pad=1920:1080:240:0</code>) completes the transformation from SD to HD.</p></li><li><p>-c:a copy</p><p>re-encodes using the same audio codec For silent videos you can replace <code>-c:a copy</code> with <code>-an</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>If your source is interlaced, you will want to deinterlace prior to scaling. In that case, your command would look like this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -filter:v &quot;yadif, colormatrix=bt601:bt709, scale=1440:1080:flags=lanczos, pad=1920:1080:240:0&quot; -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>See the <a href="https://amiaopensource.github.io/ffmprovisr/#ntsc_to_h264" target="_blank" rel="noopener noreferrer">Interlaced NTSC to MP4 recipe</a> for a fuller explanation of the deinterlacing step.</p><p>Change display aspect ratio without re-encoding</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="change-display-aspect-ratio-without-re-encoding-video">Change Display Aspect Ratio without re-encoding video<a class="hash-link" href="#change-display-aspect-ratio-without-re-encoding-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v copy -aspect 4:3 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v copy</p><p>Copy all mapped video streams.</p></li><li><p>-aspect 4:3</p><p>Change Display Aspect Ratio to <code>4:3</code>. Experiment with other aspect ratios such as <code>16:9</code>. If used together with <code>-c:v copy</code>, it will affect the aspect ratio stored at container level, but not the aspect ratio stored in encoded frames, if it exists.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Convert colorspace of video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-video-to-a-different-colorspace">Transcode video to a different colorspace<a class="hash-link" href="#transcode-video-to-a-different-colorspace" title="Direct link to heading">​</a></h5><p>This command uses a filter to convert the video to a different colorspace.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=src:dst *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>tells FFmpeg to encode the video stream as H.264</p></li><li><p>-vf colormatrix=<em>src</em>:<em>dst</em></p><p>the video filter <strong>colormatrix</strong> will be applied, with the given source and destination colorspaces. Accepted values include <code>bt601</code> (Rec.601), <code>smpte170m</code> (Rec.601, 525-line/<a href="https://en.wikipedia.org/wiki/NTSC#NTSC-M" target="_blank" rel="noopener noreferrer">NTSC</a> version), <code>bt470bg</code> (Rec.601, 625-line/<a href="https://en.wikipedia.org/wiki/PAL#PAL-B.2FG.2FD.2FK.2FI" target="_blank" rel="noopener noreferrer">PAL</a> version), <code>bt709</code> (Rec.709), and <code>bt2020</code> (Rec.2020). For example, to convert from Rec.601 to Rec.709, you would use <code>-vf colormatrix=bt601:bt709</code>.</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p><strong>Note:</strong> Converting between colorspaces with FFmpeg can be done via either the <strong>colormatrix</strong> or <strong>colorspace</strong> filters, with colorspace allowing finer control (individual setting of colorspace, transfer characteristics, primaries, range, pixel format, etc). See <a href="https://trac.ffmpeg.org/wiki/colorspace" target="_blank" rel="noopener noreferrer">this</a> entry on the FFmpeg wiki, and the FFmpeg documentation for <a href="https://ffmpeg.org/ffmpeg-filters.html#colormatrix" target="_blank" rel="noopener noreferrer">colormatrix</a> and <a href="https://ffmpeg.org/ffmpeg-filters.html#colorspace" target="_blank" rel="noopener noreferrer">colorspace</a>.</p><hr><h4 class="anchor anchorWithStickyNavbar_mojV" id="convert-colorspace-and-embed-colorspace-metadata">Convert colorspace and embed colorspace metadata<a class="hash-link" href="#convert-colorspace-and-embed-colorspace-metadata" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=src:dst -color_primaries *val* -color_trc *val* -colorspace *val* *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>encode video as H.264</p></li><li><p>-vf colormatrix=<em>src</em>:<em>dst</em></p><p>the video filter <strong>colormatrix</strong> will be applied, with the given source and destination colorspaces.</p></li><li><p>-color_primaries <em>val</em></p><p>tags video with the given color primaries. Accepted values include <code>smpte170m</code> (Rec.601, 525-line/NTSC version), <code>bt470bg</code> (Rec.601, 625-line/PAL version), <code>bt709</code> (Rec.709), and <code>bt2020</code> (Rec.2020).</p></li><li><p>-color_trc <em>val</em></p><p>tags video with the given transfer characteristics (gamma). Accepted values include <code>smpte170m</code> (Rec.601, 525-line/NTSC version), <code>gamma28</code> (Rec.601, 625-line/PAL version)<a href="https://amiaopensource.github.io/ffmprovisr/#fn1" target="_blank" rel="noopener noreferrer">1</a>, <code>bt709</code> (Rec.709), <code>bt2020_10</code> (Rec.2020 10-bit), and <code>bt2020_12</code> (Rec.2020 12-bit).</p></li><li><p>-colorspace <em>val</em></p><p>tags video as being in the given colourspace. Accepted values include <code>smpte170m</code> (Rec.601, 525-line/NTSC version), <code>bt470bg</code> (Rec.601, 625-line/PAL version), <code>bt709</code> (Rec.709), <code>bt2020_cl</code> (Rec.2020 constant luminance), and <code>bt2020_ncl</code> (Rec.2020 non-constant luminance).</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="examples">Examples<a class="hash-link" href="#examples" title="Direct link to heading">​</a></h4><p>To Rec.601 (525-line/NTSC):</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=bt709:smpte170m -color_primaries smpte170m -color_trc smpte170m -colorspace smpte170m *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To Rec.601 (625-line/PAL):</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=bt709:bt470bg -color_primaries bt470bg -color_trc gamma28 -colorspace bt470bg *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>To Rec.709:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf colormatrix=bt601:bt709 -color_primaries bt709 -color_trc bt709 -colorspace bt709 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>MediaInfo output examples:</p><p><img alt="MediaInfo screenshots of colorspace metadata" src="/assets/images/colourspace_metadata_mediainfo-a3c0f488f13bd08442212f5adeb069d0.png" width="550" height="126"></p><p>⚠ Using this command it is possible to add Rec.709 tags to a file that is actually Rec.601 (etc), so apply with caution!</p><p>These commands are relevant for H.264 and H.265 videos, encoded with <code>libx264</code> and <code>libx265</code> respectively.</p><p><strong>Note:</strong> If you wish to embed colorspace metadata <em>without</em> changing to another colorspace, omit <code>-vf colormatrix=src:dst</code>. However, since it is <code>libx264</code>/<code>libx265</code> that writes the metadata, it’s not possible to add these tags without re-encoding the video stream.</p><p>For all possible values for <code>-color_primaries</code>, <code>-color_trc</code>, and <code>-colorspace</code>, see the FFmpeg documentation on <a href="https://ffmpeg.org/ffmpeg-codecs.html#Codec-Options" target="_blank" rel="noopener noreferrer">codec options</a>.</p><hr><ol><li>Out of step with the regular pattern, <code>-color_trc</code> doesn’t accept <code>bt470bg</code>; it is instead here referred to directly as gamma.</li></ol><p>In the Rec.601 standard, 525-line/NTSC and 625-line/PAL video have assumed gammas of 2.2 and 2.8 respectively. <a href="https://amiaopensource.github.io/ffmprovisr/#ref1" target="_blank" rel="noopener noreferrer">↩</a></p><p>Modify image and sound speed</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="modify-image-and-sound-speed">Modify image and sound speed<a class="hash-link" href="#modify-image-and-sound-speed" title="Direct link to heading">​</a></h5><p>E.g. for converting 24fps to 25fps with audio pitch compensation for PAL access copies. (Thanks @kieranjol!)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -r *output_fps* -filter_complex &quot;[0:v]setpts=*input_fps*/*output_fps**PTS[v]; [0:a]atempo=*output_fps*/*input_fps*[a]&quot; -map &quot;[v]&quot; -map &quot;[a]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-r <em>output_fps</em></p><p>sets the frame rate of the <em>output_file</em></p></li><li><p>-filter_complex &quot;<!-- -->[0:v]<!-- -->setpts=<em>input_fps</em>/<em>output_fps**PTS<!-- -->[v]<!-- -->; <!-- -->[0:a]<!-- -->atempo=</em>output_fps<em>/</em>input_fps*<!-- -->[a]<!-- -->&quot;</p><p>A complex filter is needed here, in order to handle video stream and the audio stream separately. The <code>setpts</code> video filter modifies the PTS (presentation time stamp) of the video stream, and the <code>atempo</code> audio filter modifies the speed of the audio stream while keeping the same sound pitch. Note that the parameter order for the image and for the sound are inverted:In the video filter <code>setpts</code> the numerator <code>input_fps</code> sets the input speed and the denominator <code>output_fps</code> sets the output speed; both values are given in frames per second.In the sound filter <code>atempo</code> the numerator <code>output_fps</code> sets the output speed and the denominator <code>input_fps</code> sets the input speed; both values are given in frames per second.The different filters in a complex filter can be divided either by comma or semicolon. The quotation marks allow to insert a space between the filters for readability.</p></li><li><p>-map &quot;<!-- -->[v]<!-- -->&quot;</p><p>maps the video stream and</p></li><li><p>-map &quot;<!-- -->[a]<!-- -->&quot;</p><p>maps the audio stream together into:</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Fade both video and audio streams</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="fade-both-video-and-audio-streams">Fade both video and audio streams<a class="hash-link" href="#fade-both-video-and-audio-streams" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v &quot;fade=in:st=IN_POINT:d=DURATION, fade=out:st=OUT_POINT:d=DURATION&quot; -filter:a &quot;afade=in:st=OUT_POINT:d=DURATION, afade=out:st=IN_POINT:d=DURATION&quot; -c:v libx264 -c:a aac *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command fades your video in and out. Change IN_POINT, OUT_POINT, and DURATION to the time in seconds (expressed as integers).</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v &quot;fade=in:st=IN_POINT:d=DURATION, fade=out:st=OUT_POINT:d=DURATION&quot;</p><p>applies a video filter that fades your video in and out. <code>st</code> sets the start and <code>d</code> sets the duration.</p></li><li><p>-filter:a &quot;afade=in:st=IN_POINT:d=DURATION, afade=out:st=OUT_POINT:d=DURATION&quot;</p><p>applies an audio filter that fades your video in and out. <code>st</code> sets the start and <code>d</code> sets the duration.</p></li><li><p>-c:v <em>video_codec</em></p><p>as a video filter is used, it is not possible to use <code>-c copy</code>. The video must be re-encoded with whatever video codec is chosen, e.g. <code>ffv1</code>, <code>v210</code> or <code>prores</code>.</p></li><li><p>-c:a <em>audio_codec</em></p><p>as an audio filter is used, it is not possible to use <code>-c copy</code>. The audio must be re-encoded with whatever audio codec is chosen, e.g. <code>aac</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output_file</p></li></ul><p>Synchronize video and audio streams</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="synchronize-video-and-audio-streams">Synchronize video and audio streams<a class="hash-link" href="#synchronize-video-and-audio-streams" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -itsoffset 0.125 -i *input_file* -map 1:v -map 0:a -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>A command to slip the video channel approximate 2 frames (0.125 for a 25fps timeline) to align video and audio drift, if generated during video tape capture for example.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-itsoffset 0.125</p><p>uses itsoffset command to set offset to 0.125 of a second. The offset time must be a time duration specification, see <a href="https://ffmpeg.org/ffmpeg-utils.html#time-duration-syntax" target="_blank" rel="noopener noreferrer">FFMPEG Utils Time Duration Syntax</a>.</p></li><li><p>-i <em>input_file</em></p><p>repeat path, name and extension of the input file</p></li><li><p>-map 1:v -map 0:a</p><p>selects the video channel for itsoffset command. To slip the audio channel reverse the selection to -map 0:v -map 1:a.</p></li><li><p>-c copy</p><p>copies the encode settings of the input_file to the output_file</p></li><li><p><em>output_file_resync</em></p><p>path, name and extension of the output_file</p></li></ul><p>Clarify stream properties</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="set-stream-properties">Set stream properties<a class="hash-link" href="#set-stream-properties" title="Direct link to heading">​</a></h5><h2 class="anchor anchorWithStickyNavbar_mojV" id="find-undetermined-or-unknown-stream-properties">Find undetermined or unknown stream properties<a class="hash-link" href="#find-undetermined-or-unknown-stream-properties" title="Direct link to heading">​</a></h2><p>These examples use QuickTime inputs and outputs. The strategy will vary or may not be possible in other file formats. In the case of these examples it is the intention to make a lossless copy while clarifying an unknown characteristic of the stream.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe *input_file* -show_streams</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-show_streams</p><p>Shows metadata of stream properties</p></li></ul><p>Values that are set to &#x27;unknown&#x27; and &#x27;undetermined&#x27; may be unspecified within the stream. An unknown aspect ratio would be expressed as &#x27;0:1&#x27;. Streams with many unknown properties may have interoperability issues or not play as intended. In many cases, an unknown or undetermined value may be accurate because the information about the source is unclear, but often the value is intended to be known. In many cases the stream will played with an assumed value if undetermined (for instance a display_aspect_ratio of &#x27;0:1&#x27; may be played as &#x27;WIDTH:HEIGHT&#x27;), but this may or may not be what is intended. Use carefully.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="set-aspect-ratio">Set aspect ratio<a class="hash-link" href="#set-aspect-ratio" title="Direct link to heading">​</a></h2><p>If the display_aspect_ratio is set to &#x27;0:1&#x27; it may be clarified with the <em>-aspect</em> option and stream copy.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c copy -map 0 -aspect DAR_NUM:DAR_DEN *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c copy</p><p>Using stream copy for all streams</p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output.</p></li><li><p>-aspect DAR_NUM:DAR_DEN</p><p>Replace DAR_NUM with the display aspect ratio numerator and DAR_DEN with the display aspect ratio denominator, such as <em>-aspect 4:3</em> or <em>-aspect 16:9</em>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="adding-other-stream-properties">Adding other stream properties.<a class="hash-link" href="#adding-other-stream-properties" title="Direct link to heading">​</a></h2><p>Other properties may be clarified in a similar way. Replace <em>-aspect</em> and its value with other properties such as shown in the options below. Note that setting color values in QuickTime requires that <em>-movflags write_colr</em> is set.</p><ul><li><p>-color_primaries <em>VALUE</em> -movflags write_colr</p><p>Set a new color_primaries value.</p></li><li><p>-color_trc <em>VALUE</em> -movflags write_colr</p><p>Set a new color_transfer value.</p></li><li><p>-field_order <em>VALUE</em></p><p>Set interlacement values.</p></li></ul><p>The possible values for <code>-color_primaries</code>, <code>-color_trc</code>, and <code>-field_order</code> are given in the <a href="https://ffmpeg.org/ffmpeg-all.html#toc-Codec-Options" target="_blank" rel="noopener noreferrer">Codec Options</a> section of the FFmpeg docs - scroll down to near the bottom of the section.</p><p>Crop video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="crop-video">Crop video<a class="hash-link" href="#crop-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -vf &quot;crop=*width*:*height*&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command crops the input video to the dimensions defined</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-vf &quot;<em>width</em>:<em>height</em>&quot;</p><p>Crops the video to the given width and height (in pixels). By default, the crop area is centered: that is, the position of the top left of the cropped area is set to x = (<em>input_width</em> - <em>output_width</em>) / 2, y = <em>input_height</em> - <em>output_height</em>) / 2.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>It&#x27;s also possible to specify the crop position by adding the x and y coordinates representing the top left of your cropped area to your crop filter, as such:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -vf &quot;crop=*width*:*height*[:*x_position*:*y_position*]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="examples-1">Examples<a class="hash-link" href="#examples-1" title="Direct link to heading">​</a></h5><p>The original frame, a screenshot of Maggie Cheung in the film <em>Hero</em>:</p><p><img alt="VLC screenshot of Maggie Cheung" src="/assets/images/crop_example_orig-9ca7244e8c5b2591d095e111e67f6213.png" width="1216" height="544"></p><p>Result of the command <code>ffmpeg -i *maggie.mov* -vf &quot;crop=500:500&quot; *output_file*</code>:</p><p><img alt="VLC screenshot of Maggie Cheung, cropped from original" src="/assets/images/crop_example_aftercrop1-ac0742197f9d9c6de170dea46ac33c68.png" width="500" height="500"></p><p>Result of the command <code>ffmpeg -i *maggie.mov* -vf &quot;crop=500:500:0:0&quot; *output_file*</code>, appending <code>:0:0</code> to crop from the top left corner:</p><p><img alt="VLC screenshot of Maggie Cheung, cropped from original" src="/assets/images/crop_example_aftercrop2-63eabfebdc3dcf5ba4649840b8dcad31.png" width="500" height="500"></p><p>Result of the command <code>ffmpeg -i *maggie.mov* -vf &quot;crop=500:300:500:30&quot; *output_file*</code>:</p><p><img alt="VLC screenshot of Maggie Cheung, cropped from original" src="/assets/images/crop_example_aftercrop3-88088ca74b6951fa2e924a79302726bf.png" width="500" height="300"></p><p>Change video color to black and white</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="change-video-color-to-black-and-white">Change video color to black and white<a class="hash-link" href="#change-video-color-to-black-and-white" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter_complex hue=s=0 -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>A basic command to alter color hue to black and white using filter_complex (credit @FFMPEG via Twitter).</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter_complex hue=s=0</p><p>uses filter_complex command to set the hue to black and white</p></li><li><p>-c:a copy</p><p>copies the encode settings of the input_file to the output_file</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output_file</p></li></ul><p>An alternative that preserves interlacing information for a ProRes 422 HQ file generated, for example, from a tape master (credit Dave Rice):</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v prores_ks -flags +ildct -map 0 -c:a copy -profile:v 3 -vf hue=s=0 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v prores_ks</p><p>encodes the video to ProRes (prores_ks marks the stream as interlaced, unlike prores)</p></li><li><p>-flags +ildct</p><p>ensures that the output_file has interlaced field encoding, using interlace aware discrete cosine transform</p></li><li><p>-map 0</p><p>ensures ffmpeg maps all streams of the input_file to the output_file</p></li><li><p>-c:a copy</p><p>copies the encode settings of the input_file to the output_file</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="change-or-view-audio-properties">Change or view audio properties<a class="hash-link" href="#change-or-view-audio-properties" title="Direct link to heading">​</a></h2><p>Extract audio without loss from an AV file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="extract-audio-from-an-av-file">Extract audio from an AV file<a class="hash-link" href="#extract-audio-from-an-av-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:a copy -vn *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command extracts the audio stream without loss from an audiovisual file.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:a copy</p><p>re-encodes using the same audio codec</p></li><li><p>-vn</p><p>no video stream</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Combine audio tracks</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="combine-audio-tracks-into-one-in-a-video-file">Combine audio tracks into one in a video file<a class="hash-link" href="#combine-audio-tracks-into-one-in-a-video-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter_complex &quot;[0:a:0][0:a:1]amerge[out]&quot; -map 0:v -map &quot;[out]&quot; -c:v copy -shortest *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command combines two audio tracks present in a video file into one stream. It can be useful in situations where a downstream process, like YouTube’s automatic captioning, expect one audio track. To ensure that you’re mapping the right audio tracks run ffprobe before writing the script to identify which tracks are desired. More than two audio streams can be combined by extending the pattern present in the -filter_complex option.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter_complex</p><p>tells ffmpeg that we will be using a complex filter</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>[0🅰️0][0:a:1]<!-- -->amerge<!-- -->[out]</p><p>combines the two audio tracks into one</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li><li><p>-map 0:v</p><p>map the video</p></li><li><p>-map &quot;<!-- -->[out]<!-- -->&quot;</p><p>map the combined audio defined by the filter</p></li><li><p>-c:v copy</p><p>copy the video</p></li><li><p>-shortest</p><p>limit to the shortest stream</p></li><li><p><em>output_file</em></p><p>path, name and extension of the video output file</p></li></ul><p>Inverses the audio phase of the second channel</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="flip-audio-phase-shift">Flip audio phase shift<a class="hash-link" href="#flip-audio-phase-shift" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af pan=&quot;stereo|c0=c0|c1=-1*c1&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command inverses the audio phase of the second channel by rotating it 180°.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-af</p><p>specifies that the next section should be interpreted as an audio filter</p></li><li><p>pan=</p><p>tell the quoted text below to use the <a href="https://ffmpeg.org/ffmpeg-filters.html#pan-1" target="_blank" rel="noopener noreferrer">pan filter</a></p></li><li><p>&quot;stereo|c0=c0|c1=-1*c1&quot;</p><p>maps the output&#x27;s first channel (c0) to the input&#x27;s first channel and the output&#x27;s second channel (c1) to the inverse of the input&#x27;s second channel</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p>Calculate Loudness Levels</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="calculate-loudness-levels">Calculate Loudness Levels<a class="hash-link" href="#calculate-loudness-levels" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af loudnorm=print_format=json -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This filter calculates and outputs loudness information in json about an input file (labeled input) as well as what the levels would be if loudnorm were applied in its one pass mode (labeled output). The values generated can be used as inputs for a &#x27;second pass&#x27; of the loudnorm filter allowing more accurate loudness normalization than if it is used in a single pass.</p><p>These instructions use the loudnorm defaults, which align well with PBS recommendations for target loudness. More information can be found at the <a href="https://ffmpeg.org/ffmpeg-filters.html#loudnorm" target="_blank" rel="noopener noreferrer">loudnorm documentation</a>.</p><p>Information about PBS loudness standards can be found in the <!-- -->[PBS Technical Operating Specifications]<!-- -->(<a href="http://bento.cdn.pbs.org/hostedbento-prod/filer_public/PBS_About/Producing/Red" target="_blank" rel="noopener noreferrer">http://bento.cdn.pbs.org/hostedbento-prod/filer_public/PBS_About/Producing/Red</a> Book/TOS Pt 1 Submission 2016.pdf) document. Information about EBU loudness standards can be found in the <a href="https://tech.ebu.ch/docs/r/r128-2014.pdf" target="_blank" rel="noopener noreferrer">EBU R 128</a> recommendation document.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af loudnorm</p><p>activates the loudnorm filter</p></li><li><p>print_format=json</p><p>sets the output format for loudness information to json. This format makes it easy to use in a second pass. For a more human readable output, this can be set to <code>print_format=summary</code></p></li><li><p><em>-f null -</em></p><p>sets the file output to null (since we are only interested in the metadata generated)</p></li></ul><p>RIAA Equalization</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="riaa-equalization">RIAA Equalization<a class="hash-link" href="#riaa-equalization" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af aemphasis=type=riaa *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will apply RIAA equalization to an input file allowing correct listening of audio transferred &#x27;flat&#x27; (without EQ) from records that used this EQ curve. For more information about RIAA equalization see the <a href="https://en.wikipedia.org/wiki/RIAA_equalization" target="_blank" rel="noopener noreferrer">Wikipedia page</a> on the subject.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af aemphasis=type=riaa</p><p>activates the aemphasis filter and sets it to use RIAA equalization</p></li><li><p><em>output_file</em></p><p>path and name of output file</p></li></ul><p>Reverse CD Pre-Emphasis</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="reverse-cd-pre-emphasis">Reverse CD Pre-Emphasis<a class="hash-link" href="#reverse-cd-pre-emphasis" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af aemphasis=type=cd *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will apply de-emphasis to reverse the effects of CD pre-emphasis in the somewhat rare case of CDs that were created with this technology. Use this command to create more accurate listening copies of files that were ripped &#x27;flat&#x27; (without any de-emphasis) where the original source utilized emphasis. For more information about CD pre-emphasis see the <a href="https://wiki.hydrogenaud.io/index.php?title=Pre-emphasis" target="_blank" rel="noopener noreferrer">Hydrogen Audio page</a> on this subject.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af aemphasis=type=cd</p><p>activates the aemphasis filter and sets it to use CD equalization</p></li><li><p><em>output_file</em></p><p>path and name of output file</p></li></ul><p>One Pass Loudness Normalization</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="one-pass-loudness-normalization">One Pass Loudness Normalization<a class="hash-link" href="#one-pass-loudness-normalization" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af loudnorm=dual_mono=true -ar 48k *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will normalize the loudness of an input using one pass, which is quicker but less accurate than using two passes. This command uses the loudnorm filter defaults for target loudness. These defaults align well with PBS recommendations, but loudnorm does allow targeting of specific loudness levels. More information can be found at the <a href="https://ffmpeg.org/ffmpeg-filters.html#loudnorm" target="_blank" rel="noopener noreferrer">loudnorm documentation</a>.</p><p>Information about PBS loudness standards can be found in the <a href="https://www-tc.pbs.org/capt/Producing/TOS-2012-Pt2-Distribution.pdf" target="_blank" rel="noopener noreferrer">PBS Technical Operating Specifications</a> document. Information about EBU loudness standards can be found in the <a href="https://tech.ebu.ch/docs/r/r128-2014.pdf" target="_blank" rel="noopener noreferrer">EBU R 128</a> recommendation document.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af loudnorm</p><p>activates the loudnorm filter with default settings</p></li><li><p>dual_mono=true</p><p>(optional) Use this for mono files meant to be played back on stereo systems for correct loudness. Not necessary for multi-track inputs.</p></li><li><p>-ar 48k</p><p>Sets the output sample rate to 48 kHz. (The loudnorm filter upsamples to 192 kHz so it is best to manually set a desired output sample rate).</p></li><li><p><em>output_file</em></p><p>path, name and extension for output file</p></li></ul><p>Two Pass Loudness Normalization</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="two-pass-loudness-normalization">Two Pass Loudness Normalization<a class="hash-link" href="#two-pass-loudness-normalization" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af loudnorm=dual_mono=true:measured_I=*input_i*:measured_TP=*input_tp*:measured_LRA=*input_lra*:measured_thresh=*input_thresh*:offset=*target_offset*:linear=true -ar 48k *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command allows using the levels calculated using a <a href="https://amiaopensource.github.io/ffmprovisr/#loudnorm_metadata" target="_blank" rel="noopener noreferrer">first pass of the loudnorm filter</a> to more accurately normalize loudness. This command uses the loudnorm filter defaults for target loudness. These defaults align well with PBS recommendations, but loudnorm does allow targeting of specific loudness levels. More information can be found at the <a href="https://ffmpeg.org/ffmpeg-filters.html#loudnorm" target="_blank" rel="noopener noreferrer">loudnorm documentation</a>.</p><p>Information about PBS loudness standards can be found in the <a href="https://www-tc.pbs.org/capt/Producing/TOS-2012-Pt2-Distribution.pdf" target="_blank" rel="noopener noreferrer">PBS Technical Operating Specifications</a> document. Information about EBU loudness standards can be found in the <a href="https://tech.ebu.ch/docs/r/r128-2014.pdf" target="_blank" rel="noopener noreferrer">EBU R 128</a> recommendation document.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af loudnorm</p><p>activates the loudnorm filter with default settings</p></li><li><p>dual_mono=true</p><p>(optional) use this for mono files meant to be played back on stereo systems for correct loudness. Not necessary for multi-track inputs.</p></li><li><p>measured_I=<em>input_i</em></p><p>use the &#x27;input_i&#x27; value (integrated loudness) from the first pass in place of input_i</p></li><li><p>measured_TP=<em>input_tp</em></p><p>use the &#x27;input_tp&#x27; value (true peak) from the first pass in place of input_tp</p></li><li><p>measured_LRA=<em>input_lra</em></p><p>use the &#x27;input_lra&#x27; value (loudness range) from the first pass in place of input_lra</p></li><li><p>measured_LRA=<em>input_thresh</em></p><p>use the &#x27;input_thresh&#x27; value (threshold) from the first pass in place of input_thresh</p></li><li><p>offset=<em>target_offset</em></p><p>use the &#x27;target_offset&#x27; value (offset) from the first pass in place of target_offset</p></li><li><p>linear=true</p><p>tells loudnorm to use linear normalization</p></li><li><p>-ar 48k</p><p>Sets the output sample rate to 48 kHz. (The loudnorm filter upsamples to 192 kHz so it is best to manually set a desired output sample rate).</p></li><li><p><em>output_file</em></p><p>path, name and extension for output file</p></li></ul><p>Fix A/V sync issues by resampling audio</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="fix-av-sync-resample-audio">Fix AV Sync: Resample audio<a class="hash-link" href="#fix-av-sync-resample-audio" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v copy -c:a pcm_s16le -af &quot;aresample=async=1000&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v copy</p><p>Copy all mapped video streams.</p></li><li><p>-c:a pcm_s16le</p><p>tells FFmpeg to encode the audio stream in 16-bit linear PCM (<a href="https://en.wikipedia.org/wiki/Endianness#Little-endian" target="_blank" rel="noopener noreferrer">little endian</a>)</p></li><li><p>-af &quot;aresample=async=1000&quot;</p><p>Uses the <a href="https://ffmpeg.org/ffmpeg-filters.html#aresample-1" target="_blank" rel="noopener noreferrer">aresample</a> filter to stretch/squeeze samples to given timestamps, with a maximum of 1000 samples per second compensation.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file. Try different file extensions such as mkv, mov, mp4, or avi.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="join-trim-or-create-an-excerpt">Join, trim, or create an excerpt<a class="hash-link" href="#join-trim-or-create-an-excerpt" title="Direct link to heading">​</a></h2><p>Join (concatenate) two or more files of the same type</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="join-files-together">Join files together<a class="hash-link" href="#join-files-together" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f concat -i mylist.txt -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes two or more files of the same file type and joins them together to make a single file. All that the program needs is a text file with a list specifying the files that should be joined. If possible, run the command from the same directory where the files and the text file reside. Otherwise you&#x27;ll have to use <code>-safe 0</code>, see below for more information. However, it only works properly if the files to be combined have the exact same codec and technical specifications. Be careful, FFmpeg may appear to have successfully joined two video files with different codecs, but may only bring over the audio from the second file or have other weird behaviors. Don’t use this command for joining files with different codecs and technical specs and always preview your resulting video file!</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f concat</p><p>forces ffmpeg to concatenate the files and to keep the same file format</p></li><li><p>-i <em>mylist.txt</em></p><p>path, name and extension of the input file. Per the <a href="https://ffmpeg.org/ffmpeg-formats.html#Options" target="_blank" rel="noopener noreferrer">FFmpeg documentation</a>, it is preferable to specify relative rather than absolute file paths, as allowing absolute file paths may pose a security risk. This text file contains the list of files (without their absolute path) to be concatenated and should be formatted as follows:<code> file &#x27;*first_file.ext*&#x27;  file &#x27;*second_file.ext*&#x27;  . . .  file &#x27;*last_file.ext*&#x27;</code>In the above, <strong>file</strong> is simply the word &quot;file&quot;. Straight apostrophes (&#x27;like this&#x27;) rather than curved quotation marks (‘like this’) must be used to enclose the file paths. <strong>Note:</strong> If specifying absolute file paths in the .txt file, add <code>-safe 0</code> before the input file. e.g.: <code>ffmpeg -f concat -safe 0 -i mylist.txt -c copy *output_file*</code></p></li><li><p>-c copy</p><p>use stream copy mode to re-mux instead of re-encode</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>For more information, see the <a href="https://trac.ffmpeg.org/wiki/Concatenate" target="_blank" rel="noopener noreferrer">FFmpeg wiki page on concatenating files</a>.</p><p>Join (concatenate) two or more files of different types</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="join-files-together-1">Join files together<a class="hash-link" href="#join-files-together-1" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input_1.avi -i input_2.mp4 -filter_complex &quot;[0:v:0][0:a:0][1:v:0][1:a:0]concat=n=2:v=1:a=1[video_out][audio_out]&quot; -map &quot;[video_out]&quot; -map &quot;[audio_out]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes two or more files of the different file types and joins them together to make a single file.</p><p>The input files may differ in many respects - container, codec, chroma subsampling scheme, framerate, etc. However, the above command only works properly if the files to be combined have the same dimensions (e.g., 720x576). Also note that if the input files have different framerates, then the output file will be of variable framerate.</p><p>Some aspects of the input files will be normalized: for example, if an input file contains a video track and an audio track that do not have exactly the same duration, the shorter one will be padded. In the case of a shorter video track, the last frame will be repeated in order to cover the missing video; in the case of a shorter audio track, the audio stream will be padded with silence.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_1.ext</em></p><p>path, name and extension of the first input file</p></li><li><p>-i <em>input_2.ext</em></p><p>path, name and extension of the second input file</p></li><li><p>-filter_complex</p><p>states that a complex filtergraph will be used</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>[0✌️0][0:a:0]</p><p>selects the first video stream and first audio stream from the first input. Each reference to a specific stream is enclosed in square brackets. In the first stream reference, <code>0:v:0</code>, the first zero refers to the first input file, <code>v</code> means video stream, and the second zero indicates that it is the <em>first</em> video stream in the file that should be selected. Likewise, <code>0:a:0</code> means the first audio stream in the first input file. As demonstrated above, ffmpeg uses zero-indexing: <code>0</code> means the first input/stream/etc, <code>1</code> means the second input/stream/etc, and <code>4</code> would mean the fifth input/stream/etc.</p></li><li><p>[1✌️0][1:a:0]</p><p>As described above, this means select the first video and audio streams from the second input file.</p></li><li><p>concat=</p><p>starts the <code>concat</code> filter</p></li><li><p>n=2</p><p>states that there are two input files</p></li><li><p>:</p><p>separator</p></li><li><p>v=1</p><p>sets the number of output video streams. Note that this must be equal to the number of video streams selected from each segment.</p></li><li><p>:</p><p>separator</p></li><li><p>a=1</p><p>sets the number of output audio streams. Note that this must be equal to the number of audio streams selected from each segment.</p></li><li><p>[video_out]</p><p>name of the concatenated output video stream. This is a variable name which you define, so you could call it something different, like “vOut”, “outv”, or “banana”.</p></li><li><p>[audio_out]</p><p>name of the concatenated output audio stream. Again, this is a variable name which you define.</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li><li><p>-map &quot;<!-- -->[video_out]<!-- -->&quot;</p><p>map the concatenated video stream into the output file by referencing the variable defined above</p></li><li><p>-map &quot;<!-- -->[audio_out]<!-- -->&quot;</p><p>map the concatenated audio stream into the output file by referencing the variable defined above</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>If no characteristics of the output files are specified, ffmpeg will use the default encodings associated with the given output file type. To specify the characteristics of the output stream(s), add flags after each <code>-map &quot;[out]&quot;</code> part of the command.</p><p>For example, to ensure that the video stream of the output file is visually lossless H.264 with a 4:2:0 chroma subsampling scheme, the command above could be amended to include the following:
<code>-map &quot;[video_out]&quot; -c:v libx264 -pix_fmt yuv420p -preset veryslow -crf 18</code></p><p>Likewise, to encode the output audio stream as mp3, the command could include the following:
<code>-map &quot;[audio_out]&quot; -c:a libmp3lame -dither_method triangular -qscale:a 2</code></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="variation-concatenating-files-of-different-resolutions">Variation: concatenating files of different resolutions<a class="hash-link" href="#variation-concatenating-files-of-different-resolutions" title="Direct link to heading">​</a></h4><p>To concatenate files of different resolutions, you need to resize the videos to have matching resolutions prior to concatenation. The most basic way to do this is by using a scale filter and giving the dimensions of the file you wish to match:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">-vf scale=1920:1080:flags=lanczos</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>(The Lanczos scaling algorithm is recommended, as it is slower but better than the default bilinear algorithm).</p><p>The rescaling should be applied just before the point where the streams to be used in the output file are listed. Select the stream you want to rescale, apply the filter, and assign that to a variable name (<code>rescaled_video</code> in the below example). Then you use this variable name in the list of streams to be concatenated.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input_1.avi -i input_2.mp4 -filter_complex &quot;[0:v:0] scale=1920:1080:flags=lanczos [rescaled_video], [rescaled_video] [0:a:0] [1:v:0] [1:a:0] concat=n=2:v=1:a=1 [video_out] [audio_out]&quot; -map &quot;[video_out]&quot; -map &quot;[audio_out]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>However, this will only have the desired visual output if the inputs have the same aspect ratio. If you wish to concatenate an SD and an HD file, you will also wish to pillarbox the SD file while upscaling. (See the <a href="https://amiaopensource.github.io/ffmprovisr/#SD_HD_2" target="_blank" rel="noopener noreferrer">Convert 4:3 to pillarboxed HD</a> command). The full command would look like this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input_1.avi -i input_2.mp4 -filter_complex &quot;[0:v:0] scale=1440:1080:flags=lanczos, pad=1920:1080:(ow-iw)/2:(oh-ih)/2 [to_hd_video], [to_hd_video] [0:a:0] [1:v:0] [1:a:0] concat=n=2:v=1:a=1 [video_out] [audio_out]&quot; -map &quot;[video_out]&quot; -map &quot;[audio_out]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Here, the first input is an SD file which needs to be upscaled to match the second input, which is 1920x1080. The scale filter enlarges the SD input to the height of the HD frame, keeping the 4:3 aspect ratio; then, the video is pillarboxed within a 1920x1080 frame.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="variation-concatenating-files-of-different-framerates">Variation: concatenating files of different framerates<a class="hash-link" href="#variation-concatenating-files-of-different-framerates" title="Direct link to heading">​</a></h4><p>If the input files have different framerates, then the output file may be of variable framerate. To explicitly obtain an output file of constant framerate, you may wish convert an input (or multiple inputs) to a different framerate prior to concatenation.</p><p>You can speed up or slow down a file using the <code>fps</code> and <code>atempo</code> filters (see also the <a href="https://amiaopensource.github.io/ffmprovisr/#modify_speed" target="_blank" rel="noopener noreferrer">Modify speed</a> command).</p><p>Here&#x27;s an example of the full command, in which input_1 is 30fps, input_2 is 25fps, and 25fps is the desired output speed.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input_1.avi -i input_2.mp4 -filter_complex &quot;[0:v:0] fps=fps=25 [video_to_25fps]; [0:a:0] atempo=(25/30) [audio_to_25fps]; [video_to_25fps] [audio_to_25fps] [1:v:0] [1:a:0] concat=n=2:v=1:a=1 [video_out] [audio_out]&quot; -map &quot;[video_out]&quot; -map &quot;[audio_out]&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Note that the <code>fps</code> filter will drop or repeat frames as necessary in order to achieve the desired frame rate - see the FFmpeg <a href="https://ffmpeg.org/ffmpeg-filters.html#fps-1" target="_blank" rel="noopener noreferrer">fps docs</a> for more details.</p><p>For more information, see the <a href="https://trac.ffmpeg.org/wiki/Concatenate#differentcodec" target="_blank" rel="noopener noreferrer">FFmpeg wiki page on concatenating files of different types</a>.</p><p>Split one file into several smaller segments</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="split-file-into-segments">Split file into segments<a class="hash-link" href="#split-file-into-segments" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c copy -map 0 -f segment -segment_time 60 -reset_timestamps 1 *output_file-%03d.mkv*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>Starts the command.</p></li><li><p>-i <em>input_file</em></p><p>Takes in a normal file.</p></li><li><p>-c copy</p><p>Use stream copy mode to re-mux instead of re-encode.</p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output.</p></li><li><p>-f segment</p><p>Use <a href="https://ffmpeg.org/ffmpeg-formats.html#toc-segment_002c-stream_005fsegment_002c-ssegment" target="_blank" rel="noopener noreferrer">segment muxer</a> for generating the output.</p></li><li><p>-segment_time 60</p><p>Set duration of each segment (in seconds). This example creates segments with max. duration of 60s each.</p></li><li><p>-reset_timestamps 1</p><p>Reset timestamps of each segment to 0. Meant to ease the playback of the generated segments.</p></li><li><p><em>output_file-%03d.mkv</em></p><p>Path, name and extension of the output file. In order to have an incrementing number in each segment filename, FFmpeg supports <a href="http://www.cplusplus.com/reference/cstdio/printf/" target="_blank" rel="noopener noreferrer">printf-style</a> syntax for a counter.In this example, &#x27;%03d&#x27; means: 3-digits, zero-padded Examples:<code>%03d</code>: 000, 001, 002, ... 999<code>%05d</code>: 00000, 00001, 00002, ... 99999<code>%d</code>: 0, 1, 2, 3, 4, ... 23, 24, etc.</p></li></ul><p>Trim file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="trim-a-video-without-re-encoding">Trim a video without re-encoding<a class="hash-link" href="#trim-a-video-without-re-encoding" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -ss 00:02:00 -to 00:55:00 -c copy -map 0 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command allows you to create an excerpt from a file without re-encoding the audiovisual data.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-ss 00:02:00</p><p>sets in point at 00:02:00</p></li><li><p>-to 00:55:00</p><p>sets out point at 00:55:00</p></li><li><p>-c copy</p><p>use stream copy mode (no re-encoding) </p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output. <strong>Note:</strong> watch out when using <code>-ss</code> with <code>-c copy</code> if the source is encoded with an interframe codec (e.g., H.264). Since FFmpeg must split on i-frames, it will seek to the nearest i-frame to begin the stream copy.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Variation: trim file by setting duration, by using <code>-t</code> instead of <code>-to</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -ss 00:05:00 -t 10 -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>-ss 00:05:00 -t 10</p><p>Beginning five minutes into the original video, this command will create a 10-second-long excerpt.</p></li></ul><p>Note: In order to keep the original timestamps, without trying to sanitize them, you may add the <code>-copyts</code> option.</p><p>Create an excerpt, starting from the beginning of the file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excerpt-from-beginning">Excerpt from beginning<a class="hash-link" href="#excerpt-from-beginning" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -t *5* -c copy -map 0 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command captures a certain portion of a file, starting from the beginning and continuing for the amount of time (in seconds) specified in the script. This can be used to create a preview file, or to remove unwanted content from the end of the file. To be more specific, use timecode, such as 00:00:05.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-t <em>5</em></p><p>tells FFmpeg to stop copying from the input file after a certain time, and specifies the number of seconds after which to stop copying. In this case, 5 seconds is specified.</p></li><li><p>-c copy</p><p>use stream copy mode to re-mux instead of re-encode</p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Create a new file with the first five seconds trimmed off the original</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excerpt-to-end">Excerpt to end<a class="hash-link" href="#excerpt-to-end" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -ss *5* -c copy -map 0 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command copies a file starting from a specified time, removing the first few seconds from the output. This can be used to create an excerpt, or remove unwanted content from the beginning of a file.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-ss <em>5</em></p><p>tells FFmpeg what timecode in the file to look for to start copying, and specifies the number of seconds into the video that FFmpeg should start copying. To be more specific, you can use timecode such as 00:00:05.</p></li><li><p>-c copy</p><p>use stream copy mode to re-mux instead of re-encode</p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Create a new file with the final five seconds of the original</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excerpt-from-end">Excerpt from end<a class="hash-link" href="#excerpt-from-end" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -sseof *-5* -i *input_file* -c copy -map 0 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command copies a file starting from a specified time before the end of the file, removing everything before from the output. This can be used to create an excerpt, or extract content from the end of a file (e.g. for extracting the closing credits).</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-sseof <em>-5</em></p><p>This parameter must stay before the input file. It tells FFmpeg what timecode in the file to look for to start copying, and specifies the number of seconds from the end of the video that FFmpeg should start copying. The end of the file has index 0 and the minus sign is needed to reference earlier portions. To be more specific, you can use timecode such as -00:00:05. Note that in most file formats it is not possible to seek exactly, so FFmpeg will seek to the closest point before.</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c copy</p><p>use stream copy mode to re-mux instead of re-encode</p></li><li><p>-map 0</p><p>tells FFmpeg to map all streams of the input to the output.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Trim silence from beginning of an audio file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="remove-silent-portion-at-the-beginning-of-an-audio-file">Remove silent portion at the beginning of an audio file<a class="hash-link" href="#remove-silent-portion-at-the-beginning-of-an-audio-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af silenceremove=start_threshold=-57dB:start_duration=1:start_periods=1 -c:a *your_codec_choice* -ar *your_sample_rate_choice* *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will automatically remove silence at the beginning of an audio file. The threshold for what qualifies as silence can be changed - this example uses anything under -57 dB, which is a decent level for accounting for analogue hiss.</p><p><strong>Note:</strong> Since this command uses a filter, the audio stream will be re-encoded for the output. If you do not specify a sample rate or codec, this command will use the sample rate from your input and <a href="https://amiaopensource.github.io/ffmprovisr/#codec-defaults" target="_blank" rel="noopener noreferrer">the codec defaults for your output format</a>. Take care that you are getting your intended results!</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file (e.g. input_file.wav)</p></li><li><p>-af silenceremove</p><p>applies the silence remove filter</p></li><li><p>start_threshold=-57dB</p><p>tells the filter the threshold for what to call &#x27;silence&#x27; for the purpose of removal. This can be increased or decreased as necessary.</p></li><li><p>start_duration=1</p><p>This tells the filter how much non-silent audio must be detected before it stops trimming. With a value of <code>0</code> the filter would stop after detecting any non-silent audio. A setting of <code>1</code> allows it to continue trimming through short &#x27;pops&#x27; such as those caused by engaging the playback device, or the recorded sound of a microphone being plugged in.</p></li><li><p>start_periods=1</p><p>This tells the filter to trim the first example of silence it discovers from the beginning of the file. This value could be increased to remove subsequent silent portions from the file if desired.</p></li><li><p>-c:a <em>your_codec_choice</em></p><p>This tells the filter what codec to use, and must be specified to avoid defaults. If you want 24 bit PCM, your value would be <code>-c:a pcm_s24le</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file (e.g. output_file.wav).</p></li></ul><p>Trim silence from the end of an audio file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="remove-silent-portion-from-the-end-of-an-audio-file">Remove silent portion from the end of an audio file<a class="hash-link" href="#remove-silent-portion-from-the-end-of-an-audio-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af areverse,silenceremove=start_threshold=-57dB:start_duration=1:start_periods=1,areverse -c:a *your_codec_choice* -ar *your_sample_rate_choice* *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will automatically remove silence at the end of an audio file. Since the <code>silenceremove</code> filter is best at removing silence from the beginning of files, this command used the <code>areverse</code> filter twice to reverse the input, remove silence and then restore correct orientation.</p><p><strong>Note:</strong> Since this command uses a filter, the audio stream will be re-encoded for the output. If you do not specify a sample rate or codec, this command will use the sample rate from your input and <a href="https://amiaopensource.github.io/ffmprovisr/#codec-defaults" target="_blank" rel="noopener noreferrer">the codec defaults for your output format</a>. Take care that you are getting your intended results!</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file (e.g. input_file.wav)</p></li><li><p>-af areverse,</p><p>starts the filter chain with reversing the input</p></li><li><p>silenceremove</p><p>applies the silence remove filter</p></li><li><p>start_threshold=-57dB</p><p>tells the filter the threshold for what to call &#x27;silence&#x27; for the purpose of removal. This can be increased or decreased as necessary.</p></li><li><p>start_duration=1</p><p>This tells the filter how much non-silent audio must be detected before it stops trimming. With a value of <code>0</code> the filter would stop after detecting any non-silent audio. A setting of <code>1</code> allows it to continue trimming through short &#x27;pops&#x27; such as those caused by engaging the playback device, or the recorded sound of a microphone being plugged in.</p></li><li><p>start_periods=1</p><p>This tells the filter to trim the first example of silence it discovers.</p></li><li><p>areverse</p><p>applies the audio reverse filter again to restore input to correct orientation.</p></li><li><p>-c:a <em>your_codec_choice</em></p><p>This tells the filter what codec to use, and must be specified to avoid defaults. If you want 24 bit PCM, your value would be <code>-c:a pcm_s24le</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file (e.g. output_file.wav).</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="work-with-interlaced-video">Work with interlaced video<a class="hash-link" href="#work-with-interlaced-video" title="Direct link to heading">​</a></h2><p>Upscaled, pillar-boxed HD H.264 access files from SD NTSC source</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="upscaled-pillar-boxed-hd-h264-access-files-from-sd-ntsc-source">Upscaled, Pillar-boxed HD H.264 Access Files from SD NTSC source<a class="hash-link" href="#upscaled-pillar-boxed-hd-h264-access-files-from-sd-ntsc-source" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -filter:v &quot;yadif, scale=1440:1080:flags=lanczos, pad=1920:1080:(ow-iw)/2:(oh-ih)/2, format=yuv420p&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>encodes video stream with libx264 (h264)</p></li><li><p>-filter:v</p><p>a video filter will be used</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>yadif</p><p>deinterlacing filter (‘yet another deinterlacing filter’) By default, <a href="https://ffmpeg.org/ffmpeg-filters.html#yadif-1" target="_blank" rel="noopener noreferrer">yadif</a> will output one frame for each frame. Outputting one frame for each <em>field</em> (thereby doubling the frame rate) with <code>yadif=1</code> may produce visually better results.</p></li><li><p>scale=1440:1080:flags=lanczos</p><p>resizes the image to 1440x1080, using the Lanczos scaling algorithm, which is slower but better than the default bilinear algorithm.</p></li><li><p>pad=1920:1080:(ow-iw)/2:(oh-ih)/2</p><p>pads the area around the 4:3 input video to create a 16:9 output video</p></li><li><p>format=yuv420p</p><p>specifies a pixel format of Y′CBCR 4:2:0</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p><strong>Note:</strong> the very same scaling filter also downscales a bigger image size into HD.</p><p>Deinterlace video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="deinterlace-a-video">Deinterlace a video<a class="hash-link" href="#deinterlace-a-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf &quot;yadif,format=yuv420p&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an interlaced input file and outputs a deinterlaced H.264 MP4.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>tells FFmpeg to encode the video stream as H.264</p></li><li><p>-vf</p><p>video filtering will be used (<code>-vf</code> is an alias of <code>-filter:v</code>)</p></li><li><p>&quot;</p><p>start of filtergraph (see below)</p></li><li><p>yadif</p><p>deinterlacing filter (‘yet another deinterlacing filter’) By default, <a href="https://ffmpeg.org/ffmpeg-filters.html#yadif-1" target="_blank" rel="noopener noreferrer">yadif</a> will output one frame for each frame. Outputting one frame for each <em>field</em> (thereby doubling the frame rate) with <code>yadif=1</code> may produce visually better results.</p></li><li><p>,</p><p>separates filters</p></li><li><p>format=yuv420p</p><p>chroma subsampling set to 4:2:0 By default, <code>libx264</code> will use a chroma subsampling scheme that is the closest match to that of the input. This can result in Y′CBCR 4:2:0, 4:2:2, or 4:4:4 chroma subsampling. QuickTime and most other non-FFmpeg based players can’t decode H.264 files that are not 4:2:0, therefore it’s advisable to specify 4:2:0 chroma subsampling.</p></li><li><p>&quot;</p><p>end of filtergraph</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p><code>&quot;yadif,format=yuv420p&quot;</code> is an FFmpeg <a href="https://trac.ffmpeg.org/wiki/FilteringGuide#FiltergraphChainFilterrelationship" target="_blank" rel="noopener noreferrer">filtergraph</a>. Here the filtergraph is made up of one filter chain, which is itself made up of the two filters (separated by the comma).
The enclosing quote marks are necessary when you use spaces within the filtergraph, e.g. <code>-vf &quot;yadif, format=yuv420p&quot;</code>, and are included above as an example of good practice.</p><p><strong>Note:</strong> FFmpeg includes several deinterlacers apart from <a href="https://ffmpeg.org/ffmpeg-filters.html#yadif-1" target="_blank" rel="noopener noreferrer">yadif</a>: <a href="https://ffmpeg.org/ffmpeg-filters.html#bwdif" target="_blank" rel="noopener noreferrer">bwdif</a>, <a href="https://ffmpeg.org/ffmpeg-filters.html#w3fdif" target="_blank" rel="noopener noreferrer">w3fdif</a>, <a href="https://ffmpeg.org/ffmpeg-filters.html#kerndeint" target="_blank" rel="noopener noreferrer">kerndeint</a>, and <a href="https://ffmpeg.org/ffmpeg-filters.html#nnedi" target="_blank" rel="noopener noreferrer">nnedi</a>.</p><p>For more H.264 encoding options, see the latter section of the <a href="https://amiaopensource.github.io/ffmprovisr/#transcode_h264" target="_blank" rel="noopener noreferrer">encode H.264 command</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h2><p>Before and after deinterlacing:</p><p><img alt="VLC screenshot of original interlaced video" src="/assets/images/interlaced_video-1d241fc6a2c93cda91361b9ef2cf3f99.png" width="432" height="346"><img alt="VLC screenshot of deinterlaced video" src="/assets/images/deinterlaced_video-d02340c7e792f85d6791cb629956b33c.png" width="432" height="347"></p><p>Deinterlace video fields to frames</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="deinterlace-video-fields-to-frames">Deinterlace video fields to frames<a class="hash-link" href="#deinterlace-video-fields-to-frames" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf &quot;idet,bwdif,format=yuv420p&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes an interlaced input file and outputs a deinterlaced H.264 MP4, with each field separated into its own frame. This is preferred for interlaced video that contains a lot of motion, as the double-rate output preserves the visual cadence of the source material.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>tells FFmpeg to encode the video stream as H.264</p></li><li><p>-vf</p><p>video filtering will be used (<code>-vf</code> is an alias of <code>-filter:v</code>)</p></li><li><p>&quot;</p><p>start of filtergraph (see below)</p></li><li><p>idet</p><p>detect interlaced video field order <a href="https://ffmpeg.org/ffmpeg-filters.html#idet" target="_blank" rel="noopener noreferrer">idet</a> will try to detect if the video is interlaced, and if so, what the order of the fields are (top-field-first, or bottom-field-first). This is done to ensure the output of the deinterlacing filter is correct.</p></li><li><p>bwdif</p><p>deinterlacing filter (‘Bob Weaver Deinterlacing Filter’) By default, <a href="https://ffmpeg.org/ffmpeg-filters.html#bwdif-1" target="_blank" rel="noopener noreferrer">bwdif</a> will output one frame for each field, matching the visual cadence of interlaced video.</p></li><li><p>,</p><p>separates filters</p></li><li><p>format=yuv420p</p><p>chroma subsampling set to 4:2:0 By default, <code>libx264</code> will use a chroma subsampling scheme that is the closest match to that of the input. This can result in Y′CBCR 4:2:0, 4:2:2, or 4:4:4 chroma subsampling. QuickTime and most other non-FFmpeg based players can’t decode H.264 files that are not 4:2:0, therefore it’s advisable to specify 4:2:0 chroma subsampling.</p></li><li><p>&quot;</p><p>end of filtergraph</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p><code>&quot;idet,bwdif,format=yuv420p&quot;</code> is an FFmpeg <a href="https://trac.ffmpeg.org/wiki/FilteringGuide#FiltergraphChainFilterrelationship" target="_blank" rel="noopener noreferrer">filtergraph</a>. Here the filtergraph is made up of one filter chain, which is itself made up of the three filters (separated by the comma).
The enclosing quote marks are necessary when you use spaces within the filtergraph, e.g. <code>-vf &quot;idet, bwdif, format=yuv420p&quot;</code>, and are included above as an example of good practice.</p><p><strong>Note:</strong> bwdif also supports the older method of outputting one frame for each frame (thereby halving the number of output frames per second) with the syntax <code>bwdif=mode=send_frame</code>. This can be used when the presentation device is not capable of reproducing 50 (PAL) or 60 (NTSC) frames per second.</p><p>For more H.264 encoding options, see the latter section of the <a href="https://amiaopensource.github.io/ffmprovisr/#transcode_h264" target="_blank" rel="noopener noreferrer">encode H.264 command</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-1">Example<a class="hash-link" href="#example-1" title="Direct link to heading">​</a></h2><p>Before and after deinterlacing with bwdif:</p><p><img alt="VLC screenshot of original interlaced video" src="/assets/images/interlaced_video_fields-fb3002eb4bdd6d62e4f371ebd9e98c9e.png" width="720" height="480"><img alt="VLC screenshot of deinterlaced video" src="/assets/images/deinterlaced_video_frames-3c21c87f6f2626f8bd9e93d4c2443e45.png" width="720" height="480"></p><p>Inverse telecine</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="inverse-telecine-a-video-file">Inverse telecine a video file<a class="hash-link" href="#inverse-telecine-a-video-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v libx264 -vf &quot;fieldmatch,yadif,decimate&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The inverse telecine procedure reverses the <a href="https://en.wikipedia.org/wiki/Three-two_pull_down" target="_blank" rel="noopener noreferrer">3:2 pull down</a> process, restoring 29.97fps interlaced video to the 24fps frame rate of the original film source.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input file</em></p><p>path, name and extension of the input file</p></li><li><p>-c:v libx264</p><p>encode video as H.264</p></li><li><p>-vf &quot;fieldmatch,yadif,decimate&quot;</p><p>applies these three video filters to the input video. <a href="https://ffmpeg.org/ffmpeg-filters.html#fieldmatch" target="_blank" rel="noopener noreferrer">Fieldmatch</a> is a field matching filter for inverse telecine - it reconstructs the progressive frames from a telecined stream. <a href="https://ffmpeg.org/ffmpeg-filters.html#yadif-1" target="_blank" rel="noopener noreferrer">Yadif</a> (‘yet another deinterlacing filter’) deinterlaces the video. (Note that FFmpeg also includes several other deinterlacers). <a href="https://ffmpeg.org/ffmpeg-filters.html#decimate-1" target="_blank" rel="noopener noreferrer">Decimate</a> deletes duplicated frames.</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p><code>&quot;fieldmatch,yadif,decimate&quot;</code> is an FFmpeg <a href="https://trac.ffmpeg.org/wiki/FilteringGuide#FiltergraphChainFilterrelationship" target="_blank" rel="noopener noreferrer">filtergraph</a>. Here the filtergraph is made up of one filter chain, which is itself made up of the three filters (separated by commas).
The enclosing quote marks are necessary when you use spaces within the filtergraph, e.g. <code>-vf &quot;fieldmatch, yadif, decimate&quot;</code>, and are included above as an example of good practice.</p><p>Note that if applying an inverse telecine procedure to a 29.97i file, the output framerate will actually be 23.976fps.</p><p>This command can also be used to restore other framerates.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-2">Example<a class="hash-link" href="#example-2" title="Direct link to heading">​</a></h2><p>Before and after inverse telecine:</p><p><img alt="GIF of original video" src="/assets/images/ivtc_originalvideo-5201cb28e2335cd58e943b86a5d96a33.gif" width="500" height="333"><img alt="GIF of video after inverse telecine" src="/assets/images/ivtc_result-d649ceb4f6a374563f70d5d4b5d65bfd.gif" width="500" height="333"></p><p>Set field order for interlaced video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="change-field-order-of-an-interlaced-video">Change field order of an interlaced video<a class="hash-link" href="#change-field-order-of-an-interlaced-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -c:v *video_codec* -filter:v setfield=tff *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v setfield=tff</p><p>Sets the field order to top field first. Use <code>setfield=bff</code> for bottom field first.</p></li><li><p>-c:v <em>video_codec</em></p><p>As a video filter is used, it is not possible to use <code>-c copy</code>. The video must be re-encoded with whatever video codec is chosen, e.g. <code>ffv1</code>, <code>v210</code> or <code>prores</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Identify interlacement patterns in a video file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="check-video-file-interlacement-patterns">Check video file interlacement patterns<a class="hash-link" href="#check-video-file-interlacement-patterns" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input file* -filter:v idet -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v idet</p><p>This calls the <a href="https://ffmpeg.org/ffmpeg-filters.html#idet" target="_blank" rel="noopener noreferrer">idet (detect video interlacing type) filter</a>.</p></li><li><p>-f null</p><p>Video is decoded with the <code>null</code> muxer. This allows video decoding without creating an output file.</p></li><li><ul><li></li></ul><p>FFmpeg syntax requires a specified output, and <code>-</code> is just a place holder. No file is actually created.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="overlay-timecode-or-text">Overlay timecode or text<a class="hash-link" href="#overlay-timecode-or-text" title="Direct link to heading">​</a></h2><p>Create opaque centered text watermark</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-centered-transparent-text-watermark">Create centered, transparent text watermark<a class="hash-link" href="#create-centered-transparent-text-watermark" title="Direct link to heading">​</a></h5><p>E.g For creating access copies with your institutions name</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -vf drawtext=&quot;fontfile=*font_path*:fontsize=*font_size*:text=*watermark_text*:fontcolor=*font_color*:alpha=0.4:x=(w-text_w)/2:y=(h-text_h)/2&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-vf drawtext=</p><p>This calls the drawtext filter with the following options:fontfile=<em>font_path</em>Set path to font. For example in macOS: <code>fontfile=/Library/Fonts/AppleGothic.ttf</code>fontsize=<em>font_size</em>Set font size. <code>35</code> is a good starting point for SD. Ideally this value is proportional to video size, for example use ffprobe to acquire video height and divide by 14.text=<em>watermark_text</em>Set the content of your watermark text. For example: <code>text=&#x27;FFMPROVISR EXAMPLE TEXT&#x27;</code>fontcolor=<em>font_color</em>Set color of font. Can be a text string such as <code>fontcolor=white</code> or a hexadecimal value such as <code>fontcolor=0xFFFFFF</code>alpha=0.4Set transparency value.x=(w-text_w)/2:y=(h-text_h)/2Sets <em>x</em> and <em>y</em> coordinates for the watermark. These relative values will centre your watermark regardless of video dimensions.Note: <code>-vf</code> is a shortcut for <code>-filter:v</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file.</p></li></ul><p>Overlay image watermark on video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="overlay-image-watermark-on-video">Overlay image watermark on video<a class="hash-link" href="#overlay-image-watermark-on-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_video file* -i *input_image_file* -filter_complex overlay=main_w-overlay_w-5:5 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_video_file</em></p><p>path, name and extension of the input video file</p></li><li><p>-i <em>input_image_file</em></p><p>path, name and extension of the image file</p></li><li><p>-filter_complex overlay=main_w-overlay_w-5:5</p><p>This calls the overlay filter and sets x and y coordinates for the position of the watermark on the video. Instead of hardcoding specific x and y coordinates, <code>main_w-overlay_w-5:5</code> uses relative coordinates to place the watermark in the upper right hand corner, based on the width of your input files. Please see the <a href="https://ffmpeg.org/ffmpeg-all.html#toc-Examples-102" target="_blank" rel="noopener noreferrer">FFmpeg documentation for more examples.</a></p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Burn in timecode</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-a-burnt-in-timecode-on-your-image">Create a burnt in timecode on your image<a class="hash-link" href="#create-a-burnt-in-timecode-on-your-image" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -vf drawtext=&quot;fontfile=*font_path*:fontsize=*font_size*:timecode=*starting_timecode*:fontcolor=*font_colour*:box=1:boxcolor=*box_colour*:rate=*timecode_rate*:x=(w-text_w)/2:y=h/1.2&quot; *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-vf drawtext=</p><p>This calls the drawtext filter with the following options:</p></li><li><p>&quot;</p><p>quotation mark to start drawtext filter command</p></li><li><p>fontfile=<em>font_path</em></p><p>Set path to font. For example in macOS: <code>fontfile=/Library/Fonts/AppleGothic.ttf</code></p></li><li><p>fontsize=<em>font_size</em></p><p>Set font size. <code>35</code> is a good starting point for SD. Ideally this value is proportional to video size, for example use ffprobe to acquire video height and divide by 14.</p></li><li><p>timecode=<em>starting_timecode</em></p><p>Set the timecode to be displayed for the first frame. Timecode is to be represented as <code>hh:mm:ss[:;.]ff</code>. Colon escaping is determined by O.S, for example in Ubuntu <code>timecode=&#x27;09\\:50\\:01\\:23&#x27;</code>. Ideally, this value would be generated from the file itself using ffprobe.</p></li><li><p>fontcolor=<em>font_color</em></p><p>Set color of font. Can be a text string such as <code>fontcolor=white</code> or a hexadecimal value such as <code>fontcolor=0xFFFFFF</code></p></li><li><p>box=1</p><p>Enable box around timecode</p></li><li><p>boxcolor=<em>box_color</em></p><p>Set color of box. Can be a text string such as <code>fontcolor=black</code> or a hexadecimal value such as <code>fontcolor=0x000000</code></p></li><li><p>rate=<em>timecode_rate</em></p><p>Framerate of video. For example <code>25/1</code></p></li><li><p>x=(w-text_w)/2:y=h/1.2</p><p>Sets <em>x</em> and <em>y</em> coordinates for the timecode. These relative values will horizontally centre your timecode in the bottom third regardless of video dimensions.</p></li><li><p>&quot;</p><p>quotation mark to end drawtext filter command</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file.</p></li></ul><p>Note: <code>-vf</code> is a shortcut for <code>-filter:v</code>.</p><p>Embed subtitles</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="embed-a-subtitle-file-into-a-movie-file">Embed a subtitle file into a movie file<a class="hash-link" href="#embed-a-subtitle-file-into-a-movie-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -i *subtitles_file* -c copy -c:s mov_text *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-i <em>subtitles_file</em></p><p>path to subtitles file, e.g. <code>subtitles.srt</code></p></li><li><p>-c copy</p><p>enable stream copy (no re-encode)</p></li><li><p>-c:s mov_text</p><p>Encode subtitles using the <code>mov_text</code> codec. Note: The <code>mov_text</code> codec works for MP4 and MOV containers. For the MKV container, acceptable formats are <code>ASS</code>, <code>SRT</code>, and <code>SSA</code>.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Note: <code>-c:s</code> is a shortcut for <code>-scodec</code></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-thumbnails-or-gifs">Create thumbnails or GIFs<a class="hash-link" href="#create-thumbnails-or-gifs" title="Direct link to heading">​</a></h2><p>Export one thumbnail per video file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="one-thumbnail">One thumbnail<a class="hash-link" href="#one-thumbnail" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -ss 00:00:20 -vframes 1 thumb.png</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will grab a thumbnail 20 seconds into the video.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-ss <em>00:00:20</em></p><p>seeks video file to 20 seconds into the video</p></li><li><p>-vframes <em>1</em></p><p>sets the number of frames (in this example, one frame)</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file</p></li></ul><p>Export many thumbnails per video file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="many-thumbnails">Many thumbnails<a class="hash-link" href="#many-thumbnails" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -vf fps=1/60 out%d.png</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will grab a thumbnail every minute and output sequential png files.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-ss <em>00:00:20</em></p><p>seeks video file to 20 seconds into the video</p></li><li><p>-vf fps=1/60</p><p>Creates a filtergraph to use for the streams. The rest of the command identifies filtering by frames per second, and sets the frames per second at 1/60 (which is one per minute). Omitting this will output all frames from the video.</p></li><li><p><em>output file</em></p><p>path, name and extension of the output file. In the example out%d.png where %d is a regular expression that adds a number (d is for digit) and increments with each frame (out1.png, out2.png, out3.png…). You may also chose a regular expression like out%04d.png which gives 4 digits with leading 0 (out0001.png, out0002.png, out0003.png, …).</p></li></ul><p>Create GIF from still images</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="images-to-gif">Images to GIF<a class="hash-link" href="#images-to-gif" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f image2 -framerate 9 -pattern_type glob -i *&quot;input_image_\*.jpg&quot;* -vf scale=250x250 *output_file*.gif</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will convert a series of image files into a GIF.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f image2</p><p>forces input or output file format. <code>image2</code> specifies the image file demuxer.</p></li><li><p>-framerate 9</p><p>sets framerate to 9 frames per second</p></li><li><p>-pattern_type glob</p><p>tells FFmpeg that the following mapping should &quot;interpret like a <a href="https://en.wikipedia.org/wiki/Glob_(programming)" target="_blank" rel="noopener noreferrer">glob</a>&quot; (a &quot;global command&quot; function that relies on the * as a wildcard and finds everything that matches)</p></li><li><p>-i <em>&quot;input<em>image</em>*<!-- -->.jpg&quot;</em></p><p>maps all files in the directory that start with input<em>image</em>, for example input_image_001.jpg, input_image_002.jpg, input_image_003.jpg... etc. (The quotation marks are necessary for the above “glob” pattern!)</p></li><li><p>-vf scale=250x250</p><p>filter the video to scale it to 250x250; <code>-vf</code> is an alias for <code>-filter:v</code></p></li><li><p><em>output_file.gif</em></p><p>path and name of the output file</p></li></ul><p>Create GIF from a video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-gif">Create GIF<a class="hash-link" href="#create-gif" title="Direct link to heading">​</a></h5><p>Create high quality GIF</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -ss HH:MM:SS -i *input_file* -filter_complex &quot;fps=10,scale=500:-1:flags=lanczos,palettegen&quot; -t 3 *palette.png*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -ss HH:MM:SS -i *input_file* -i palette.png -filter_complex &quot;[0:v]fps=10, scale=500:-1:flags=lanczos[v], [v][1:v]paletteuse&quot; -t 3 -loop 6 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The first command will use the palettegen filter to create a custom palette, then the second command will create the GIF with the paletteuse filter. The result is a high quality GIF.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-ss <em>HH:MM:SS</em></p><p>starting point of the GIF. If a plain numerical value is used it will be interpreted as seconds</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter_complex &quot;fps=<em>framerate</em>, scale=<em>width</em>:<em>height</em>, palettegen&quot;</p><p>a complex filtergraph. Firstly, the fps filter sets the frame rate. Then the scale filter resizes the image. You can specify both the width and the height, or specify a value for one and use a scale value of <em>-1</em> for the other to preserve the aspect ratio. (For example, <code>500:-1</code> would create a GIF 500 pixels wide and with a height proportional to the original video). In the first script above, <code>:flags=lanczos</code> specifies that the Lanczos rescaling algorithm will be used to resize the image. Lastly, the palettegen filter generates the palette.</p></li><li><p>-t <em>3</em></p><p>duration in seconds (here 3; can be specified also with a full timestamp, i.e. here 00:00:03)</p></li><li><p>-loop <em>6</em></p><p>sets the number of times to loop the GIF. A value of <em>-1</em> will disable looping. Omitting <em>-loop</em> will use the default, which will loop infinitely.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>The second command has a slightly different filtergraph, which breaks down as follows:</p><ul><li><p>-filter_complex &quot;<!-- -->[0:v]<!-- -->fps=10, scale=500👎flags=lanczos<!-- -->[v]<!-- -->, <!-- -->[v][1:v]<!-- -->paletteuse&quot;</p><p><code>[0:v]fps=10,scale=500:-1:flags=lanczos[v]</code>: applies the fps and scale filters described above to the first input file (the video). <code>[v][1:v]paletteuse&quot;</code>: applies the <code>paletteuse</code> filter, setting the second input file (the palette) as the reference file.</p></li></ul><p>Simpler GIF creation</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -ss HH:MM:SS -i *input_file* -vf &quot;fps=10,scale=500:-1&quot; -t 3 -loop 6 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This is a quick and easy method. Dithering is more apparent than the above method using the palette filters, but the file size will be smaller. Perfect for that “legacy” GIF look.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-a-video-from-images">Create a video from images<a class="hash-link" href="#create-a-video-from-images" title="Direct link to heading">​</a></h2><p>Transcode an image sequence into uncompressed 10-bit video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="transcode-an-image-sequence-into-uncompressed-10-bit-video">Transcode an image sequence into uncompressed 10-bit video<a class="hash-link" href="#transcode-an-image-sequence-into-uncompressed-10-bit-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f image2 -framerate 24 -i *input_file_%06d.ext* -c:v v210 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f image2</p><p>forces the image file de-muxer for single image files</p></li><li><p>-framerate 24</p><p>Sets the input framerate to 24 fps. The image2 demuxer defaults to 25 fps.</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file This must match the naming convention actually used! The regex %06d matches six digits long numbers, possibly with leading zeroes. This allows to read in ascending order, one image after the other, the full sequence inside one folder. For image sequences starting with 086400 (i.e. captured with a timecode starting at 01:00:00:00 and at 24 fps), add the flag <code>-start_number 086400</code> before <code>-i input_file_%06d.ext</code>. The extension for TIFF files is .tif or maybe .tiff; the extension for DPX files is .dpx (or eventually .cin for old files).</p></li><li><p>-c:v v210</p><p>encodes an uncompressed 10-bit video stream</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Create video from image and audio</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-a-video-from-an-image-and-audio-file">Create a video from an image and audio file.<a class="hash-link" href="#create-a-video-from-an-image-and-audio-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -r 1 -loop 1 -i *image_file* -i *audio_file* -acodec copy -shortest -vf scale=1280:720 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will take an image file (e.g. image.jpg) and an audio file (e.g. audio.mp3) and combine them into a video file that contains the audio track with the image used as the video. It can be useful in a situation where you might want to upload an audio file to a platform like YouTube. You may want to adjust the scaling with -vf to suit your needs.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-r <em>1</em></p><p>set the framerate</p></li><li><p>-loop <em>1</em></p><p>loop the first input stream</p></li><li><p>-i <em>image_file</em></p><p>path, name and extension of the image file</p></li><li><p>-i <em>audio_file</em></p><p>path, name and extension of the audio file</p></li><li><p>-acodec copy</p><p>copy the audio. -acodec is an alias for -c:a</p></li><li><p>-shortest</p><p>finish encoding when the shortest input stream ends</p></li><li><p>-vf scale=1280:720</p><p>filter the video to scale it to 1280x720 for YouTube. -vf is an alias for -filter:v</p></li><li><p><em>output_file</em></p><p>path, name and extension of the video output file</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="use-filters-or-scopes">Use filters or scopes<a class="hash-link" href="#use-filters-or-scopes" title="Direct link to heading">​</a></h2><p>Audio Bitscope</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="creates-a-visualization-of-the-bits-in-an-audio-stream">Creates a visualization of the bits in an audio stream<a class="hash-link" href="#creates-a-visualization-of-the-bits-in-an-audio-stream" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi &quot;amovie=*input_file*, asplit=2[out1][a], [a]abitscope=colors=purple|yellow[out0]&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This filter allows visual analysis of the information held in various bit depths of an audio stream. This can aid with identifying when a file that is nominally of a higher bit depth actually has been &#x27;padded&#x27; with null information. The provided GIF shows a 16 bit WAV file (left) and then the results of converting that same WAV to 32 bit (right). Note that in the 32 bit version, there is still only information in the first 16 bits.</p><ul><li><p>ffplay -f lavfi</p><p>starts the command and tells ffplay that you will be using the lavfi virtual device to create the input</p></li><li><p>&quot;</p><p>quotation mark to start the lavfi filtergraph</p></li><li><p>amovie=<em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>asplit=2<!-- -->[out1][a]</p><p>splits the audio stream in two. One of these <!-- -->[a]<!-- --> will be passed to the filter, and the other <!-- -->[out1]<!-- --> will be the audible stream.</p></li><li><p>[a]<!-- -->abitscope=colors=purple|yellow<!-- -->[out0]</p><p>sends stream <!-- -->[a]<!-- --> into the abitscope filter, sets the colors for the channels to purple and yellow, and outputs the results to <!-- -->[out0]<!-- -->. This is what will be the visualization.</p></li><li><p>&quot;</p><p>quotation mark to end the lavfi filtergraph</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="comparison-of-mono-16-bit-and-mono-16-bit-padded-to-32-bit">Comparison of mono 16 bit and mono 16 bit padded to 32 bit.<a class="hash-link" href="#comparison-of-mono-16-bit-and-mono-16-bit-padded-to-32-bit" title="Direct link to heading">​</a></h2><p><img alt="bit_scope_comparison" src="/assets/images/16_32_abitscope-f0effb28896b5aafc8fe60f651ee67a3.gif" width="720" height="240"></p><p>Play a graphical output showing decibel levels of an input file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="plays-a-graphical-output-showing-decibel-levels-of-an-input-file">Plays a graphical output showing decibel levels of an input file<a class="hash-link" href="#plays-a-graphical-output-showing-decibel-levels-of-an-input-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi &quot;amovie=&#x27;input.mp3&#x27;, astats=metadata=1:reset=1, adrawgraph=lavfi.astats.Overall.Peak_level:max=0:min=-30.0:size=700x256:bg=Black[out]&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter input virtual device</a></p></li><li><p>&quot;</p><p>quotation mark to start the lavfi filtergraph</p></li><li><p>movie=&#x27;<em>input.mp3</em>&#x27;</p><p>declares audio source file on which to apply filter</p></li><li><p>,</p><p>comma signifies the end of audio source section and the beginning of the filter section</p></li><li><p>astats=metadata=1</p><p>tells the astats filter to ouput metadata that can be passed to another filter (in this case adrawgraph)</p></li><li><p>:</p><p>divides between options of the same filter</p></li><li><p>reset=1</p><p>tells the filter to calculate the stats on every frame (increasing this number would calculate stats for groups of frames)</p></li><li><p>,</p><p>comma divides one filter in the chain from another</p></li><li><p>adrawgraph=lavfi.astats.Overall.Peak_level:max=0:min=-30.0</p><p>draws a graph using the overall peak volume calculated by the astats filter. It sets the max for the graph to 0 (dB) and the minimum to -30 (dB). For more options on data points that can be graphed see the <a href="https://ffmpeg.org/ffmpeg-filters.html#astats-1" target="_blank" rel="noopener noreferrer">FFmpeg astats documentation</a></p></li><li><p>size=700x256:bg=Black</p><p>sets the background color and size of the output</p></li><li><p>[out]</p><p>ends the filterchain and sets the output</p></li><li><p>&quot;</p><p>quotation mark to end the lavfi filtergraph</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-of-filter-output">Example of filter output<a class="hash-link" href="#example-of-filter-output" title="Direct link to heading">​</a></h2><p><img alt="astats example" src="data:image/gif;base64,R0lGODlhvAIAAfcfMQAAACQAAEgAAGwAAJAAALQAANgAAPwAAAAkACQkAEgkAGwkAJAkALQkANgkAPwkAABIACRIAEhIAGxIAJBIALRIANhIAPxIAABsACRsAEhsAGxsAJBsALRsANhsAPxsAACQACSQAEiQAGyQAJCQALSQANiQAPyQAAC0ACS0AEi0AGy0AJC0ALS0ANi0APy0AADYACTYAEjYAGzYAJDYALTYANjYAPzYAAD8ACT8AEj8AGz8AJD8ALT8ANj8APz8AAAAVSQAVUgAVWwAVZAAVbQAVdgAVfwAVQAkVSQkVUgkVWwkVZAkVbQkVdgkVfwkVQBIVSRIVUhIVWxIVZBIVbRIVdhIVfxIVQBsVSRsVUhsVWxsVZBsVbRsVdhsVfxsVQCQVSSQVUiQVWyQVZCQVbSQVdiQVfyQVQC0VSS0VUi0VWy0VZC0VbS0Vdi0Vfy0VQDYVSTYVUjYVWzYVZDYVbTYVdjYVfzYVQD8VST8VUj8VWz8VZD8VbT8Vdj8Vfz8VQAAqiQAqkgAqmwAqpAAqrQAqtgAqvwAqgAkqiQkqkgkqmwkqpAkqrQkqtgkqvwkqgBIqiRIqkhIqmxIqpBIqrRIqthIqvxIqgBsqiRsqkhsqmxsqpBsqrRsqthsqvxsqgCQqiSQqkiQqmyQqpCQqrSQqtiQqvyQqgC0qiS0qki0qmy0qpC0qrS0qti0qvy0qgDYqiTYqkjYqmzYqpDYqrTYqtjYqvzYqgD8qiT8qkj8qmz8qpD8qrT8qtj8qvz8qgAA/yQA/0gA/2wA/5AA/7QA/9gA//wA/wAk/yQk/0gk/2wk/5Ak/7Qk/9gk//wk/wBI/yRI/0hI/2xI/5BI/7RI/9hI//xI/wBs/yRs/0hs/2xs/5Bs/7Rs/9hs//xs/wCQ/ySQ/0iQ/2yQ/5CQ/7SQ/9iQ//yQ/wC0/yS0/0i0/2y0/5C0/7S0/9i0//y0/wDY/yTY/0jY/2zY/5DY/7TY/9jY//zY/wD8/yT8/0j8/2z8/5D8/7T8/9j8//z8/yH/C05FVFNDQVBFMi4wAwEAAAAh+QQECgAfACwAAAAAvAIAAQAI/wABCBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KtKjRo0iTKl3KtKnTp1CjSp1KtarVq1izat3KtavXr2DDih1LtqzZs2jTql3Ltq3bt3Djyp1Lt67du3jz6t3Lt6/fv4ADCx5MuLDhw4gTK17MuLHjx5AjS55MubLly5gza97MubPnz6BDix5NurTp06hTq17NurXr17Bjy55Nu7bt27hz697Nu7fv38CDCx9OvLjx48iTK1/OvLnz59CjS59Ovbr169iza9/Ovbv37+DDi/8fT768+fPo06tfz769+/fw48ufT7++/fv48+vfz7+///8ABijggAQWaOCBCCao4IIMNujggxBGKOGEFFZo4YUYZqjhhhx26OGHIIYo4ogklmjiiSimqOKKLLbo4oswxijjjDTWaOONOOao44489ujjj0AGKeSQRBZp5JFIJqnkkkw26eSTUEYp5ZRUVmnllVhmqeWWXHbp5ZdghinmmGSWaeaZaKap5ppstunmm3DGKeecdNZp55145qnnnnz26eefgAYq6KCEFmrooYgmquiijDbq6KOQRirppJRWaumlmGaq6aacdurpp6CGKuqopJZq6qmopqrqqqy26uqrsMbdKuustNZq66245qrrrrz26uuvwAYr7LDEFmvsscgmq+yyzDbr7LPQRivttNRWa+212Gar7bbcduvtt+CGK+645JZr7rnopqvuuuy26+678MYr77z01mvvvfjmq+++/Pbr778AByzwwAQXbPDBCCes8MIMN+zwwxBHLPHEFFds8cUYZ6zxxhx37PHHIIcs8sgkl2zyySinrPLKLLfs8sswxyzzzDTXbPPNOOes88489+zzz0AHLfTQRBdt9NFIJ6300kw37fTTUEct9dRUSw3M1VhnrfXWXHfNddU8BQQAIfkEBQoAAAAsKwD/AAEAAQAACAQAgQUEACH5BAUKAAAALCwA/wAEAAEAAAgGAIEJBBYQACH5BAUKAAEALDAAtgAEAEoAAAhFAAMAAxZAIEGDBQcSXCiwIcOFAxFKjDjxIEWKDRMWzMjxYMeNHkOCHKmx5EeTIlGSPMkyZcuVLmPCnKmy5kubMnHSDBAQACH5BAUKAAEALDQAxAAEADwAAAgzAIEFGCiQ4MAABREeTMhwoUODEBVGbDjxocSLFDFazMhxo8eKIDF2DDlSI8mPIlECAxYQACH5BAUKAAEALDgAmQAEAGcAAAhKAAMEAAZMIEGDBQcmPKgQoUGBAyEmjPiwIsWLEzNK3GhRY0eOGEF6DPmxJMmTI1OKXGlSZUuWKGG6jPmyJs2bM3PK3GlTJcGCAQEAIfkEBQoAAQAsPACfAAUAWwAACEwAgQUYGEAgQYMDERYkuPAgQ4UQH0p0SDHhRIsVG2LcqLFjxIwfOYYsOBJiyYseT4JEqVIky5crY7qU6RHmzIQta9LMydOmzps/CwYEACH5BAUKAAEALEEAhwAEAHMAAAhJAAMIBCYwAMGBAw8eNFhwocOGEBFKZDjxYcWIFDNa1Ihxo8eOIC+K5DjyY8mQwBSGJMnSZMuVLmPCnHmy5kubMnHSvJlSp82AAAAh+QQFCgABACxFAIcABAAXAAAIIACBBRgokODAAAURHkzIkOHChwQdGowIUeFEixglIgwIACH5BAUKAAEALEkAfAAEADsAAAg+AAMIBCYwAMGBBQ8aTMgQocOFDxVKbAix4sSIFC9CBHZQ40WOGA12HDmQpMiSKE+qBLnSJMuXLmOmhDnzYEAAIfkEBQoAAQAsTQB8AAQAHAAACCcAgQUYKJDgwAAFER5MyHChQ4MQFUZsOPGhRITAMmIUmJGjxooTAwIAIfkEBQoAAQAsUQCEAAQAIQAACDEAAwgEJjAAwYEFDxpMyBChw4UPFUpsaBAYQYsXLVa8uJCjx44bKw48qFGkyZIoCQYEACH5BAUKAAEALFUAgwAFACAAAAgxAIEBC0BQIMGCBwMMPLgQIcOEDRVCnMgwokWKDjNKfFgR48aCDQ2C7DiypMKQKCsGBAAh+QQFCgABACxaAI0ABAAdAAAIKQADBAAGTCBBgwUHJjyoEKHDhhAZEixIcaDFihgvaszI8eJBiQtDPgwIACH5BAUKAAEALF4AigAEAA8AAAgcAIEBCxBAoMGDCA0SLLhwIEGHDB82nCixYoCAAAAh+QQFCgABACxiAH0ABAAsAAAINQADCAQmMADBgQUPGkzIEKHDhQ8VSmwI7CDBiwsxaszIcaPHjiA/ijRYcaDFkyZTklRZcmVAACH5BAUKAAEALGYAfQAEACcAAAg5AIEFGCiQ4MAABREeTMhwoUODEBUaBEYRYUWKAjFazHjxosKMH0OC5FiwokWCJVOiXHmypcmXAgMCACH5BAUKAAEALGoAigAEAB0AAAgqAAMIBCYwAMGBBQ8aTHgQWMOHAyEalOgwosWJFytixOiQoMeFHTNSJBgQACH5BAUKAAEALG4AgwAFABIAAAglAAMAAxag4ECDBwUqVEiQocGFBBs+LLhwosWKGCUKTDhQI7CAAAAh+QQFCgABACxzAIoABAAQAAAIHQADBAAGTCBBgwUHJjyoEKHDhgoLEpw48SFDhgEBACH5BAUKAAEALHcAlQAEAB4AAAgrAIEFGCiQ4MAABREeTMhwoUODEBUCm4iQ4sSLAi9WzGixI8eGEUEqDLkwIAAh+QQFCgABACx7AH4ABAA1AAAIOQADBAAGTCBBgwUHJjyoEKHDhhAZJhwokKLBihMzYtx4saPFjxo9hgTJ0aLEkiNTolwpkiXJiBUDAgAh+QQFCgABACx/AIgABAAYAAAIIgCBBRgokODAAAURHkwIjOHChwYjKpTYEOLEiw4pLizYMCAAIfkEBQoAAQAsgwCNAAQAGwAACCgAAwgEJjAAwYEFDxoceFChw4QQEUpcOPEhwYsLgWk02LAjw48cQQYEACH5BAUKAAEALIcAjAAFAAoAAAgaAAMAAxZA4ECCAwUaVJjwIMKDCwsmlEiQYkAAIfkEBQoAAQAsjACQAAQAHwAACCUAgQUYKJDgwAAFER5MyJDhwocGIyqU6JDiwooIMWqEOLEjw4AAACH5BAUKAAEALJAArgAEAD0AAAhDAIEFGCiQ4MAABREeTMhwoUODEBVGbDjxocSLFDFazMhxo8eKE4EJFDlSJEKTJFOqTEmwoMmTLWPCnPmypsubMm0GBAAh+QQFCgABACyUAMoABAAwAAAINAADBAAGTCBBgwUHJjxIsKDDgRAfSoxI8aFChBgvajy4caHHjBxDfuwIcqTIkihJqjypMiAAIfkEBQoAAQAsmADWAAQAKgAACCoAgQUYKJDgwAAFER5MyHChQ4MQFUZsSJCixIsWMz7EuFHjxI4eOU4EFhAAIfkEBQoAAQAsnACJAAQAdwAACEoAAwgEJjAAwYEFDxpMyBChw4UPFUpsCLHixIgUL1rMyBGjx40fNYrsCLLkyJAkT5pMyRKly5UvVcpsCbPmzJgdgR28aZOjToIBAQAh+QQFCgABACygAHoABQAeAAAINACBAQtAUCDBAAYLDlR4MCHChQ8bJhy4kGJBhBcrYsSoEWLEhgc3XgRJkmFJkSg9qgwJLCAAIfkEBQoAAQAspQCXAAQADQAACBoAgQUYKBCYwQAGCyY8mBAhw4cKCQp0KDFAQAAh+QQFCgABACypAJsABAAYAAAIIwCBAQsQQCBBgwUHJiRYkKHChgcdSoxIEaJFhBcnXnzI0WFAACH5BAUKAAEALK0AjQAEACYAAAgrAAMIBCYwAEGDBw8aLKiwIcOHAyEujEhxokWHFTFOBJZQokaMHDN6HFkxIAAh+QQFCgABACyxAHsABAAYAAAIJQADBAAGTCBBgwIHJiyIsKFChwwfHnxIMaLFhQYZTtyosaPAgAAAIfkEBQoAAQAstQB8AAQAEgAACB8AgQUYKJBgAGAIDyZEKJAhQ4UNF0qMSBGixYcYBQYEACH5BAUKAAEALLkAiAAFABIAAAgmAIEBC0BQIMEABgsOVJhQ4EKHDBkONDhxIkKLFA8i1LiwIEeOAQEAIfkEBQoAAQAsvgCEAAQAHQAACCcAAwgENpBgAIMHBSYcWJChw4UQEUpUOPFhxYgNDxoEtrFjRo4ZAwIAIfkEBQoAAQAswgCEAAQASQAACDgAgQUYKJDgwAAFER5MyHChQ4MQFUZsOPGhxIsUMVoElrHjxoUeJ4bUWLEkyZMjU340qZLlSpQBAQAh+QQFCgABACzGAHwABABRAAAIQgADBAAGTCBBgwUHJjw4UGBDgw4TPpwosWLEixAzUsS4UaNFjxw/dhwpsmTIkyBTkkT5kKFJlS9XwmS5cCHNmxoDAgAh+QQFCgABACzKAHEABAAZAAAIKACBAQsQQCBBgwUHJjyoEKHDhhAHSixIUeLDgwQpYtyosaNCjxmBBQQAIfkEBQoAAQAszgBwAAQAGgAACCcAAwADFkAgQYMEEwpcqLAhw4cKCx5cKLEgxYsTM1rUWLEjRokHAwIAIfkEBQoAAQAs0gB2AAUAOQAACEQAAwADFqDgwIICCSZUOJDhQYQKDSIUODEiRYgVM2LcaNCiR40SOV4MSXKkyY8iUZZUeRJky5QuWcqMSTNlxIcJIQILCAAh+QQFCgABACzXAIEABAArAAAINQCBAQsQQCBBgwUHJjw4UGBDhwYdJnxIkWBBiwovHsTIcaNHjSAziuwYkuTIjydLojTJkmBAACH5BAUKAAEALNsAgQAEABoAAAgmAIEBCxBAIEGDBQcmPKiwIEGHBx82nDhRosWIDC9C3FgRI0eJAQEAIfkEBQoAAQAs3wCDAAQAGAAACCIAAwgENpBgAIMHBSY8aBChQ4UPB0KcKLEisIYUF2qMqDEgACH5BAUKAAEALOMAdwAEAA8AAAgcAAMIBCYwAMGBwAgmVJjQYMOFDhlKjEhxosOAAAAh+QQFCgABACznAHcABAAcAAAIKwCBBRgokODAAAURHkzIcKFDgsAERpQYEWHFiRYpasz4UKHBjx4tQhxpMSAAIfkEBQoAAQAs6wCIAAUAIQAACDMAAwADFqDgwIICCRpUmBDhwYQKCTIUiJCiw4oTM2LceNGhxo4GOYYEaXGkyZIoM340GBAAIfkEBQoAAQAs8ACLAAQAHgAACCwAgQELEEAgQYMFByY8qBChw4YGB0pMCJEhwYIXFWI8mLEjx48bQ2oc6TFkQAAh+QQFCgABACz0AJgABAAZAAAIKACBBRgokODAAAURHkzIcKFDgwgFAps4MSLBghUtaszIEaPHiyADBAQAIfkEBQoAAQAs+ACMAAQAFwAACCcAAwADFkAgQYMFByY8qBChQYIDIRYUOPEgxYQLMWq8yNGix4oTAwIAIfkEBQoAAQAs/ACTAAQADwAACBoAgQUYKJDgwAAFER4ElrDhwocEGUJUaJBgQAAh+QQFCgABACwAAYYABAAcAAAIKQADBAAGbCDBgQgLKkzIcOFCgQUhCkQosSLFixExQoyYseNEjxZBBggIACH5BAUKAAEALAQBhgAFABkAAAgsAAMIDABsIEGDBQcmFLjwoMKFwCBKfEiR4USLDxMW1OhwI8OOByOGtKgxYUAAIfkEBQoAAQAsCQFkAAQAIwAACDAAAwgEJjAAwYEFDxpMyBChw4UPFUpsCOzgRIQVCWY0WJGjxo4bQ4JsCLHkRZMFAwIAIfkEBQoAAQAsDQFkAAQAMAAACDMAgQUYKJDgwAAFER5MyHChQ4MQFUYE1nDiQ4QVJWrMyPFiR4sgN3osSJEgyZMmU2I0GRAAIfkEBQoAAQAsEQF7AAQAHgAACCoAAwADFkDgQIEICSpMyHChw4YQH0o0qPAgwYIXEWIsqLFjxo8cQW7EGBAAIfkEBQoAAQAsFQGIAAQANgAACEAAAwgEJjAAwYEFDxpMyBChw4UPFUpsaPAgMIsYB2asqLEjx48XPYYEGZKgyYUnU6JcqbIly5cuY1Y0uXFkyIAAACH5BAUKAAEALBkBhQAEAAsAAAgWAIEJHAgswECDAgMgVJhwocOGEAsGBAAh+QQFCgABACwdAYUABQAlAAAIPACBBRgYQCBBgwMRFiS48CBDhQaBSUwoUeBEixYLZrzYMOPCiB1DghyZUGRJkh9PqkzJsiLFgwgnvpwZEAAh+QQFCgABACwiAYcABAATAAAIIQCBAQsQQCBBgQMTFlyosCHDhw4VHiS48ODAghcNYrQYEAAh+QQFCgABACwmAXoABAArAAAINQADCAQmMADBgQUPGkzIEKHBgwojNlzokKJFiRUxXpwokaDHhR9DAoNIcmDJhyZTolw5MmVAACH5BAUKAAEALCoBegAEABMAAAgfAIEFGCiQ4MAABREeBMYQYUODEBVGTEhxocWJBRkGBAAh+QQFCgABACwuAXgABAAqAAAINQADCAQmMADBgQUPGkzIEKHDhQ6BHVRIsSHEiwQzLtTIcaPHjiA/igQp0eDEkwNRmkzJMkBAACH5BAUKAAEALDIBeAAEABMAAAgfAIEFGCgQmMGDAQwSFJiQocKGCyNCnPiwosOLEhUGBAAh+QQFCgABACw2AXIABQAQAAAIIwADCAQGTGAAggYRDiy4MCHDgw8JFkQ4ceBBiwwrQozIUWBAACH5BAUKAAEALDsBeAAEACQAAAgvAIEBCxBAIMGCBwcSVIhwYUKGEBNKdEixocWIFTFenLhxoUKDBT+K9EgyZEmBAQEAIfkEBQoAAQAsPwFzAAQAIAAACCgAAwgEJjAAwYEFDxpMyBChQYLADiqc2HChQ4sYKV7UmLGiRIkeKwYEACH5BAUKAAEALEMBcAAEABIAAAgXAAMIBCYwAMGBwBIqXMiwocOHECMyDAgAIfkEBQoAAQAsRwFwAAQAKQAACDAAgQUYKJDgwAAFERIsCIyhw4UQETpsSLGixYsYG0bUKHHjw44gOYr8ONKjyZAfAwIAIfkEBQoAAQAsSwF0AAQAFAAACCEAgQUYKJDgwAAFER5MyHChQ2AQEUKcGHGiQoMYL2pkGBAAIfkEBQoAAQAsTwGEAAUAIQAACDUAAwADFqDgwIICCSZUOJDhwYUGHzYkeFChQYQCMVrMiHCjR40gO2r8KLLkRZMcT6pMydJjQAAh+QQFCgABACxUAaQABAAvAAAILgCBBRgokGDBAAcTDkS4UCHBhhAfSkTokOHEihgjWtyY8aLGjhw/ivRocCTCgAAAIfkEBQoAAQAsWAGcAAQARgAACEoAAwQABkwgQYMFByY8qBChw4YNCRacOLAixYsWMxoUWHGjx44gE4bkKLIkyZMfTaZEOXKly5YwVcZEybDmwpsPbebECVFnz4QBAQAh+QQFCgABACxcAawABAAQAAAIGQCBBRgokODAAAURHkzIcCHDhgQhKjRIMCAAIfkEBQoAAQAsYAGgAAQAHAAACCsAAwgEJjAAwYHAEiY0uFAhQ4IOIzacCHHhwIIHDWLceLGjRo8ZQ3L8GCAgACH5BAUKAAEALGQBlwAEABkAAAgoAIEBCxBAIEGDBQcmPKhQ4MCHBSNCPEhwIcWLETEqzMhxo8eKHw8GBAAh+QQFCgABACxoAYcABQAsAAAIQwCBAQtAUCDBAAYLDlR4MCHChQ8bQnRIcWLCgQsxFkS4MSNHjh5DdhwJkqRGkAIxppTIkqHLiC8rtoRJk+LBjxsbBgQAIfkEBQoAAQAsbQGhAAQARQAACEcAAwgEJjAAwYEFDxpMyBChw4UPFUpsCNHgQWAXMw7UaHGjx44gMX4UGZIjyZMmCWJUuZCly5YwX8qMSXOmzZo4V45MubNnQAAh+QQFCgABACxxAZsABAAhAAAIKwCBAQsQQCBBgwUHJjyoEGFBgg8PQlQYsSLFixMnYpTIMCNHix5BftxoMSAAIfkEBQoAAQAsdQGoAAQAFAAACCIAgQELIHBgQYICERpMWPCgQ4YQF0pUSDEAQYsXLQ7UiDEgACH5BAUKAAEALHkBnAAEACMAAAgyAAMAAxZAIEGDBQcmPKgQocOGEBkSHDhRIUWDBwUW1JhwY8aPHz2K7EiSo8mQJVEKDAgAIfkEBQoAAQAsfQGPAAQATQAACEwAAwgEJjAAwYEFDxpMyBChw4UPFUpsCLHixIgUL1rMyBGjR2AHNYrsuBAkQZMGQaY8qTLlwJAwX8p0SbOlzZg1cd6cuTMnT51AZQYEACH5BAUKAAEALIEBhgAFABwAAAgwAIEBC0BQIMEABgsOVHgwIcKEAxdGjFjwIEKLCys2xMhxY8OMFz1qHBmSJMiTGAMCACH5BAUKAAEALIYBlAAEADQAAAg7AIEBCxBAIEGDBQcmTDhQYEODDhlKjEgRYsGLDTFqrHhQIcKPHkN2HLmwJEiSJ02KVIlyZcqXLmMGCAgAIfkEBQoAAQAsigGFAAQAFAAACCMAgQELEEAgQYMFByY8qBChwIcQIz5kSLBgRYUWD17cqJFgQAAh+QQFCgABACyOAX8ABAAyAAAIPgADAAMWQCBBgwUHJjyoEKHDhhAZSlxI8SHBgRcVYsRoMKPHjgILhkwo8uDIkyZTllxJsiVKli9dqpQJM2VAACH5BAUKAAEALJIBqAAEAFYAAAhEAIEBCxBAIEGDBQcmPKgQoUOFBQlGZCgRosWKGA9mnMjxosaPHTd6DAlypEmRKEumJMnypEqKL1uudCkzJs2bM3OWDAgAIfkEBQoAAQAslgGpAAQAVwAACEIAAwgEJjAAwYEFDxpMyBChw4UPFUpsCLHixIgDD160SHGjx44gMYrkOPJjyZAkU5pUiXKly5YwT8pcSLAmTWAEAwIAIfkEBQoAAQAsmgGmAAUAHQAACC8AgQELQFAgwQAGCwociDDhwoMNITIsKLHiwYkILVK8qDEjx48bQ3oUibFkR2ABAQAh+QQFCgABACyfAYgABABgAAAIVAADCAQmMADBgQUPGkzIEKHDhQ8VSmwIESKwgxMjUsxYkaPHjSA1iuwYkuTIjydLfiTIcmHLlxcHYpwps6ZBmjdtxszJc6dPnD91Ah0qtGhPojkDAgAh+QQFCgABACyjAYgABAAWAAAIIQCBBRgokODAAAURHgTGEGFDggkjLpxosKJCixIxUkQYEAAh+QQFCgABACynAYYABAAgAAAILwADBAAGTCBBgwUHJjyoEKHDhgQLShxIcaLFigIpGsyYUKPHjgtDPmRIUmTDkwEBACH5BAUKAAEALKsBlAAEAGEAAAhBAIEFGCiQ4MAABREeTMhwoUODEBVGbDjxocSLFDFazAiM48aPFUNqJOhRZMmRKE+q3LjSJMiUL1vCdElzpk2OAQEAIfkEBQoAAQAsrwGTAAQAYgAACEQAAwgENpBgAIMHBSYcqBChw4YQGUpcSPHhRIsVI2Y8aBCjR40fL4IcKbLkxpMhUZIE1pGkSpMpY7qUCXOmzZo4X1IMCAAh+QQFCgABACyzAYMABQAwAAAIRAADAAMWoODAggIJGlSYEOHBhQ4ZPmwIsSLFixMfDlS4cSFHjR0PEhTZcOTIkihJqjy5UiBCjBJjRpxpMaPMmjdhRgwIACH5BAUKAAEALLgBhwAEACQAAAgyAAMIBCYwAMGBBQ8aTGgQGEGHDx02jEhxokWFGBki3LiQY0aPGjtKbDjw4MiTJlMKDAgAIfkEBQoAAQAsvAGHAAQAGgAACCgAgQUYKJDgwAAFER5MyHChQ4MQFUYUCKwiQosVKWbceJHiQ4kgGQYEACH5BAUKAAEALMABfAAEACUAAAgyAAMEAAZMIEGDBQcmPKgQocOGEBlKXEjRIcGCCQcK1BhxY8aPHkMaFMmxJMiRKE1uDAgAOw==" width="700" height="256"></p><p>Identify pixels out of broadcast range</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="shows-all-pixels-outside-of-broadcast-range">Shows all pixels outside of broadcast range<a class="hash-link" href="#shows-all-pixels-outside-of-broadcast-range" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi &quot;movie=&#x27;*input.mp4*&#x27;, signalstats=out=brng:color=cyan[out]&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter input virtual device</a></p></li><li><p>&quot;</p><p>quotation mark to start the lavfi filtergraph</p></li><li><p>movie=&#x27;<em>input.mp4</em>&#x27;</p><p>declares video file source to apply filter</p></li><li><p>,</p><p>comma signifies closing of video source assertion and ready for filter assertion</p></li><li><p>signalstats=out=brng</p><p>tells ffplay to use the signalstats command, output the data, use the brng filter</p></li><li><p>:</p><p>indicates there’s another parameter coming</p></li><li><p>color=cyan<!-- -->[out]</p><p>sets the color of out-of-range pixels to cyan</p></li><li><p>&quot;</p><p>quotation mark to end the lavfi filtergraph</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-of-filter-output-1">Example of filter output<a class="hash-link" href="#example-of-filter-output-1" title="Direct link to heading">​</a></h2><p><img alt="BRNG example" src="/assets/images/outside_broadcast_range-3fb7f95e34ccec706a3fe1b4bf89298d.gif" width="640" height="340"></p><p>Vectorscope from video to screen</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="plays-vectorscope-of-video">Plays vectorscope of video<a class="hash-link" href="#plays-vectorscope-of-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay *input_file* -vf &quot;split=2[m][v], [v]vectorscope=b=0.7:m=color3:g=green[v], [m][v]overlay=x=W-w:y=H-h&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-vf</p><p>creates a filtergraph to use for the streams</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>split=2<!-- -->[m][v]</p><p>Splits the input into two identical outputs and names them <!-- -->[m]<!-- --> and <!-- -->[v]</p></li><li><p>,</p><p>comma signifies there is another parameter coming</p></li><li><p>[v]<!-- -->vectorscope=b=0.7:m=color3:g=green<!-- -->[v]</p><p>asserts usage of the vectorscope filter and sets a light background opacity (b, alias for bgopacity), sets a background color style (m, alias for mode), and graticule color (g, alias for graticule)</p></li><li><p>,</p><p>comma signifies there is another parameter coming</p></li><li><p>[m][v]<!-- -->overlay=x=W-w:y=H-h</p><p>declares where the vectorscope will overlay on top of the video image as it plays</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li></ul><p>Side by Side Videos/Temporal Difference Filter</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="this-will-play-two-input-videos-side-by-side-while-also-applying-the-temporal-difference-filter-to-them">This will play two input videos side by side while also applying the temporal difference filter to them<a class="hash-link" href="#this-will-play-two-input-videos-side-by-side-while-also-applying-the-temporal-difference-filter-to-them" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input01 -i input02 -filter_complex &quot;[0:v:0]tblend=all_mode=difference128[a];[1:v:0]tblend=all_mode=difference128[b];[a][b]hstack[out]&quot; -map [out] -f nut -c:v rawvideo - | ffplay -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input01</em> -i <em>input02</em></p><p>Designates the files to use for inputs one and two respectively</p></li><li><p>-filter_complex</p><p>Lets FFmpeg know we will be using a complex filter (this must be used for multiple inputs)</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>[0✌️0]<!-- -->tblend=all_mode=difference128<!-- -->[a]</p><p>Applies the tblend filter (with the settings all_mode and difference128) to the first video stream from the first input and assigns the result to the output <!-- -->[a]</p></li><li><p>[1✌️0]<!-- -->tblend=all_mode=difference128<!-- -->[b]</p><p>Applies the tblend filter (with the settings all_mode and difference128) to the first video stream from the second input and assigns the result to the output <!-- -->[b]</p></li><li><p>[a][b]<!-- -->hstack<!-- -->[out]</p><p>Takes the outputs from the previous steps (<!-- -->[a]<!-- --> and <!-- -->[b]<!-- --> and uses the hstack (horizontal stack) filter on them to create the side by side output. This output is then named <!-- -->[out]<!-- -->)</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li><li><p>-map <!-- -->[out]</p><p>Maps the output of the filter chain</p></li><li><p>-f nut</p><p>Sets the format for the output video stream to <a href="https://ffmpeg.org/ffmpeg-formats.html#nut" target="_blank" rel="noopener noreferrer">Nut</a></p></li><li><p>-c:v rawvideo</p><p>Sets the video codec of the output video stream to raw video</p></li><li><ul><li></li></ul><p>tells FFmpeg that the output will be piped to a new command (as opposed to a file)</p></li><li><p>|</p><p>Tells the system you will be piping the output of the previous command into a new command</p></li><li><p>ffplay -</p><p>Starts ffplay and tells it to use the pipe from the previous command as its input</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="example-of-filter-output-2">Example of filter output<a class="hash-link" href="#example-of-filter-output-2" title="Direct link to heading">​</a></h2><p><img alt="astats example" src="/assets/images/tempdif-d68d5b46c4ce86280ab311ab84744121.gif" width="426" height="120"></p><p>Use xstack to arrange output layout of multiple video sources</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="this-filter-enables-vertical-and-horizontal-stacking-of-multiple-video-sources-into-one-output">This filter enables vertical and horizontal stacking of multiple video sources into one output.<a class="hash-link" href="#this-filter-enables-vertical-and-horizontal-stacking-of-multiple-video-sources-into-one-output" title="Direct link to heading">​</a></h5><p>This filter is useful for the creation of output windows such as the one utilized in <a href="https://github.com/amiaopensource/vrecord" target="_blank" rel="noopener noreferrer">vrecord.</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi -i *testsrc* -vf &quot;split=3[a][b][c],[a][b][c]xstack=inputs=3:layout=0_0|0_h0|0_h0+h1[out]&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The following example uses the &#x27;testsrc&#x27; virtual input combined with the <a href="https://ffmpeg.org/ffmpeg-filters.html#split_002c-asplit" target="_blank" rel="noopener noreferrer">split filter</a> to generate the multiple inputs.</p><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi -i testsrc</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter&#x27;s virtual device input &#x27;testsrc&#x27;</a></p></li><li><p>-vf</p><p>tells ffmpeg that you will be applying a filter chain to the input</p></li><li><p>split=3<!-- -->[a][b]<!-- -->[c]<!-- -->,</p><p>splits the input into three separate signals within the filter graph, named a, b and c respectively. (These are variables and any names could be used as long as they are kept consistent in following steps). The <code>,</code> separates this from the next part of the filter chain.</p></li><li><p>[a][b]<!-- -->[c]<!-- -->xstack=inputs=3:</p><p>tells ffmpeg that you will be using the xstack filter on the three named inputs a,b and c. The final <code>:</code> is a necessary divider between the number of inputs, and the orientation of outputs portion of the xstack command.</p></li><li><p>layout=0_0|0_h0|0_h0+h1</p><p>This is where the locations of the video sources in the output stack are designated. The locations are specified in order of input (so in this example <code>0_0</code> corresponds to input <code>[a]</code>. Inputs must be separated with a <code>|</code>. The two numbers represent columns and rows, with counting starting at zero rather than one. In this example, <code>0_0</code> means that input <code>[a]</code> is placed at the first row of the first column in the output. <code>0_h0</code> places the next input in the first column, at a row corresponding with the height of the first input. <code>0_h0+h1</code> places the final input in the first column, at a row corresponding with the height of the first input plus the height of the second input. This has the effect of creating a vertical stack of the three inputs. This could be made a horizontal stack by changing this portion of the command to <code>layout=0_0|w0_0|w0+w1_0</code>.</p></li><li><p>[out]</p><p>this ends the filter chain and designates the final output.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="view-or-strip-metadata">View or strip metadata<a class="hash-link" href="#view-or-strip-metadata" title="Direct link to heading">​</a></h2><p>Pull specs from video file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="pull-specs-from-video-file">Pull specs from video file<a class="hash-link" href="#pull-specs-from-video-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -i *input_file* -show_format -show_streams -show_data -print_format xml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command extracts technical metadata from a video file and displays it in xml.</p><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-show_format</p><p>outputs file container informations</p></li><li><p>-show_streams</p><p>outputs audio and video codec informations</p></li><li><p>-show_data</p><p>adds a short “hexdump” to show_streams command output</p></li><li><p>-print_format</p><p>Set the output printing format (in this example “xml”; other formats include “json” and “flat”)</p></li></ul><p>See also the <a href="https://ffmpeg.org/ffprobe.html" target="_blank" rel="noopener noreferrer">FFmpeg documentation on ffprobe</a> for a full list of flags, commands, and options.</p><p>Strip metadata</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="strips-metadata-from-video-file">Strips metadata from video file<a class="hash-link" href="#strips-metadata-from-video-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -map_metadata -1 -c:v copy -c:a copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-map_metadata -1</p><p>sets metadata copying to -1, which copies nothing</p></li><li><p>-c:v copy</p><p>copies video track</p></li><li><p>-c:a copy</p><p>copies audio track</p></li><li><p><em>output_file</em></p><p>Makes copy of original file and names output file</p></li></ul><p>Note: <code>-c:v</code> and <code>-c:a</code> are shortcuts for <code>-vcodec</code> and <code>-acodec</code>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="preservation-tasks">Preservation tasks<a class="hash-link" href="#preservation-tasks" title="Direct link to heading">​</a></h2><p>Batch processing (Mac/Linux)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-bash-script-to-batch-process-with-ffmpeg">Create Bash script to batch process with FFmpeg<a class="hash-link" href="#create-bash-script-to-batch-process-with-ffmpeg" title="Direct link to heading">​</a></h5><p>Bash scripts are plain text files saved with a .sh extension. This entry explains how they work with the example of a bash script named “Rewrap-MXF.sh”, which rewraps .mxf files in a given directory to .mov files.</p><p>“Rewrap-MXF.sh” contains the following text:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">for file in *.mxf; do ffmpeg -i &quot;$file&quot; -map 0 -c copy &quot;${file%.mxf}.mov&quot;; done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>for file in *.mxf</p><p>starts the loop, and states what the input files will be. Here, the FFmpeg command within the loop will be applied to all files with an extension of .mxf. The word ‘file’ is an arbitrary variable which will represent each .mxf file in turn as it is looped over.</p></li><li><p>do ffmpeg -i &quot;$file&quot;</p><p>carry out the following FFmpeg command for each input file. Per Bash syntax, within the command the variable is referred to by <strong>“$file”</strong>. The dollar sign is used to reference the variable ‘file’, and the enclosing quotation marks prevents reinterpretation of any special characters that may occur within the filename, ensuring that the original filename is retained.</p></li><li><p>-map 0</p><p>retain all streams</p></li><li><p>-c copy</p><p>enable stream copy (no re-encode)</p></li><li><p>&quot;${file%.mxf}.mov&quot;;</p><p>retaining the original file name, set the output file wrapper as .mov</p></li><li><p>done</p><p>complete; all items have been processed.</p></li></ul><p><strong>Note:</strong> the shell script (.sh file) and all .mxf files to be processed must be contained within the same directory, and the script must be run from that directory.
Execute the .sh file with the command <code>sh Rewrap-MXF.sh</code>.</p><p>Modify the script as needed to perform different transcodes, or to use with ffprobe. :)</p><p>The basic pattern will look similar to this:
<code>for item in *.ext; do ffmpeg -i $item *(FFmpeg options here)* &quot;${item%.ext}_suffix.ext&quot;</code></p><p>e.g., if an input file is bestmovie002.avi, its output will be bestmovie002_suffix.avi.</p><p>Variation: recursively process all MXF files in subdirectories using <code>find</code> instead of <code>for</code>:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">find input_directory -iname &quot;*.mxf&quot; -exec ffmpeg -i {} -map 0 -c copy {}.mov \;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Batch processing (Windows)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-powershell-script-to-batch-process-with-ffmpeg">Create PowerShell script to batch process with FFmpeg<a class="hash-link" href="#create-powershell-script-to-batch-process-with-ffmpeg" title="Direct link to heading">​</a></h5><p>As of Windows 10, it is possible to run Bash via <a href="https://msdn.microsoft.com/en-us/commandline/wsl/about" target="_blank" rel="noopener noreferrer">Bash on Ubuntu on Windows</a>, allowing you to use <a href="https://amiaopensource.github.io/ffmprovisr/#batch_processing_bash" target="_blank" rel="noopener noreferrer">bash scripting</a>. To enable Bash on Windows, see <a href="https://msdn.microsoft.com/en-us/commandline/wsl/install_guide" target="_blank" rel="noopener noreferrer">these instructions</a>.</p><p>On Windows, the primary native command line program is <strong>PowerShell</strong>. PowerShell scripts are plain text files saved with a .ps1 extension. This entry explains how they work with the example of a PowerShell script named “rewrap-mp4.ps1”, which rewraps .mp4 files in a given directory to .mkv files.</p><p>“rewrap-mp4.ps1” contains the following text:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$inputfiles = ls *.mp4 foreach ($file in $inputfiles) { $output = [io.path]::ChangeExtension($file, &#x27;.mkv&#x27;) ffmpeg -i $file -map 0 -c copy $output }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>$inputfiles = ls *.mp4</p><p>Creates the variable <code>$inputfiles</code>, which is a list of all the .mp4 files in the current folder. In PowerShell, all variable names start with the dollar-sign character.</p></li><li><p>foreach ($file in $inputfiles)</p><p>Creates a loop and states the subsequent code block will be applied to each file listed in <code>$inputfiles</code>. <code>$file</code> is an arbitrary variable which will represent each .mp4 file in turn as it is looped over.</p></li><li><p>{</p><p>Opens the code block.</p></li><li><p>$output = <!-- -->[io.path]<!-- -->::ChangeExtension($file, &#x27;.mkv&#x27;)</p><p>Sets up the output file: it will be located in the current folder and keep the same filename, but will have an .mkv extension instead of .mp4.</p></li><li><p>ffmpeg -i $file</p><p>Carry out the following FFmpeg command for each input file. <strong>Note:</strong> To call FFmpeg here as just ‘ffmpeg’ (rather than entering the full path to ffmpeg.exe), you must make sure that it’s correctly configured. See <a href="http://adaptivesamples.com/how-to-install-ffmpeg-on-windows/" target="_blank" rel="noopener noreferrer">this article</a>, especially the section ‘Add to Path’.</p></li><li><p>-map 0</p><p>retain all streams</p></li><li><p>-c copy</p><p>enable stream copy (no re-encode)</p></li><li><p>$output</p><p>The output file is set to the value of the <code>$output</code> variable declared above: i.e., the current file name with an .mkv extension.</p></li><li><p>}</p><p>Closes the code block.</p></li></ul><p><strong>Note:</strong> the PowerShell script (.ps1 file) and all .mp4 files to be rewrapped must be contained within the same directory, and the script must be run from that directory.</p><p>Execute the .ps1 file by typing <code>.\rewrap-mp4.ps1</code> in PowerShell.</p><p>Modify the script as needed to perform different transcodes, or to use with ffprobe. :)</p><p>Check decoder errors</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="check-decoder-errors">Check decoder errors<a class="hash-link" href="#check-decoder-errors" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This decodes your video and prints any errors or found issues to the screen.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-f null</p><p>Video is decoded with the <code>null</code> muxer. This allows video decoding without creating an output file.</p></li><li><ul><li></li></ul><p>FFmpeg syntax requires a specified output, and <code>-</code> is just a place holder. No file is actually created.</p></li></ul><p>Check FFV1 fixity</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="check-ffv1-version-3-fixity">Check FFV1 Version 3 fixity<a class="hash-link" href="#check-ffv1-version-3-fixity" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -report -i *input_file* -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This decodes your video and displays any CRC checksum mismatches. These errors will display in your terminal like this: <code>[ffv1 @ 0x1b04660] CRC mismatch 350FBD8A!at 0.272000 seconds</code></p><p>Frame CRCs are enabled by default in FFV1 Version 3.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-report</p><p>Dump full command line and console output to a file named <em>ffmpeg-YYYYMMDD-HHMMSS.log</em> in the current directory. It also implies <code>-loglevel verbose</code>.</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-f null</p><p>Video is decoded with the <code>null</code> muxer. This allows video decoding without creating an output file.</p></li><li><ul><li></li></ul><p>FFmpeg syntax requires a specified output, and <code>-</code> is just a place holder. No file is actually created.</p></li></ul><p>Create MD5 checksums (video frames)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-md5-checksums-video-frames">Create MD5 checksums (video frames)<a class="hash-link" href="#create-md5-checksums-video-frames" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -f framemd5 -an *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create an MD5 checksum per video frame.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-f framemd5</p><p>library used to calculate the MD5 checksums</p></li><li><p>-an</p><p>ignores the audio stream (audio no)</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>You may verify an MD5 checksum file created this way by using a <a href="https://amiaopensource.github.io/ffmprovisr/scripts/check_video_framemd5.sh" target="_blank" rel="noopener noreferrer">Bash script</a>.</p><p>Create MD5 checksums (audio samples)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-md5-checksums-audio-samples">Create MD5 checksums (audio samples)<a class="hash-link" href="#create-md5-checksums-audio-samples" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -af &quot;asetnsamples=n=48000&quot; -f framemd5 -vn *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create an MD5 checksum for each group of 48000 audio samples.
The number of samples per group can be set arbitrarily, but it&#x27;s good practice to match the samplerate of the media file (so you will get one checksum per second).</p><p>Examples for other samplerates:</p><ul><li>44.1 kHz: &quot;asetnsamples=n=44100&quot;</li><li>96 kHz: &quot;asetnsamples=n=96000&quot;</li></ul><p><strong>Note:</strong> This filter transcodes audio to 16 bit PCM by default. The generated framemd5s will represent this value. Validating these framemd5s will require using the same default settings. Alternatively, when your file has another quantization rates (e.g. 24 bit), then you might add the audio codec <code>-c:a pcm_s24le</code> to the command, for compatibility reasons with other tools, like <a href="https://mediaarea.net/BWFMetaEdit" target="_blank" rel="noopener noreferrer">BWF MetaEdit</a>.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-af &quot;asetnsamples=n=<em>48000</em>&quot;</p><p>the audio filter sets the sampling rate</p></li><li><p>-f framemd5</p><p>library used to calculate the MD5 checksums</p></li><li><p>-vn</p><p>ignores the video stream (video no)</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>You may verify an MD5 checksum file created this way by using a <a href="https://amiaopensource.github.io/ffmprovisr/scripts/check_audio_framemd5.sh" target="_blank" rel="noopener noreferrer">Bash script</a>.</p><p>Create MD5 checksum(s) for A/V stream data only</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-stream-md5s">Create stream MD5s<a class="hash-link" href="#create-stream-md5s" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -map 0:v:0 -c:v copy -f md5 *output_file_1* -map 0:a:0 -c:a copy -f md5 *output_file_2*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create MD5 checksums for the first video and the first audio stream in a file. If only one of these is necessary (for example if used on a WAV file) either part of the command can be excluded to create the desired MD5 only. Use of this kind of checksum enables integrity of the A/V information to be verified independently of any changes to surrounding metadata.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-map 0✌️0</p><p>selects the first video stream from the input</p></li><li><p>-c:v copy</p><p>ensures that FFmpeg will not transcode the video to a different codec before generating the MD5</p></li><li><p><em>output_file_1</em></p><p>is the output file for the video stream MD5. Example file extensions are <code>.md5</code> and <code>.txt</code></p></li><li><p>-map 0🅰️0</p><p>selects the first audio stream from the input</p></li><li><p>-c:a copy</p><p>ensures that FFmpeg will not transcode the audio to a different codec before generating the MD5 (by default FFmpeg will use 16 bit PCM for audio MD5s).</p></li><li><p><em>output_file_2</em></p><p>is the output file for the audio stream MD5.</p></li></ul><p><strong>Note:</strong> The MD5s generated by running this command on WAV files are compatible with those embedded by the <a href="https://mediaarea.net/BWFMetaEdit" target="_blank" rel="noopener noreferrer">BWF MetaEdit</a> tool and can be compared.</p><p>Get checksum for video/audio stream</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="get-checksum-for-videoaudio-stream">Get checksum for video/audio stream<a class="hash-link" href="#get-checksum-for-videoaudio-stream" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -loglevel error -i *input_file* -map 0:v:0 -f hash -hash md5 -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This script will perform a fixity check on a specified audio or video stream of the file, useful for checking that the content within a video has not changed even if the container format has changed.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-loglevel error</p><p>sets the verbosity of logging to show all errors</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-map 0✌️0</p><p>designated the first video stream as the stream on which to perform this hash generation operation. <code>-map 0</code> can be used to run the operation on all streams.</p></li><li><p>-f hash -hash md5</p><p>produce a checksum hash, and set the hash algorithm to md5. See the official <a href="https://ffmpeg.org/ffmpeg-formats.html#hash" target="_blank" rel="noopener noreferrer">documentation on hash</a> for other algorithms.</p></li><li><ul><li></li></ul><p>FFmpeg syntax requires a specified output, and <code>-</code> is just a place holder. No file is actually created.</p></li></ul><p>Get individual checksums for all video/audio streams (&quot;Streamhash&quot;)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="get-individual-checksums-for-all-videoaudio-streams-streamhash">Get individual checksums for all video/audio streams (&quot;Streamhash&quot;)<a class="hash-link" href="#get-individual-checksums-for-all-videoaudio-streams-streamhash" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -map 0 -f streamhash -hash md5 - -v quiet</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The outcome is very similar to that of &quot;-f hash&quot;, except you get one hash per-stream, instead of one (summary) hash. Another benefit is that you don&#x27;t have to know which streams, or how many to expect in the source file. This is very handy for hashing mixed born-digital material.</p><p>This script will perform a fixity check on all audio and video streams in the file and return one hashcode for each one. This is useful for e.g. being able to change to container/codec format later on and validate it matches the original source.</p><p>The output is formatted for easily processing it further in any kind of programming/scripting language.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-map 0</p><p>map ALL streams from input file to output. If you omit this, ffmpeg chooses only the first &quot;best&quot; (*) stream: 1 for audio, 1 for video (not all streams).</p></li><li><p>-f streamhash -hash md5</p><p>produce a checksum hash per-stream, and set the hash algorithm to md5. See the official <a href="https://www.ffmpeg.org/ffmpeg-formats.html#streamhash-1" target="_blank" rel="noopener noreferrer">documentation on streamhash</a> for other algorithms and more details.</p></li><li><ul><li></li></ul><p>FFmpeg syntax requires a specified output, and <code>-</code> is just a place holder. No file is actually created. Choose an output filename to write the hashcode lines into a textfile.</p></li><li><p>-v quiet</p><p>(Optional) Disables FFmpeg&#x27;s processing output. With this option it&#x27;s easier to see the text output of the hashes.</p></li></ul><p>The output looks like this, for example (1 video, 2 audio streams): <code>0,v,MD5=89bed8031048d985b48550b6b4cb171c0,a,MD5=36daadb543b63610f63f9dcff11680fb1,a,MD5=f21269116a847f887710cfc67ecc3e6e</code></p><p>QCTools report (with audio)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="creates-a-qctools-report">Creates a QCTools report<a class="hash-link" href="#creates-a-qctools-report" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -f lavfi -i &quot;movie=*input_file*:s=v+a[in0][in1], [in0]signalstats=stat=tout+vrep+brng, cropdetect=reset=1:round=1, idet=half_life=1, split[a][b];[a]field=top[a1];[b]field=bottom, split[b1][b2];[a1][b1]psnr[c1];[c1][b2]ssim[out0];[in1]ebur128=metadata=1, astats=metadata=1:reset=1:length=0.4[out1]&quot; -show_frames -show_versions -of xml=x=1:q=1 -noprivate | gzip &gt; *input_file*.qctools.xml.gz</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create an XML report for use in <a href="https://github.com/bavc/qctools" target="_blank" rel="noopener noreferrer">QCTools</a> for a video file with one video track and one audio track. See also the <a href="https://github.com/bavc/qctools/blob/master/docs/data_format.md#creating-a-qctools-document" target="_blank" rel="noopener noreferrer">QCTools documentation</a>.</p><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffprobe to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i</p><p>input file and parameters</p></li><li><p>&quot;movie=<em>input_file</em>:s=v+a<!-- -->[in0][in1]<!-- -->, <!-- -->[in0]<!-- -->signalstats=stat=tout+vrep+brng, cropdetect=reset=1:round=1, idet=half_life=1, split<!-- -->[a][b]<!-- -->;<!-- -->[a]<!-- -->field=top<!-- -->[a1]<!-- -->;<!-- -->[b]<!-- -->field=bottom, split<!-- -->[b1][b2]<!-- -->;<!-- -->[a1][b1]<!-- -->psnr<!-- -->[c1]<!-- -->;<!-- -->[c1][b2]<!-- -->ssim<!-- -->[out0]<!-- -->;<!-- -->[in1]<!-- -->ebur128=metadata=1, astats=metadata=1:reset=1:length=0.4<!-- -->[out1]<!-- -->&quot;</p><p>This very large lump of commands declares the input file and passes in a request for all potential data signal information for a file with one video and one audio track</p></li><li><p>-show_frames</p><p>asks for information about each frame and subtitle contained in the input multimedia stream</p></li><li><p>-show_versions</p><p>asks for information related to program and library versions</p></li><li><p>-of xml=x=1:q=1</p><p>sets the data export format to XML</p></li><li><p>-noprivate</p><p>hides any private data that might exist in the file</p></li><li><p>| gzip</p><p>The | is to &quot;pipe&quot; (or push) the data into a compressed file format</p></li><li><p><code>&gt;</code></p><p>redirects the standard output (the data made by ffprobe about the video)</p></li><li><p><em>input_file</em>.qctools.xml.gz</p><p>names the zipped data output file, which can be named anything but needs the extension qctools.xml.gz for compatibility issues</p></li></ul><p>QCTools report (no audio)</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="creates-a-qctools-report-1">Creates a QCTools report<a class="hash-link" href="#creates-a-qctools-report-1" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -f lavfi -i &quot;movie=*input_file*,signalstats=stat=tout+vrep+brng, cropdetect=reset=1:round=1, idet=half_life=1, split[a][b];[a]field=top[a1];[b]field=bottom,split[b1][b2];[a1][b1]psnr[c1];[c1][b2]ssim&quot; -show_frames -show_versions -of xml=x=1:q=1 -noprivate | gzip &gt; *input_file*.qctools.xml.gz</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will create an XML report for use in <a href="https://github.com/bavc/qctools" target="_blank" rel="noopener noreferrer">QCTools</a> for a video file with one video track and NO audio track. See also the <a href="https://github.com/bavc/qctools/blob/master/docs/data_format.md#creating-a-qctools-document" target="_blank" rel="noopener noreferrer">QCTools documentation</a>.</p><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffprobe to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i</p><p>input file and parameters</p></li><li><p>&quot;movie=<em>input_file</em>,signalstats=stat=tout+vrep+brng, cropdetect=reset=1:round=1, idet=half_life=1, split<!-- -->[a][b]<!-- -->;<!-- -->[a]<!-- -->field=top<!-- -->[a1]<!-- -->;<!-- -->[b]<!-- -->field=bottom,split<!-- -->[b1][b2]<!-- -->;<!-- -->[a1][b1]<!-- -->psnr<!-- -->[c1]<!-- -->;<!-- -->[c1][b2]<!-- -->ssim&quot;</p><p>This very large lump of commands declares the input file and passes in a request for all potential data signal information for a file with one video and one audio track</p></li><li><p>-show_frames</p><p>asks for information about each frame and subtitle contained in the input multimedia stream</p></li><li><p>-show_versions</p><p>asks for information related to program and library versions</p></li><li><p>-of xml=x=1:q=1</p><p>sets the data export format to XML</p></li><li><p>-noprivate</p><p>hides any private data that might exist in the file</p></li><li><p>| gzip</p><p>The | is to &quot;pipe&quot; (or push) the data into a compressed file format</p></li><li><p><code>&gt;</code></p><p>redirects the standard output (the data made by ffprobe about the video)</p></li><li><p><em>input_file</em>.qctools.xml.gz</p><p>names the zipped data output file, which can be named anything but needs the extension qctools.xml.gz for compatibility issues</p></li></ul><p>Read/Extract EIA-608 Closed Captioning</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="readextract-eia-608-line-21-closed-captioning">Read/Extract EIA-608 (Line 21) closed captioning<a class="hash-link" href="#readextract-eia-608-line-21-closed-captioning" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -f lavfi -i movie=*input_file*,readeia608 -show_entries frame=pkt_pts_time:frame_tags=lavfi.readeia608.0.line,lavfi.readeia608.0.cc,lavfi.readeia608.1.line,lavfi.readeia608.1.cc -of csv &gt; *input_file*.csv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command uses FFmpeg&#x27;s <a href="https://ffmpeg.org/ffmpeg-filters.html#readeia608" target="_blank" rel="noopener noreferrer">readeia608</a> filter to extract the hexadecimal values hidden within <a href="https://en.wikipedia.org/wiki/EIA-608" target="_blank" rel="noopener noreferrer">EIA-608 (Line 21)</a> Closed Captioning, outputting a csv file. For more information about EIA-608, check out Adobe&#x27;s <a href="https://www.adobe.com/content/dam/Adobe/en/devnet/video/pdfs/introduction_to_closed_captions.pdf" target="_blank" rel="noopener noreferrer">Introduction to Closed Captions</a>.</p><p>If hex isn&#x27;t your thing, closed captioning <a href="http://www.theneitherworld.com/mcpoodle/SCC_TOOLS/DOCS/CC_CHARS.HTML" target="_blank" rel="noopener noreferrer">character</a> and <a href="http://www.theneitherworld.com/mcpoodle/SCC_TOOLS/DOCS/CC_CODES.HTML" target="_blank" rel="noopener noreferrer">code</a> sets can be found in the documentation for SCTools.</p><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffprobe to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">libavfilter</a> input virtual device</p></li><li><p>-i <em>input_file</em></p><p>input file and parameters</p></li><li><p>readeia608 -show_entries frame=pkt_pts_time:frame_tags=lavfi.readeia608.0.line,lavfi.readeia608.0.cc,lavfi.readeia608.1.line,lavfi.readeia608.1.cc -of csv</p><p>specifies the first two lines of video in which EIA-608 data (hexadecimal byte pairs) are identifiable by ffprobe, outputting comma separated values (CSV)</p></li><li><blockquote></blockquote><p>redirects the standard output (the data created by ffprobe about the video)</p></li><li><p><em>output_file</em>.csv</p><p>names the CSV output file</p></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="example-3">Example<a class="hash-link" href="#example-3" title="Direct link to heading">​</a></h4><p>Side-by-side video with true EIA-608 captions on the left, zoomed in view of the captions on the right (with hex values represented). To achieve something similar with your own captioned video, try out the EIA608/VITC viewer in <a href="https://github.com/bavc/qctools" target="_blank" rel="noopener noreferrer">QCTools</a>.</p><p><img alt="GIF of Closed Captions" src="/assets/images/eia608_captions-71884d4d792173282ef41ff7bf8d9db1.gif" width="800" height="285"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="generate-test-files">Generate test files<a class="hash-link" href="#generate-test-files" title="Direct link to heading">​</a></h2><p>Make a mandelbrot test pattern video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="makes-a-mandelbrot-test-pattern-video">Makes a mandelbrot test pattern video<a class="hash-link" href="#makes-a-mandelbrot-test-pattern-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i mandelbrot=size=1280x720:rate=25 -c:v libx264 -t 10 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells FFmpeg to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i mandelbrot=size=1280x720:rate=25</p><p>asks for the <a href="https://ffmpeg.org/ffmpeg-filters.html#mandelbrot" target="_blank" rel="noopener noreferrer">mandelbrot test filter</a> as input. Adjusting the <code>size</code> and <code>rate</code> options allows you to choose a specific frame size and framerate.</p></li><li><p>-c:v libx264</p><p>transcodes video from rawvideo to H.264. Set <code>-pix_fmt</code> to <code>yuv420p</code> for greater H.264 compatibility with media players.</p></li><li><p>-t 10</p><p>specifies recording time of 10 seconds</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file. Try different file extensions such as mkv, mov, mp4, or avi.</p></li></ul><p>Make a SMPTE bars test pattern video</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="makes-a-smpte-bars-test-pattern-video">Makes a SMPTE bars test pattern video<a class="hash-link" href="#makes-a-smpte-bars-test-pattern-video" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i smptebars=size=720x576:rate=25 -c:v prores -t 10 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells FFmpeg to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i smptebars=size=720x576:rate=25</p><p>asks for the <a href="https://ffmpeg.org/ffmpeg-filters.html#allrgb_002c-allyuv_002c-color_002c-haldclutsrc_002c-nullsrc_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc" target="_blank" rel="noopener noreferrer">smptebars test filter</a> as input. Adjusting the <code>size</code> and <code>rate</code> options allows you to choose a specific frame size and framerate.</p></li><li><p>-c:v prores</p><p>transcodes video from rawvideo to Apple ProRes 4:2:2.</p></li><li><p>-t 10</p><p>specifies recording time of 10 seconds</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file. Try different file extensions such as mov or avi.</p></li></ul><p>Make a test pattern video</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="make-a-test-pattern-video">Make a test pattern video<a class="hash-link" href="#make-a-test-pattern-video" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i testsrc=size=720x576:rate=25 -c:v v210 -t 10 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells FFmpeg to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">libavfilter</a> input virtual device</p></li><li><p>-i testsrc=size=720x576:rate=25</p><p>asks for the testsrc filter pattern as input. Adjusting the <code>size</code> and <code>rate</code> options allows you to choose a specific frame size and framerate. The different test patterns that can be generated are listed <a href="https://ffmpeg.org/ffmpeg-filters.html#allrgb_002c-allyuv_002c-color_002c-haldclutsrc_002c-nullsrc_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc" target="_blank" rel="noopener noreferrer">here</a>.</p></li><li><p>-c:v v210</p><p>transcodes video from rawvideo to 10-bit Uncompressed Y′CBCR 4:2:2. Alter this setting to set your desired codec.</p></li><li><p>-t 10</p><p>specifies recording time of 10 seconds</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file. Try different file extensions such as mkv, mov, mp4, or avi.</p></li></ul><p>Play HD SMPTE bars</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="play-hd-smpte-bars">Play HD SMPTE bars<a class="hash-link" href="#play-hd-smpte-bars" title="Direct link to heading">​</a></h5><p>Test an HD video projector by playing the SMPTE color bars pattern.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi -i smptehdbars=size=1920x1080</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i smptehdbars=size=1920x1080</p><p>asks for the <a href="https://ffmpeg.org/ffmpeg-filters.html#allrgb_002c-allyuv_002c-color_002c-haldclutsrc_002c-nullsrc_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc" target="_blank" rel="noopener noreferrer">smptehdbars filter pattern</a> as input and sets the HD resolution. This generates a color bars pattern, based on the SMPTE RP 219–2002.</p></li></ul><p>Play VGA SMPTE bars</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="play-vga-smpte-bars">Play VGA SMPTE bars<a class="hash-link" href="#play-vga-smpte-bars" title="Direct link to heading">​</a></h5><p>Test a VGA (SD) video projector by playing the SMPTE color bars pattern.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi -i smptebars=size=640x480</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i smptebars=size=640x480</p><p>asks for the <a href="https://ffmpeg.org/ffmpeg-filters.html#allrgb_002c-allyuv_002c-color_002c-haldclutsrc_002c-nullsrc_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc" target="_blank" rel="noopener noreferrer">smptebars filter pattern</a> as input and sets the VGA (SD) resolution. This generates a color bars pattern, based on the SMPTE Engineering Guideline EG 1–1990.</p></li></ul><p>Generate a sine wave test audio file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="sine-wave">Sine wave<a class="hash-link" href="#sine-wave" title="Direct link to heading">​</a></h5><p>Generate a test audio file playing a sine wave.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i &quot;sine=frequency=1000:sample_rate=48000:duration=5&quot; -c:a pcm_s16le *output_file*.wav</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells FFmpeg to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>-i &quot;sine=frequency=1000:sample_rate=48000:duration=5&quot;</p><p>Sets the signal to 1000 Hz, sampling at 48 kHz, and for 5 seconds</p></li><li><p>-c:a pcm_s16le</p><p>encodes the audio codec in <code>pcm_s16le</code> (the default encoding for wav files). <code>pcm</code> represents pulse-code modulation format (raw bytes), <code>16</code> means 16 bits per sample, and <code>le</code> means &quot;little endian&quot;</p></li><li><p><em>output_file</em>.wav</p><p>path, name and extension of the output file</p></li></ul><p>SMPTE bars + Sine wave audio</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="smpte-bars--sine-wave-audio">SMPTE bars + Sine wave audio<a class="hash-link" href="#smpte-bars--sine-wave-audio" title="Direct link to heading">​</a></h5><p>Generate a SMPTE bars test video + a 1kHz sine wave as audio testsignal.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i &quot;smptebars=size=720x576:rate=25&quot; -f lavfi -i &quot;sine=frequency=1000:sample_rate=48000&quot; -c:a pcm_s16le -t 10 -c:v ffv1 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells FFmpeg to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">libavfilter</a> input virtual device</p></li><li><p>-i smptebars=size=720x576:rate=25</p><p>asks for the <a href="https://ffmpeg.org/ffmpeg-filters.html#allrgb_002c-allyuv_002c-color_002c-haldclutsrc_002c-nullsrc_002c-rgbtestsrc_002c-smptebars_002c-smptehdbars_002c-testsrc_002c-testsrc2_002c-yuvtestsrc" target="_blank" rel="noopener noreferrer">smptebars test filter</a> as input. Adjusting the <code>size</code> and <code>rate</code> options allows you to choose a specific frame size and framerate.</p></li><li><p>-f lavfi</p><p>use libavfilter again, but now for audio</p></li><li><p>-i &quot;sine=frequency=1000:sample_rate=48000&quot;</p><p>Sets the signal to 1000 Hz, sampling at 48 kHz.</p></li><li><p>-c:a pcm_s16le</p><p>encodes the audio codec in <code>pcm_s16le</code> (the default encoding for wav files). <code>pcm</code> represents pulse-code modulation format (raw bytes), <code>16</code> means 16 bits per sample, and <code>le</code> means &quot;little endian&quot;</p></li><li><p>-t 10</p><p>specifies recording time of 10 seconds</p></li><li><p>-c:v ffv1</p><p>Encodes to <a href="https://en.wikipedia.org/wiki/FFV1" target="_blank" rel="noopener noreferrer">FFV1</a>. Alter this setting to set your desired codec.</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Make a broken file</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="makes-a-broken-test-file">Makes a broken test file<a class="hash-link" href="#makes-a-broken-test-file" title="Direct link to heading">​</a></h5><p>Modifies an existing, functioning file and intentionally breaks it for testing purposes.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -bsf noise=1 -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>takes in a normal file</p></li><li><p>-bsf noise=1</p><p>sets bitstream filters for all to &#x27;noise&#x27;. Filters can be set on specific filters using syntax such as <code>-bsf:v</code> for video, <code>-bsf:a</code> for audio, etc. The <a href="https://ffmpeg.org/ffmpeg-bitstream-filters.html#noise" target="_blank" rel="noopener noreferrer">noise filter</a> intentionally damages the contents of packets without damaging the container. This sets the noise level to 1 but it could be left blank or any number above 0.</p></li><li><p>-c copy</p><p>use stream copy mode to re-mux instead of re-encode</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p>Conway&#x27;s Game of Life</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="conways-game-of-life">Conway&#x27;s Game of Life<a class="hash-link" href="#conways-game-of-life" title="Direct link to heading">​</a></h5><p>Simulates <a href="https://en.wikipedia.org/wiki/Conway&#x27;s_Game_of_Life" target="_blank" rel="noopener noreferrer">Conway&#x27;s Game of Life</a></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -f lavfi life=s=300x200:mold=10:r=60:ratio=0.1:death_color=#c83232:life_color=#00ff00,scale=1200:800</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-f lavfi</p><p>tells ffplay to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter</a> input virtual device</p></li><li><p>life=s=300x200</p><p>use the life filter and set the size of the video to 300x200</p></li><li><p>:</p><p>indicates there’s another parameter coming</p></li><li><p>mold=10:r=60:ratio=0.1</p><p>sets up the rules of the game: cell mold speed, video rate, and random fill ratio</p></li><li><p>:</p><p>indicates there’s another parameter coming</p></li><li><p>death_color=#c83232:life_color=#00ff00</p><p>specifies color for cell death and cell life; mold_color can also be set</p></li><li><p>,</p><p>comma signifies closing of video source assertion and ready for filter assertion</p></li><li><p>scale=1200:800</p><p>scale to 1280 width and 800 height</p></li></ul><p><img alt="GIF of above command" src="/assets/images/life-26165763530aa29e96c67790df9a9779.gif" width="500" height="333"></p><p>To save a portion of the stream instead of playing it back infinitely, use the following command:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f lavfi -i life=s=300x200:mold=10:r=60:ratio=0.1:death_color=#c83232:life_color=#00ff00,scale=1200:800 -t 5 *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="use-ocr">Use OCR<a class="hash-link" href="#use-ocr" title="Direct link to heading">​</a></h2><p>Play video with OCR</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="plays-video-with-ocr-on-top">Plays video with OCR on top<a class="hash-link" href="#plays-video-with-ocr-on-top" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay input_file -vf &quot;ocr,drawtext=fontfile=/Library/Fonts/Andale Mono.ttf:text=%{metadata\\\:lavfi.ocr.text}:fontcolor=white&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p><em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-vf</p><p>creates a filtergraph to use for the streams</p></li><li><p>&quot;</p><p>quotation mark to start filtergraph</p></li><li><p>ocr,</p><p>tells ffplay to use ocr as source and the comma signifies that the script is ready for filter assertion</p></li><li><p>drawtext=fontfile=/Library/Fonts/Andale Mono.ttf</p><p>tells ffplay to drawtext and use a specific font (Andale Mono) when doing so</p></li><li><p>:</p><p>indicates there’s another parameter coming</p></li><li><p>text=%{metadata<!-- -->\<!-- -->\:lavfi.ocr.text}</p><p>tells ffplay what text to use when playing. In this case, calls for metadata that lives in the lavfi.ocr.text library</p></li><li><p>:</p><p>indicates there’s another parameter coming</p></li><li><p>fontcolor=white</p><p>specifies font color as white</p></li><li><p>&quot;</p><p>quotation mark to end filtergraph</p></li></ul><p>Export OCR from video to screen</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="exports-ocr-data-to-screen">Exports OCR data to screen<a class="hash-link" href="#exports-ocr-data-to-screen" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -show_entries frame_tags=lavfi.ocr.text -f lavfi -i &quot;movie=*input_file*,ocr&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-show_entries</p><p>sets a list of entries to show</p></li><li><p>frame_tags=lavfi.ocr.text</p><p>shows the <em>lavfi.ocr.text</em> tag in the frame section of the video</p></li><li><p>-f lavfi</p><p>tells ffprobe to use the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter input virtual device</a></p></li><li><p>-i &quot;movie=<em>input_file</em>,ocr&quot;</p><p>declares &#x27;movie&#x27; as <em>input_file</em> and passes in the &#x27;ocr&#x27; command</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="compare-perceptual-similarity-of-videos">Compare perceptual similarity of videos<a class="hash-link" href="#compare-perceptual-similarity-of-videos" title="Direct link to heading">​</a></h2><p>Compare Video Fingerprints</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="compare-two-video-files-for-content-similarity-using-perceptual-hashing">Compare two video files for content similarity using perceptual hashing<a class="hash-link" href="#compare-two-video-files-for-content-similarity-using-perceptual-hashing" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_one* -i *input_two* -filter_complex signature=detectmode=full:nb_inputs=2 -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_one</em> -i <em>input_two</em></p><p>assigns the input files</p></li><li><p>-filter_complex</p><p>enables using more than one input file to the filter</p></li><li><p>signature=detectmode=full</p><p>Applies the signature filter to the inputs in &#x27;full&#x27; mode. The other option is &#x27;fast&#x27;.</p></li><li><p>nb_inputs=2</p><p>tells the filter to expect two input files</p></li><li><p>-f null -</p><p>Sets the output of FFmpeg to a null stream (since we are not creating a transcoded file, just viewing metadata).</p></li></ul><p>Generate Video Fingerprint</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="generate-a-perceptual-hash-for-an-input-video-file">Generate a perceptual hash for an input video file<a class="hash-link" href="#generate-a-perceptual-hash-for-an-input-video-file" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input* -vf signature=format=xml:filename=&quot;output.xml&quot; -an -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg -i <em>input</em></p><p>starts the command using your input file</p></li><li><p>-vf signature=format=xml</p><p>applies the signature filter to the input file and sets the output format for the fingerprint to xml</p></li><li><p>filename=&quot;output.xml&quot;</p><p>sets the output for the signature filter</p></li><li><p>-an</p><p>tells FFmpeg to ignore the audio stream of the input file</p></li><li><p>-f null -</p><p>Sets the FFmpeg output to a null stream (since we are only interested in the output generated by the filter).</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="other">Other<a class="hash-link" href="#other" title="Direct link to heading">​</a></h2><p>Play an image sequence</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="play-an-image-sequence">Play an image sequence<a class="hash-link" href="#play-an-image-sequence" title="Direct link to heading">​</a></h5><p>Play an image sequence directly as moving images, without having to create a video first.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffplay -framerate 5 *input_file_%06d.ext*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffplay</p><p>starts the command</p></li><li><p>-framerate 5</p><p>plays image sequence at rate of 5 images per second <strong>Note:</strong> this low framerate will produce a slideshow effect.</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file This must match the naming convention used! The regex %06d matches six-digit-long numbers, possibly with leading zeroes. This allows the full sequence to be read in ascending order, one image after the other. The extension for TIFF files is .tif or maybe .tiff; the extension for DPX files is .dpx (or even .cin for old files). Screenshots are often in .png format.</p></li></ul><p><strong>Notes:</strong></p><p>If <code>-framerate</code> is omitted, the playback speed depends on the images’ file sizes and on the computer’s processing power. It may be rather slow for large image files.</p><p>You can navigate durationally by clicking within the playback window. Clicking towards the left-hand side of the playback window takes you towards the beginning of the playback sequence; clicking towards the right takes you towards the end of the sequence.</p><p>Split audio and video tracks</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="split-audio-and-video-tracks">Split audio and video tracks<a class="hash-link" href="#split-audio-and-video-tracks" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -map 0:v:0 *video_output_file* -map 0:a:0 *audio_output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command splits the original input file into a video and audio stream. The -map command identifies which streams are mapped to which file. To ensure that you’re mapping the right streams to the right file, run ffprobe before writing the script to identify which streams are desired.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-map 0✌️0</p><p>grabs the first video stream and maps it into:</p></li><li><p><em>video_output_file</em></p><p>path, name and extension of the video output file</p></li><li><p>-map 0🅰️0</p><p>grabs the first audio stream and maps it into:</p></li><li><p><em>audio_output_file</em></p><p>path, name and extension of the audio output file</p></li></ul><p>Merge audio and video tracks</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="merge-audio-and-video-tracks">Merge audio and video tracks<a class="hash-link" href="#merge-audio-and-video-tracks" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *video_file* -i *audio_file* -map 0:v -map 1:a -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command takes a video file and an audio file as inputs, and creates an output file that combines the video stream in the first file with the audio stream in the second file.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>video_file</em></p><p>path, name and extension of the first input file (the video file)</p></li><li><p>-i <em>audio_file</em></p><p>path, name and extension of the second input file (the audio file)</p></li><li><p>-map <em>0:v</em></p><p>selects the video streams from the first input file</p></li><li><p>-map <em>1:a</em></p><p>selects the audio streams from the second input file</p></li><li><p>-c copy</p><p>copies streams without re-encoding</p></li><li><p><em>output_file</em></p><p>path, name and extension of the output file</p></li></ul><p><strong>Note:</strong> in the example above, the video input file is given prior to the audio input file. However, input files can be added any order, as long as they are indexed correctly when stream mapping with <code>-map</code>. See the entry on <a href="https://amiaopensource.github.io/ffmprovisr/#stream-mapping" target="_blank" rel="noopener noreferrer">stream mapping</a>.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="variation">Variation:<a class="hash-link" href="#variation" title="Direct link to heading">​</a></h4><p>Include the audio tracks from both input files with the following command:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *video_file* -i *audio_file* -map 0:v -map 0:a -map 1:a -c copy *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Create ISO files for DVD access</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-iso-files-for-dvd-access">Create ISO files for DVD access<a class="hash-link" href="#create-iso-files-for-dvd-access" title="Direct link to heading">​</a></h5><p>Create an ISO file that can be used to burn a DVD. Please note, you will have to install dvdauthor. To install dvd author using Homebrew run: <code>brew install dvdauthor</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -aspect *4:3* -target ntsc-dvd *output_file*.mpg</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will take any file and create an MPEG file that dvdauthor can use to create an ISO.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-aspect 4:3</p><p>declares the aspect ratio of the resulting video file. You can also use 16:9.</p></li><li><p>-target ntsc-dvd</p><p>specifies the region for your DVD. This could be also pal-dvd.</p></li><li><p><em>output_file</em>.mpg</p><p>path and name of the output file. The extension must be <code>.mpg</code></p></li></ul><p>CSV with timecodes and YDIF</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="exports-csv-for-scene-detection-using-ydif">Exports CSV for scene detection using YDIF<a class="hash-link" href="#exports-csv-for-scene-detection-using-ydif" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -f lavfi -i movie=*input_file*,signalstats -show_entries frame=pkt_pts_time:frame_tags=lavfi.signalstats.YDIF -of csv</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This ffprobe command prints a CSV correlating timestamps and their YDIF values, useful for determining cuts.</p><ul><li><p>ffprobe</p><p>starts the command</p></li><li><p>-f lavfi</p><p>uses the <a href="https://ffmpeg.org/ffmpeg-devices.html#lavfi" target="_blank" rel="noopener noreferrer">Libavfilter input virtual device</a> as chosen format</p></li><li><p>-i movie=<em>input file</em></p><p>path, name and extension of the input video file</p></li><li><p>,</p><p>comma signifies closing of video source assertion and ready for filter assertion</p></li><li><p>signalstats</p><p>tells ffprobe to use the signalstats command</p></li><li><p>-show_entries</p><p>sets list of entries to show per column, determined on the next line</p></li><li><p>frame=pkt_pts_time:frame_tags=lavfi.signalstats.YDIF</p><p>specifies showing the timecode (<code>pkt_pts_time</code>) in the frame stream and the YDIF section of the frame_tags stream</p></li><li><p>-of csv</p><p>sets the output printing format to CSV. <code>-of</code> is an alias of <code>-print_format</code>.</p></li></ul><p>Cover head switching noise</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="cover-head-switching-noise">Cover head switching noise<a class="hash-link" href="#cover-head-switching-noise" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i *input_file* -filter:v drawbox=w=iw:h=7:y=ih-h:t=max *output_file*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will draw a black box over a small area of the bottom of the frame, which can be used to cover up head switching noise.</p><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-i <em>input_file</em></p><p>path, name and extension of the input file</p></li><li><p>-filter:v drawbox=</p><p>This calls the drawtext filter with the following options:w=in_wWidth is set to the input width. Shorthand for this command would be w=iwh=7Height is set to 7 pixels.y=ih-hY represents the offset, and ih-h sets it to the input height minus the height declared in the previous parameter, setting the box at the bottom of the frame.t=maxT represents the thickness of the drawn box. Default is 3.</p></li><li><p><em>output_file</em></p><p>path and name of the output file</p></li></ul><p>Record and live-stream simultaneously</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="record-and-live-stream-simultaneously">Record and live-stream simultaneously<a class="hash-link" href="#record-and-live-stream-simultaneously" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -re -i *${INPUTFILE}* -map 0 -flags +global_header -vf scale=&quot;1280:-1,format=yuv420p&quot; -pix_fmt yuv420p -level 3.1 -vsync passthrough -crf 26 -g 50 -bufsize 3500k -maxrate 1800k -c:v libx264 -c:a aac -b:a 128000 -r:a 44100 -ac 2 -t ${STREAMDURATION} -f tee *&quot;[movflags=+faststart]${TARGETFILE}|[f=flv]${STREAMTARGET}&quot;*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>I use this script to stream to a RTMP target and record the stream locally as .mp4 with only one ffmpeg-instance.</p><p>As input, I use <code>bmdcapture</code> which is piped to ffmpeg. But it can also be used with a static videofile as input.</p><p>The input will be scaled to 1280px width, maintaining height. Also the stream will stop after a given time (see <code>-t</code> option.)</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="notes-1">Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">​</a></h4><ol><li>I recommend to use this inside a shell script - then you can define the variables <code>${INPUTFILE}</code>, <code>${STREAMDURATION}</code>, <code>${TARGETFILE}</code>, and <code>${STREAMTARGET}</code>.</li><li>This is in daily use to live-stream a real-world TV show. No errors for nearly 4 years. Some parameters were found by trial-and-error or empiric testing. So suggestions/questions are welcome.</li></ol><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-re</p><p>Read input at native framerate</p></li><li><p>-i input.mov</p><p>The input file. Can also be a <code>-</code> to use STDIN if you pipe in from webcam or SDI.</p></li><li><p>-map 0</p><p>map ALL streams from input file to output</p></li><li><p>-flags +global_header</p><p>Don&#x27;t place extra data in every keyframe</p></li><li><p>-vf scale=&quot;1280:-1&quot;</p><p>Scale to 1280 width, maintain aspect ratio.</p></li><li><p>-pix_fmt yuv420p</p><p>convert to 4:2:0 chroma subsampling scheme</p></li><li><p>-level 3.1</p><p>H.264 Level (defines some thresholds for bitrate)</p></li><li><p>-vsync passthrough</p><p>Each frame is passed with its timestamp from the demuxer to the muxer.</p></li><li><p>-crf 26</p><p>Constant rate factor - basically the quality</p></li><li><p>-g 50</p><p>GOP size.</p></li><li><p>-bufsize 3500k</p><p>Ratecontrol buffer size (~ maxrate x2)</p></li><li><p>-maxrate 1800k</p><p>Maximum bit rate</p></li><li><p>-c:v libx264</p><p>encode output video stream as H.264</p></li><li><p>-c:a aac</p><p>encode output audio stream as AAC</p></li><li><p>-b:a 128000</p><p>The audio bitrate</p></li><li><p>-r:a 44100</p><p>The audio samplerate</p></li><li><p>-ac 2</p><p>Two audio channels</p></li><li><p>-t ${STREAMDURATION}</p><p>Time (in seconds) after which the stream should automatically end.</p></li><li><p>-f tee</p><p>Use multiple outputs. Outputs defined below.</p></li><li><p>&quot;<!-- -->[movflags=+faststart]<!-- -->target-file.mp4|<!-- -->[f=flv]<!-- -->rtmp://stream-url/stream-id&quot;</p><p>The outputs, separated by a pipe (|). The first is the local file, the second is the live stream. Options for each target are given in square brackets before the target.</p></li></ul><p>View FFmpeg subprogram information</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="view-information-about-a-specific-decoder-encoder-demuxer-muxer-or-filter">View information about a specific decoder, encoder, demuxer, muxer, or filter<a class="hash-link" href="#view-information-about-a-specific-decoder-encoder-demuxer-muxer-or-filter" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -h *type=name*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>ffmpeg</p><p>starts the command</p></li><li><p>-h</p><p>Call the help option</p></li><li><p>type=name</p><p>tells FFmpeg which kind of option you want, for example:<code>encoder=libx264``decoder=mp3``muxer=matroska``demuxer=mov``filter=crop</code></p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="similar-tools-tips--tricks-">Similar tools: tips &amp; tricks 🎩🐰<a class="hash-link" href="#similar-tools-tips--tricks-" title="Direct link to heading">​</a></h2><p>This section introduces and explains the usage of some additional command line tools similar to FFmpeg for use in digital preservation workflows (and beyond!).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="cdda-audio-cd-ripping-tools">CDDA (Audio CD) Ripping Tools<a class="hash-link" href="#cdda-audio-cd-ripping-tools" title="Direct link to heading">​</a></h2><p>Find Drive Offset for Exact CD Ripping</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="find-drive-offset-for-exact-cd-ripping">Find Drive Offset for Exact CD Ripping<a class="hash-link" href="#find-drive-offset-for-exact-cd-ripping" title="Direct link to heading">​</a></h5><p>If you want to make CD rips that can be verified via checksums to other rips of the same content, you need to know the offset of your CD drive. Put simply, different models of CD drives have different offsets, meaning they start reading in slightly different locations. This must be compensated for in order for files created on different (model) drives to generate the same checksum. For a more detailed explanation of drive offsets see the explanation <a href="https://dbpoweramp.com/spoons-audio-guide-cd-ripping.htm" target="_blank" rel="noopener noreferrer">here.</a> In order to find your drive offset, first you will need to know exactly what model your drive is, then you can look it up in the list of drive offsets by Accurate Rip.</p><p>Often it can be difficult to tell what model your drive is simply by looking at it - it may be housed inside your computer or have external branding that is different from the actual drive manufacturer. For this reason, it can be useful to query your drive with CD ripping software in order to ID it. The following commands should give you a better idea of what drive you have.</p><p><strong>Cdda2wav:</strong> <code>cdda2wav -scanbus</code> or simply <code>cdda2wav</code></p><p><strong>CD Paranoia:</strong> <code>cdparanoia -vsQ</code></p><p>Once you have IDed your drive, you can search the <a href="http://www.accuraterip.com/driveoffsets.htm" target="_blank" rel="noopener noreferrer">Accurate Rip CD drive offset list</a> to find the correct offset for your drive as sourced by the community.</p><p><strong>Note:</strong> A very effective GUI based tool (macOS specific) for both for discovering drive offset as well as accurately ripping CDDAs is <a href="https://tmkk.undo.jp/xld/index_e.html" target="_blank" rel="noopener noreferrer">XLD</a>. Instructions for calibrating XLD can be found at <a href="https://wiki.hydrogenaud.io/index.php?title=XLD_Configuration" target="_blank" rel="noopener noreferrer">this page</a>.</p><p>Rip a CD with CD Paranoia</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="rip-a-cd-with-cd-paranoia">Rip a CD with CD Paranoia<a class="hash-link" href="#rip-a-cd-with-cd-paranoia" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cdparanoia -L -B -O *[Drive Offset]* *[Starting Track Number]*-*[Ending Track Number]* *output_file.wav*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This command will use CD Paranoia to rip a CD into separate tracks while compensating for the sample offset of the CD drive. (For more information about drive offset see <a href="https://amiaopensource.github.io/ffmprovisr/#find-offset" target="_blank" rel="noopener noreferrer">the related ffmprovisr command.</a>)</p><ul><li><p>cdparanoia</p><p>begins the cdparanoia command.</p></li><li><p>-L</p><p>creates verbose logfile.</p></li><li><p>-B</p><p>puts CD Paranoia into &#x27;batch&#x27; mode, which will automatically split tracks into separate files.</p></li><li><p>-O <!-- -->[Drive Offset]</p><p>allows you to specify the sample offset of your drive. Skip this flag to rip without offset correction.</p></li><li><p>[Starting Track Number]<!-- -->-<!-- -->[Ending Track Number]</p><p>specifies which tracks to write. For example <code>1-4</code> would rip tracks one through four.</p></li><li><p><em>output_file.wav</em></p><p>the desired name for your output file(s) (for example the CD name). CD Paranoia will prepend this with track numbers.</p></li></ul><p>Rip a CD with Cdda2wav</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="rip-a-cd-with-cdda2wav">Rip a CD with Cdda2wav<a class="hash-link" href="#rip-a-cd-with-cdda2wav" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cdda2wav -L0 -t all -cuefile -paranoia paraopts=retries=200,readahead=600,minoverlap=sectors-per-request-1 -verbose-level all *output.wav*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Cdda2wav is a tool that uses the <a href="https://www.xiph.org/paranoia/" target="_blank" rel="noopener noreferrer">Paranoia library</a> to facilitate accurate ripping of audio CDs (CDDA). It can be installed via Homebrew with the command <code>brew install cdrtools</code>. This command will accurately rip an audio CD into a single wave file, while querying the CDDB database for track information and creating a cue sheet. This cue sheet can then be used either for playback of the WAV file or to split it into individual access files. Any <a href="https://en.wikipedia.org/wiki/CD-Text" target="_blank" rel="noopener noreferrer">cdtext</a> information that is discovered will be stored as a sidecar. For more information about cue sheets see <a href="https://en.wikipedia.org/wiki/Cue_sheet_(computing)" target="_blank" rel="noopener noreferrer">this Wikipedia article.</a></p><p><strong>Notes:</strong> On macOS the CD must be unmounted before this command is run. This can be done with the command <code>sudo umount &#x27;/Volumes/Name_of_CD&#x27;</code></p><p>As of writing, when using the default Homebrew installed version of Cdda2wav some drives will falsely report errors on all rips. If this is occurring, a possible solution is to use the command <code>brew install --devel cdrtools</code> to install a more recent build that incorporates a fix.</p><ul><li><p>cdda2wav</p><p>begins the Cdda2wav command</p></li><li><p>-L0</p><p>tells Cdda2wav to query the CDDB database for track name information. L0 is &#x27;interactive mode&#x27; meaning Cdda2wav will ask you to confirm choices in the event of multiple matches. Change this to <code>-L1</code> to automatically select the first database match.</p></li><li><p>-t all</p><p>tells Cdda2wav to rip the entire CD to one file</p></li><li><p>-cuefile</p><p>tells Cdda2wav to create a cue file of CD contents</p></li><li><p>-paranoia</p><p>enables the Paranoia library for ripping</p></li><li><p>paraopts=retries=200,readahead=600,minoverlap=sectors-per-request-1</p><p>configures ripping to a generically conservative setting for retries and caching. These values were taken from the Cdda2wav man file and can be changed depending on needs, such as for more/less retry attempts. For more information see the Cdda2wav man file (also available online <a href="https://linux.die.net/man/1/cdda2wav" target="_blank" rel="noopener noreferrer">here)</a>.</p></li><li><p>-verbose-level all</p><p>sets terminal information to the most verbose view</p></li><li><p><em>output.wav</em></p><p>the desired name for your output file (for example the CD name).</p></li></ul><p>Check/Compensate for CD Emphasis</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="checkcompensate-for-cd-emphasis">Check/Compensate for CD Emphasis<a class="hash-link" href="#checkcompensate-for-cd-emphasis" title="Direct link to heading">​</a></h5><p>While somewhat rare, certain CDs had &#x27;emphasis&#x27; applied as a form of noise reduction. This seems to mostly affect early (1980s) era CDs and some CDs pressed in Japan. Emphasis is part of the <a href="https://en.wikipedia.org/wiki/Compact_Disc_Digital_Audio#Standard" target="_blank" rel="noopener noreferrer">Red Book standard</a> and, if present, must be compensated for to ensure accurate playback. CDs that use emphasis contain flags on tracks that tell the CD player to de-emphasize the audio on playback. When ripping a CD with emphasis, it is important to take this into account and either apply de-emphasis while ripping, or if storing a &#x27;flat&#x27; copy, create another de-emphasized listening copy.</p><p>The following commands will output information about the presence of emphasis when run on a target CD:</p><p><strong>Cdda2wav:</strong> <code>cdda2wav -J</code></p><p><strong>CD Paranoia:</strong> <code>cdparanoia -Q</code></p><p>In order to compensate for emphasis during ripping while using Cdda2wav, the <code>-T</code> flag can be added to the <a href="https://amiaopensource.github.io/ffmprovisr/#cdda2wav" target="_blank" rel="noopener noreferrer">standard ripping command</a>. For a recipe to compensate for a flat rip, see the section on <a href="https://amiaopensource.github.io/ffmprovisr/#cd_eq" target="_blank" rel="noopener noreferrer">de-emphasizing with FFmpeg</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="imagemagick">ImageMagick<a class="hash-link" href="#imagemagick" title="Direct link to heading">​</a></h2><p>About ImageMagick</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="about-imagemagick">About ImageMagick<a class="hash-link" href="#about-imagemagick" title="Direct link to heading">​</a></h5><p>ImageMagick is a free and open-source software suite for displaying, converting, and editing raster image and vector image files.</p><p>It&#x27;s official website can be found <a href="https://www.imagemagick.org/script/index.php" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Another great resource with lots of supplemental explanations of filters is available at <a href="http://www.fmwconcepts.com/imagemagick/index.php" target="_blank" rel="noopener noreferrer">Fred&#x27;s ImageMagick Scripts</a>.</p><p>Unlike many other command line tools, ImageMagick isn&#x27;t summoned by calling its name. Rather, ImageMagick installs links to several more specific commands: <code>convert</code>, <code>montage</code>, and <code>mogrify</code>, to name a few.</p><p>Compare two images</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="compare-two-images">Compare two images<a class="hash-link" href="#compare-two-images" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">compare -metric ae *image1.ext image2.ext* null:</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Compares two images to each other.</p><ul><li><p>compare</p><p>starts the command</p></li><li><p>-metric ae</p><p>applies the absolute error count metric, returning the number of different pixels. <a href="https://www.imagemagick.org/script/command-line-options.php#metric" target="_blank" rel="noopener noreferrer">Other parameters</a> are available for image comparison.</p></li><li><p><em>image1.ext image2.ext</em></p><p>takes two images as input</p></li><li><p>null:</p><p>throws away the comparison image that would be generated</p></li></ul><p>Create thumbnails of images</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="create-thumbnails">Create thumbnails<a class="hash-link" href="#create-thumbnails" title="Direct link to heading">​</a></h5><p>Creates thumbnails for all files in a folder and saves them in that folder.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mogrify -resize 80x80 -format jpg -quality 75 -path thumbs *.jpg</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>montage</p><p>starts the command</p></li><li><p>-resize 80x80</p><p>resizes copies of original images to 80x80 pixels</p></li><li><p>-format jpg</p><p>reformats original images to jpg</p></li><li><p>-quality 75</p><p>sets quality to 75 (out of 100), adding light compression to smaller files</p></li><li><p>-path thumbs</p><p>specifies where to save the thumbnails -- this goes to a folder within the active folder called &quot;thumbs&quot;. Note: You will have to make this folder if it doesn&#x27;t already exist.</p></li><li><p>*<em>.jpg</em></p><p>The asterisk acts as a &quot;wildcard&quot; to be applied to every file in the directory.</p></li></ul><p>Creates grid of images from text file</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="create-grid-of-images">Create grid of images<a class="hash-link" href="#create-grid-of-images" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">montage @*list.txt* -tile 6x12 -geometry +0+0 *output_grid.jpg*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>montage</p><p>starts the command</p></li><li><p>@list.txt</p><p>path and name of a text file containing a list of filenames, one per each line</p></li><li><p>-tile 6x12</p><p>specifies the dimensions of the proposed grid (6 images wide, 12 images long)</p></li><li><p>-geometry +0+0</p><p>specifies to include no spacing around any of the tiles; they will be flush against each other</p></li><li><p><em>output_grid.jpg</em></p><p>path and name of the output file</p></li></ul><p>Get file signature data</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="get-file-signature-data">Get file signature data<a class="hash-link" href="#get-file-signature-data" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">convert -verbose *input_file.ext* | grep -i signature</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Gets signature data from an image file, which is a hash that can be used to uniquely identify the image.</p><ul><li><p>convert</p><p>starts the command</p></li><li><p>-verbose</p><p>sets verbose flag for collecting the most data</p></li><li><p><em>input_file.ext</em></p><p>path and name of image file</p></li><li><p>|</p><p>pipe the data into something else</p></li><li><p>grep</p><p>starts the grep command</p></li><li><p>-i signature</p><p>ignore case and search for the phrase &quot;signature&quot;</p></li></ul><p>Removes exif metadata</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="remove-exif-data">Remove exif data<a class="hash-link" href="#remove-exif-data" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mogrify -path ./stripped/ -strip *.jpg</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Removes (strips) exif data and moves clean files to a new folder.</p><ul><li><p>mogrify</p><p>starts the command</p></li><li><p>-path ./stripped/</p><p>sets directory within current directory called &quot;stripped&quot;</p></li><li><p>-strip</p><p>removes exif metadata</p></li><li><p>*.jpg</p><p>applies command to all .jpgs in current folder</p></li></ul><p>Resizes image to specific pixel width</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="resize-to-width">Resize to width<a class="hash-link" href="#resize-to-width" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">convert *input_file.ext* -resize 750 *output_file.ext*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This script will also convert the file format, if the output has a different file extension than the input.</p><ul><li><p>convert</p><p>starts the command</p></li><li><p>-i <em>input_file.ext</em></p><p>path and name of the input file</p></li><li><p>-resize 750</p><p>resizes the image to 750 pixels wide, retaining aspect ratio</p></li><li><p><em>output_file.ext</em></p><p>path and name of the output file</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="flac">flac<a class="hash-link" href="#flac" title="Direct link to heading">​</a></h2><p>Transcoding to/from FLAC</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="about-flac-tool">About flac tool<a class="hash-link" href="#about-flac-tool" title="Direct link to heading">​</a></h5><p>The flac tool is the tool created by the FLAC project to transcode to/from FLAC and to manipulate metadata in FLAC files. One advantage it has over other tools used to transcode into FLAC is the capability of embedding foreign metadata (such as BWF metadata). This means that it is possible to compress a BWF file into FLAC and maintain the ability to transcode back into an identical BWF, metadata and all. For a more detailed explanation, see <a href="http://dericed.com/2013/flac-in-the-archives/" target="_blank" rel="noopener noreferrer">Dave Rice&#x27;s article</a> on the topic, from which the following commands are adapted.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="transcode-to-flac">Transcode to FLAC<a class="hash-link" href="#transcode-to-flac" title="Direct link to heading">​</a></h3><p>Use this command to transcode from WAV to FLAC while maintaining BWF metadata</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">flac --best --keep-foreign-metadata --preserve-modtime --verify *input.wav*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>flac</p><p>starts the command</p></li><li><p>-i <em>input_file.ext</em></p><p>path and name of the input file</p></li><li><p>--best</p><p>sets the file for the most efficient compression (resulting in a smaller file at the expense of a slower process).</p></li><li><p>--keep-foreign-metadata</p><p>tells the flac tool to maintain original metadata within the FLAC file.</p></li><li><p>--preserve-modtime</p><p>preserves the file timestamps of the input file.</p></li><li><p>--verify</p><p>verifies the validity of the output file.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="transcode-from-flac">Transcode from FLAC<a class="hash-link" href="#transcode-from-flac" title="Direct link to heading">​</a></h3><p>Use this command to transcode from FLAC to reconstruct original BWF file. Command is the same as the prior command with the exception of substituting <code>--decode</code> for <code>best</code> and changing the input to a <code>.flac</code> file.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">flac --decode --keep-foreign-metadata --preserve-modtime --verify *input.flac*</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Link to this command: <a href="https://amiaopensource.github.io/ffmprovisr/index.html#flac-tool" target="_blank" rel="noopener noreferrer">https://amiaopensource.github.io/ffmprovisr/index.html#flac-tool</a></p><p>2023-08-05 <a href="https://www.hadet.dev/ffmpeg-cheatsheet/" target="_blank" rel="noopener noreferrer">Editing Videos with ffmpeg – Hadet – Earth Based System Administrator and Hobbyist</a></p><blockquote><p><img alt="image-20230805001802130" src="/assets/images/image-20230805001802130-27d84b7ce8ad64d02acf1a75d98100b2.png" width="947" height="688"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="editing-videos-with-ffmpeg">Editing Videos with ffmpeg<a class="hash-link" href="#editing-videos-with-ffmpeg" title="Direct link to heading">​</a></h3><p>This is a short and messy guide for editing files from the command line. While I do this on Linux, these commands will work on MacOS and Windows too. The reason I do this is because I am vision impaired and timeline editors are very cumbersome for me in particular. Sometimes I also feel this is faster, especially for sharing short clips scaled for chat platforms like Discord.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="create-a-folder-to-act-as-a-root-for-your-project">Create a Folder to act as a root for your project.<a class="hash-link" href="#create-a-folder-to-act-as-a-root-for-your-project" title="Direct link to heading">​</a></h4><p>This is important for later when we want to concat multiple clips together.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="clipping-files">Clipping Files:<a class="hash-link" href="#clipping-files" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -ss 00:00:00 -t 00:00:00 -async 1 -strict -2 output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Where the first timestamp is the starting point and the second timestamp is the length of the clip.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="fade-in">Fade In:<a class="hash-link" href="#fade-in" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -y -vf fade=in:0:30 output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The fade is not a timeinput but actually the number of frames, so 30 = Half a Second on a 60FPS recording. There is a way to automate this to always be half a second, but math between shells can be kind of unreliable.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="fade-out">Fade Out:<a class="hash-link" href="#fade-out" title="Direct link to heading">​</a></h4><p>This is a little more annoying, and can be done one of two ways, I hope if there’s a better way to do this someone eventually enlightens me</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="get-framecount">Get Framecount<a class="hash-link" href="#get-framecount" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -map 0:v:0 -c copy -f null -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>OR</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffprobe -v error -count_frames -select_streams v:0 -show_entries stream=nb_read_frames -of default=nokey=1:noprint_wrappers=1 input.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>These commands will tell you the total number of frames whichever input you give it.</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="apply-30-frame-fade-out-by-substracking-30-frames-from-that-total">Apply 30 Frame Fade Out by substracking 30 frames from that total.<a class="hash-link" href="#apply-30-frame-fade-out-by-substracking-30-frames-from-that-total" title="Direct link to heading">​</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -y -vf fade=out:120:30 output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Where 120 is replaced by the total number of frames.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="prefix-videos-numerically-for-the-order-you-want-them-in">Prefix Videos Numerically for the order you want them in.<a class="hash-link" href="#prefix-videos-numerically-for-the-order-you-want-them-in" title="Direct link to heading">​</a></h4><ul><li>Creating a list for concat:</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">for f in ./*.mp4; do echo &quot;file &#x27;$f&#x27;&quot; &gt;&gt; project.txt; done</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>Combining the Files:</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -f concat -safe 0 -i project.txt -c copy project.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="video-scaling-for-upload-limitations">Video scaling for upload limitations:<a class="hash-link" href="#video-scaling-for-upload-limitations" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input.mp4 -vf &quot;scale=iw/2:ih/2&quot; output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This is exceptionally useful for Slack, Twitter and Discord, as well as more bandwidth conscious than uploading information that doesn’t need to be hundreds of megabytes when it could be tens of megabytes instead.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="export-all-video-frames-as-images">Export all video frames as images<a class="hash-link" href="#export-all-video-frames-as-images" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i &quot;%1&quot; frames/out-%03d.jpg</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>I don’t really recommend doing this but it’s possible, it will also take a <strong>LONG TIME</strong> on long videos and eat up an enormous amount of space. It’s also not really recommended on any filesystem on any OS to put more than 10,000 individual files in a single directory, so bear that in mind.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="replace-audio-with-music">Replace Audio with music<a class="hash-link" href="#replace-audio-with-music" title="Direct link to heading">​</a></h4><p>This stuff gets into audio channels and sinks and i really recommend reading the ffmpeg doc to properly understand these commands as it would take a huge amount of technical explaination that already exists to properly explain these commands.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -y -stream_loop -1 -i &quot;input_music.mp3&quot; -i &quot;input_video.mp4&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-map 0:a:0 -map 1:v:0 -c:v copy -c:a aac -ac 2 -shortest output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This will replace the audio with whatever the input file is and loop it for the entirety of the video length, the original audio track will not be included. See below for just adding stock/background music to your video</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="add-music-to-loop-through-the-whole-video">Add Music to loop through the whole video<a class="hash-link" href="#add-music-to-loop-through-the-whole-video" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i input_video.mp4 -filter_complex &quot;amovie=input_music.mp3:loop=0,asetpts=N/SR/TB[input_music];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    [0][input_music]amix=duration=shortest,volume=2.0&quot;   output.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Then you have a background audio track that is accessible in other editors even.</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dzharii/dzharii.github.io/docs/ffmpeg-recipes.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ffmpeg-inbox"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ffmpeg-inbox</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ffmpeg-snippets"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ffmpeg-snippets</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tools" class="table-of-contents__link toc-highlight">Tools</a></li><li><a href="#snippets" class="table-of-contents__link toc-highlight">Snippets</a></li><li><a href="#audio-filter-loudnorm" class="table-of-contents__link toc-highlight">Audio filter loudnorm</a></li><li><a href="#ffmpeg-convert-for-android" class="table-of-contents__link toc-highlight">FFmpeg: convert for android</a></li><li><a href="#webcam-streaming" class="table-of-contents__link toc-highlight">Webcam Streaming</a></li><li><a href="#gopro-camera" class="table-of-contents__link toc-highlight">GoPRO Camera</a><ul><li><a href="#gopro-tools-and-code" class="table-of-contents__link toc-highlight">GoPro Tools and Code</a></li></ul></li><li><a href="#youtube" class="table-of-contents__link toc-highlight">Youtube</a></li><li><a href="#tools--other" class="table-of-contents__link toc-highlight">Tools / Other</a></li><li><a href="#about-ffmprovisr" class="table-of-contents__link toc-highlight">About ffmprovisr</a><ul><li><a href="#making-ffmpeg-easier" class="table-of-contents__link toc-highlight">Making FFmpeg Easier</a></li><li><a href="#tutorials" class="table-of-contents__link toc-highlight">Tutorials</a></li><li><a href="#license" class="table-of-contents__link toc-highlight">License</a></li><li><a href="#sibling-projects" class="table-of-contents__link toc-highlight">Sibling projects</a></li></ul></li><li><a href="#learn-about-ffmpeg-basics" class="table-of-contents__link toc-highlight">Learn about FFmpeg basics</a></li><li><a href="#learn-about-more-advanced-ffmpeg-concepts" class="table-of-contents__link toc-highlight">Learn about more advanced FFmpeg concepts</a></li><li><a href="#change-container-rewrap" class="table-of-contents__link toc-highlight">Change container (rewrap)</a></li><li><a href="#change-codec-transcode" class="table-of-contents__link toc-highlight">Change codec (transcode)</a></li><li><a href="#change-video-properties" class="table-of-contents__link toc-highlight">Change video properties</a></li><li><a href="#find-undetermined-or-unknown-stream-properties" class="table-of-contents__link toc-highlight">Find undetermined or unknown stream properties</a></li><li><a href="#set-aspect-ratio" class="table-of-contents__link toc-highlight">Set aspect ratio</a></li><li><a href="#adding-other-stream-properties" class="table-of-contents__link toc-highlight">Adding other stream properties.</a></li><li><a href="#change-or-view-audio-properties" class="table-of-contents__link toc-highlight">Change or view audio properties</a></li><li><a href="#join-trim-or-create-an-excerpt" class="table-of-contents__link toc-highlight">Join, trim, or create an excerpt</a></li><li><a href="#work-with-interlaced-video" class="table-of-contents__link toc-highlight">Work with interlaced video</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#example-1" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#example-2" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#overlay-timecode-or-text" class="table-of-contents__link toc-highlight">Overlay timecode or text</a></li><li><a href="#create-thumbnails-or-gifs" class="table-of-contents__link toc-highlight">Create thumbnails or GIFs</a></li><li><a href="#create-a-video-from-images" class="table-of-contents__link toc-highlight">Create a video from images</a></li><li><a href="#use-filters-or-scopes" class="table-of-contents__link toc-highlight">Use filters or scopes</a></li><li><a href="#comparison-of-mono-16-bit-and-mono-16-bit-padded-to-32-bit" class="table-of-contents__link toc-highlight">Comparison of mono 16 bit and mono 16 bit padded to 32 bit.</a></li><li><a href="#example-of-filter-output" class="table-of-contents__link toc-highlight">Example of filter output</a></li><li><a href="#example-of-filter-output-1" class="table-of-contents__link toc-highlight">Example of filter output</a></li><li><a href="#example-of-filter-output-2" class="table-of-contents__link toc-highlight">Example of filter output</a></li><li><a href="#view-or-strip-metadata" class="table-of-contents__link toc-highlight">View or strip metadata</a></li><li><a href="#preservation-tasks" class="table-of-contents__link toc-highlight">Preservation tasks</a><ul><li><a href="#check-ffv1-version-3-fixity" class="table-of-contents__link toc-highlight">Check FFV1 Version 3 fixity</a></li></ul></li><li><a href="#generate-test-files" class="table-of-contents__link toc-highlight">Generate test files</a><ul><li><a href="#makes-a-smpte-bars-test-pattern-video" class="table-of-contents__link toc-highlight">Makes a SMPTE bars test pattern video</a></li></ul></li><li><a href="#use-ocr" class="table-of-contents__link toc-highlight">Use OCR</a></li><li><a href="#compare-perceptual-similarity-of-videos" class="table-of-contents__link toc-highlight">Compare perceptual similarity of videos</a></li><li><a href="#other" class="table-of-contents__link toc-highlight">Other</a><ul><li><a href="#merge-audio-and-video-tracks" class="table-of-contents__link toc-highlight">Merge audio and video tracks</a></li></ul></li><li><a href="#similar-tools-tips--tricks-" class="table-of-contents__link toc-highlight">Similar tools: tips &amp; tricks 🎩🐰</a></li><li><a href="#cdda-audio-cd-ripping-tools" class="table-of-contents__link toc-highlight">CDDA (Audio CD) Ripping Tools</a></li><li><a href="#imagemagick" class="table-of-contents__link toc-highlight">ImageMagick</a><ul><li><a href="#create-grid-of-images" class="table-of-contents__link toc-highlight">Create grid of images</a></li></ul></li><li><a href="#flac" class="table-of-contents__link toc-highlight">flac</a><ul><li><a href="#transcode-to-flac" class="table-of-contents__link toc-highlight">Transcode to FLAC</a></li><li><a href="#transcode-from-flac" class="table-of-contents__link toc-highlight">Transcode from FLAC</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Wiki</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Please, remind me to put some good description here!
        Write an awesome description for your new site here. You can edit this
        line in _config.yml. It will appear in your document head meta (for
        Google search results) and in your feed.xml site description.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9027f3ad.js"></script>
<script src="/assets/js/main.6a6a7e8c.js"></script>
</body>
</html>