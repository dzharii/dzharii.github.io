"use strict";(self.webpackChunkzharii=self.webpackChunkzharii||[]).push([[7386],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return h}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),c=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(n),h=o,m=u["".concat(i,".").concat(h)]||u[h]||p[h]||a;return n?r.createElement(m,s(s({ref:t},d),{},{components:n})):r.createElement(m,s({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=u;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:o,s[1]=l;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2641:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return d},default:function(){return u}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),s=["components"],l={},i="Dev. PowerShell random solutions",c={unversionedId:"dev-powershell/dev-powershell-random-articles",id:"dev-powershell/dev-powershell-random-articles",title:"Dev. PowerShell random solutions",description:'- 2022-02-24 powershell - How to get status of "Invoke-Expression", successful or failed? - Stack Overflow',source:"@site/docs/dev-powershell/dev-powershell-random-articles.md",sourceDirName:"dev-powershell",slug:"/dev-powershell/dev-powershell-random-articles",permalink:"/docs/dev-powershell/dev-powershell-random-articles",editUrl:"https://github.com/dzharii/dzharii.github.io/docs/dev-powershell/dev-powershell-random-articles.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"dev-powershell-aliases",permalink:"/docs/dev-powershell/dev-powershell-aliases"},next:{title:"dev-rust-inbox",permalink:"/docs/dev-rust/dev-rust-inbox"}},d=[{value:"Encoder Script",id:"encoder-script",children:[],level:3},{value:"Decoder Script",id:"decoder-script",children:[],level:3}],p={toc:d};function u(e){var t=e.components,n=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"dev-powershell-random-solutions"},"Dev. PowerShell random solutions"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2022-02-24 ",(0,a.kt)("a",{parentName:"li",href:"https://stackoverflow.com/questions/32348794/how-to-get-status-of-invoke-expression-successful-or-failed"},'powershell - How to get status of "Invoke-Expression", successful or failed? - Stack Overflow'),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"Invoke-Expression will return all the text of the command being invoked.\nBut how can I get the system return value of whether this command has been executed successfully or with a failure? In CMD I could use %errorlevel% to get external command execution state. What about PowerShell?")))),(0,a.kt)("p",null,"Mathias R. Jessen:\nNormally you would use\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"$?"),"\xa0to inspect the status of the last statement executed:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"PS C:\\> Write-Output 123 | Out-Null; $?\nTrue\nPS C:\\> Non-ExistingCmdlet 123 | Out-Null; $?\nFalse\n\n")),(0,a.kt)("p",null,"However, this won't work with\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"Invoke-Expression"),", because even though a statement inside the expression passed to\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"Invoke-Expression"),"\xa0may fail, the\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"Invoke-Expression"),"\xa0call it self will have succeeded (ie. the expression, although invalid/non-functional was invoked none the less)"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"With\xa0",(0,a.kt)("inlineCode",{parentName:"p"},"Invoke-Expression"),"\xa0you'll have to use try:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'try {\n    Invoke-Expression "Do-ErrorProneAction -Parameter $argument"\n} catch {\n    # error handling go here, $_ contains the error record\n}\n\n')),(0,a.kt)("p",null,"or a trap:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'trap {\n    # error handling goes here, $_ contains the error record\n}\nInvoke-Expression "More-ErrorProneActions"\n\n')),(0,a.kt)("hr",null),(0,a.kt)("p",null,"The alternative is the append\xa0",(0,a.kt)("inlineCode",{parentName:"p"},'";$?"'),"\xa0to the expression you want to invoke:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$Expr  = \"Write-Host $SomeValue\"\n$Expr += ';$?'\n\n$Success = Invoke-Expression $Expr\nif(-not $Success){\n    # seems to have failed\n}\n\n")),(0,a.kt)("p",null,"but relies on there not being any pipeline output"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2022-04-12 ",(0,a.kt)("a",{parentName:"li",href:"https://adamtheautomator.com/powershell-grep/"},"How to Use PowerShell's Grep Select-String"),(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"One of the first Linux commands that many system administrators learn is grep. This venerable tool has been around for decades and is crucial to any administrator\u2019s toolbelt. Grep\u2019s core is simply the ability to search plain text for a RegEx pattern. Grep can search files in a given directory or streamed input to output matches. Did you know PowerShell has grep? Well..almost.")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ps1"},'Select-String -Path "Users\\*.csv" -Pattern "Joe","Marti","Jerry"\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2022-05-21 ",(0,a.kt)("a",{parentName:"li",href:"https://gist.github.com/Tiberriver256/868226421866ccebd2310f1073dd1a1e"},"Sample of making a simple webserver in PowerShell. If you have more complex needs checkout Pode https://github.com/Badgerati/Pode as a fully fledged PowerShell web server. \xb7 GitHub"))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"2022-05-29 ",(0,a.kt)("a",{parentName:"li",href:"https://opentechtips.com/base64-algorithm-in-powershell-with-examples/"},"Base64 Encoder and Decoder Algorithm in PowerShell - with Examples - OpenTechTips"))),(0,a.kt)("h3",{id:"encoder-script"},"Encoder Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ps1"},"function Base64Encode($s) {\n$i = 0\n$base64 = $ending = ''\n$base64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\n\n# Add padding if string is not dividable by 3\n$pad = 3 - ($s.length % 3)\nif ($pad -ne 3) {\n        $s += \"A\" * $pad\n        $ending = \"=\" * $pad\n    }\n# Iterate though the whole input string\nwhile ($i -lt $s.length) {\n    # Take 3 characters at a time, convert them to 4 base64 chars\n    $b = 0\n    for ($j=0; $j -lt 3; $j++) {\n\n        # get ASCII code of the next character in line\n        $ascii = [int][char]$s[$i]\n        $i++\n\n        # Concatenate the three characters together\n        $b += $ascii -shl 8 * (2-$j)\n        }\n\n    # Convert the 3 chars to four Base64 chars\n    $base64 += $base64chars[ ($b -shr 18) -band 63 ]\n    $base64 += $base64chars[ ($b -shr 12) -band 63 ]\n    $base64 += $base64chars[ ($b -shr 6) -band 63 ]\n    $base64 += $base64chars[ $b -band 63 ]\n    }\n# Add the actual padding to the end after removing the same number of characters\nif ($pad -ne 3) {\n        $base64 = $base64.SubString(0, $base64.length - $pad)\n        $base64 += $ending\n        }\n# Return the Base64 encoded result\nreturn $base64\n}\n")),(0,a.kt)("h3",{id:"decoder-script"},"Decoder Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ps1"},'function Base64Decode($s) {\n$i = 0\n$base64 = $decoded = \'\'\n$base64chars = \'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\'\n# Replace padding with "A" characters for the decoder to work and save the length of the padding to be dropped from the end later\nif ($s.substring($s.length - 2,2) -like "==") {\n    $s = $s.substring(0, $s.length - 2) + "AA"\n    $padd = 2\n    }\nelseif ($s.substring($s.length - 1,1) -like "=") {\n    $s = $s.substring(0, $s.length - 1) + "A"\n    $padd = 1\n}\n# Take 4 characters at a time\nwhile ($i -lt $s.length) {\n    $d = 0\n\n    for ($j=0; $j -lt 4; $j++) {\n        $d += $base64chars.indexof($s[$i]) -shl (18 - $j * 6)\n        $i++\n        }\n    # Convert the 4 chars back to ASCII\n    $decoded += [char](($d -shr 16) -band 255)\n    $decoded += [char](($d -shr 8) -band 255)\n    $decoded += [char]($d -band 255)\n}\n# Remove padding\n$decoded = $decoded.substring(0, $decoded.length - $padd)\n# Return the Base64 encoded result\nreturn $decoded\n}\n')))}u.isMDXComponent=!0}}]);